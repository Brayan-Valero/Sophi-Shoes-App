var ap=n=>{throw TypeError(n)};var Jc=(n,t,s)=>t.has(n)||ap("Cannot "+s);var C=(n,t,s)=>(Jc(n,t,"read from private field"),s?s.call(n):t.get(n)),ye=(n,t,s)=>t.has(n)?ap("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,s),ne=(n,t,s,a)=>(Jc(n,t,"write to private field"),a?a.call(n,s):t.set(n,s),s),Ee=(n,t,s)=>(Jc(n,t,"access private method"),s);var So=(n,t,s,a)=>({set _(l){ne(n,t,l,s)},get _(){return C(n,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(l){if(l.ep)return;l.ep=!0;const u=s(l);fetch(l.href,u)}})();function bm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Yc={exports:{}},Fi={},Xc={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op;function x0(){if(op)return Ce;op=1;var n=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function w(P){return P===null||typeof P!="object"?null:(P=x&&P[x]||P["@@iterator"],typeof P=="function"?P:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,_={};function j(P,M,Ne){this.props=P,this.context=M,this.refs=_,this.updater=Ne||b}j.prototype.isReactComponent={},j.prototype.setState=function(P,M){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,M,"setState")},j.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function N(){}N.prototype=j.prototype;function A(P,M,Ne){this.props=P,this.context=M,this.refs=_,this.updater=Ne||b}var T=A.prototype=new N;T.constructor=A,S(T,j.prototype),T.isPureReactComponent=!0;var $=Array.isArray,K=Object.prototype.hasOwnProperty,J={current:null},Z={key:!0,ref:!0,__self:!0,__source:!0};function se(P,M,Ne){var ke,F={},X=null,oe=null;if(M!=null)for(ke in M.ref!==void 0&&(oe=M.ref),M.key!==void 0&&(X=""+M.key),M)K.call(M,ke)&&!Z.hasOwnProperty(ke)&&(F[ke]=M[ke]);var ge=arguments.length-2;if(ge===1)F.children=Ne;else if(1<ge){for(var be=Array(ge),Ye=0;Ye<ge;Ye++)be[Ye]=arguments[Ye+2];F.children=be}if(P&&P.defaultProps)for(ke in ge=P.defaultProps,ge)F[ke]===void 0&&(F[ke]=ge[ke]);return{$$typeof:n,type:P,key:X,ref:oe,props:F,_owner:J.current}}function ce(P,M){return{$$typeof:n,type:P.type,key:M,ref:P.ref,props:P.props,_owner:P._owner}}function U(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function te(P){var M={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Ne){return M[Ne]})}var he=/\/+/g;function q(P,M){return typeof P=="object"&&P!==null&&P.key!=null?te(""+P.key):M.toString(36)}function re(P,M,Ne,ke,F){var X=typeof P;(X==="undefined"||X==="boolean")&&(P=null);var oe=!1;if(P===null)oe=!0;else switch(X){case"string":case"number":oe=!0;break;case"object":switch(P.$$typeof){case n:case t:oe=!0}}if(oe)return oe=P,F=F(oe),P=ke===""?"."+q(oe,0):ke,$(F)?(Ne="",P!=null&&(Ne=P.replace(he,"$&/")+"/"),re(F,M,Ne,"",function(Ye){return Ye})):F!=null&&(U(F)&&(F=ce(F,Ne+(!F.key||oe&&oe.key===F.key?"":(""+F.key).replace(he,"$&/")+"/")+P)),M.push(F)),1;if(oe=0,ke=ke===""?".":ke+":",$(P))for(var ge=0;ge<P.length;ge++){X=P[ge];var be=ke+q(X,ge);oe+=re(X,M,Ne,be,F)}else if(be=w(P),typeof be=="function")for(P=be.call(P),ge=0;!(X=P.next()).done;)X=X.value,be=ke+q(X,ge++),oe+=re(X,M,Ne,be,F);else if(X==="object")throw M=String(P),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return oe}function ee(P,M,Ne){if(P==null)return P;var ke=[],F=0;return re(P,ke,"","",function(X){return M.call(Ne,X,F++)}),ke}function me(P){if(P._status===-1){var M=P._result;M=M(),M.then(function(Ne){(P._status===0||P._status===-1)&&(P._status=1,P._result=Ne)},function(Ne){(P._status===0||P._status===-1)&&(P._status=2,P._result=Ne)}),P._status===-1&&(P._status=0,P._result=M)}if(P._status===1)return P._result.default;throw P._result}var B={current:null},z={transition:null},W={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:z,ReactCurrentOwner:J};function Q(){throw Error("act(...) is not supported in production builds of React.")}return Ce.Children={map:ee,forEach:function(P,M,Ne){ee(P,function(){M.apply(this,arguments)},Ne)},count:function(P){var M=0;return ee(P,function(){M++}),M},toArray:function(P){return ee(P,function(M){return M})||[]},only:function(P){if(!U(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ce.Component=j,Ce.Fragment=s,Ce.Profiler=l,Ce.PureComponent=A,Ce.StrictMode=a,Ce.Suspense=p,Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,Ce.act=Q,Ce.cloneElement=function(P,M,Ne){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ke=S({},P.props),F=P.key,X=P.ref,oe=P._owner;if(M!=null){if(M.ref!==void 0&&(X=M.ref,oe=J.current),M.key!==void 0&&(F=""+M.key),P.type&&P.type.defaultProps)var ge=P.type.defaultProps;for(be in M)K.call(M,be)&&!Z.hasOwnProperty(be)&&(ke[be]=M[be]===void 0&&ge!==void 0?ge[be]:M[be])}var be=arguments.length-2;if(be===1)ke.children=Ne;else if(1<be){ge=Array(be);for(var Ye=0;Ye<be;Ye++)ge[Ye]=arguments[Ye+2];ke.children=ge}return{$$typeof:n,type:P.type,key:F,ref:X,props:ke,_owner:oe}},Ce.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:u,_context:P},P.Consumer=P},Ce.createElement=se,Ce.createFactory=function(P){var M=se.bind(null,P);return M.type=P,M},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(P){return{$$typeof:f,render:P}},Ce.isValidElement=U,Ce.lazy=function(P){return{$$typeof:y,_payload:{_status:-1,_result:P},_init:me}},Ce.memo=function(P,M){return{$$typeof:g,type:P,compare:M===void 0?null:M}},Ce.startTransition=function(P){var M=z.transition;z.transition={};try{P()}finally{z.transition=M}},Ce.unstable_act=Q,Ce.useCallback=function(P,M){return B.current.useCallback(P,M)},Ce.useContext=function(P){return B.current.useContext(P)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(P){return B.current.useDeferredValue(P)},Ce.useEffect=function(P,M){return B.current.useEffect(P,M)},Ce.useId=function(){return B.current.useId()},Ce.useImperativeHandle=function(P,M,Ne){return B.current.useImperativeHandle(P,M,Ne)},Ce.useInsertionEffect=function(P,M){return B.current.useInsertionEffect(P,M)},Ce.useLayoutEffect=function(P,M){return B.current.useLayoutEffect(P,M)},Ce.useMemo=function(P,M){return B.current.useMemo(P,M)},Ce.useReducer=function(P,M,Ne){return B.current.useReducer(P,M,Ne)},Ce.useRef=function(P){return B.current.useRef(P)},Ce.useState=function(P){return B.current.useState(P)},Ce.useSyncExternalStore=function(P,M,Ne){return B.current.useSyncExternalStore(P,M,Ne)},Ce.useTransition=function(){return B.current.useTransition()},Ce.version="18.3.1",Ce}var lp;function Vu(){return lp||(lp=1,Xc.exports=x0()),Xc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cp;function w0(){if(cp)return Fi;cp=1;var n=Vu(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function d(f,p,g){var y,x={},w=null,b=null;g!==void 0&&(w=""+g),p.key!==void 0&&(w=""+p.key),p.ref!==void 0&&(b=p.ref);for(y in p)a.call(p,y)&&!u.hasOwnProperty(y)&&(x[y]=p[y]);if(f&&f.defaultProps)for(y in p=f.defaultProps,p)x[y]===void 0&&(x[y]=p[y]);return{$$typeof:t,type:f,key:w,ref:b,props:x,_owner:l.current}}return Fi.Fragment=s,Fi.jsx=d,Fi.jsxs=d,Fi}var up;function b0(){return up||(up=1,Yc.exports=w0()),Yc.exports}var i=b0(),E=Vu();const Hu=bm(E);var No={},Zc={exports:{}},kt={},eu={exports:{}},tu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dp;function _0(){return dp||(dp=1,(function(n){function t(z,W){var Q=z.length;z.push(W);e:for(;0<Q;){var P=Q-1>>>1,M=z[P];if(0<l(M,W))z[P]=W,z[Q]=M,Q=P;else break e}}function s(z){return z.length===0?null:z[0]}function a(z){if(z.length===0)return null;var W=z[0],Q=z.pop();if(Q!==W){z[0]=Q;e:for(var P=0,M=z.length,Ne=M>>>1;P<Ne;){var ke=2*(P+1)-1,F=z[ke],X=ke+1,oe=z[X];if(0>l(F,Q))X<M&&0>l(oe,F)?(z[P]=oe,z[X]=Q,P=X):(z[P]=F,z[ke]=Q,P=ke);else if(X<M&&0>l(oe,Q))z[P]=oe,z[X]=Q,P=X;else break e}}return W}function l(z,W){var Q=z.sortIndex-W.sortIndex;return Q!==0?Q:z.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],g=[],y=1,x=null,w=3,b=!1,S=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(z){for(var W=s(g);W!==null;){if(W.callback===null)a(g);else if(W.startTime<=z)a(g),W.sortIndex=W.expirationTime,t(p,W);else break;W=s(g)}}function $(z){if(_=!1,T(z),!S)if(s(p)!==null)S=!0,me(K);else{var W=s(g);W!==null&&B($,W.startTime-z)}}function K(z,W){S=!1,_&&(_=!1,N(se),se=-1),b=!0;var Q=w;try{for(T(W),x=s(p);x!==null&&(!(x.expirationTime>W)||z&&!te());){var P=x.callback;if(typeof P=="function"){x.callback=null,w=x.priorityLevel;var M=P(x.expirationTime<=W);W=n.unstable_now(),typeof M=="function"?x.callback=M:x===s(p)&&a(p),T(W)}else a(p);x=s(p)}if(x!==null)var Ne=!0;else{var ke=s(g);ke!==null&&B($,ke.startTime-W),Ne=!1}return Ne}finally{x=null,w=Q,b=!1}}var J=!1,Z=null,se=-1,ce=5,U=-1;function te(){return!(n.unstable_now()-U<ce)}function he(){if(Z!==null){var z=n.unstable_now();U=z;var W=!0;try{W=Z(!0,z)}finally{W?q():(J=!1,Z=null)}}else J=!1}var q;if(typeof A=="function")q=function(){A(he)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ee=re.port2;re.port1.onmessage=he,q=function(){ee.postMessage(null)}}else q=function(){j(he,0)};function me(z){Z=z,J||(J=!0,q())}function B(z,W){se=j(function(){z(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){S||b||(S=!0,me(K))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_getFirstCallbackNode=function(){return s(p)},n.unstable_next=function(z){switch(w){case 1:case 2:case 3:var W=3;break;default:W=w}var Q=w;w=W;try{return z()}finally{w=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,W){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Q=w;w=z;try{return W()}finally{w=Q}},n.unstable_scheduleCallback=function(z,W,Q){var P=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?P+Q:P):Q=P,z){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=Q+M,z={id:y++,callback:W,priorityLevel:z,startTime:Q,expirationTime:M,sortIndex:-1},Q>P?(z.sortIndex=Q,t(g,z),s(p)===null&&z===s(g)&&(_?(N(se),se=-1):_=!0,B($,Q-P))):(z.sortIndex=M,t(p,z),S||b||(S=!0,me(K))),z},n.unstable_shouldYield=te,n.unstable_wrapCallback=function(z){var W=w;return function(){var Q=w;w=W;try{return z.apply(this,arguments)}finally{w=Q}}}})(tu)),tu}var hp;function j0(){return hp||(hp=1,eu.exports=_0()),eu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fp;function S0(){if(fp)return kt;fp=1;var n=Vu(),t=j0();function s(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,l={};function u(e,r){d(e,r),d(e+"Capture",r)}function d(e,r){for(l[e]=r,e=0;e<r.length;e++)a.add(r[e])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function w(e){return p.call(x,e)?!0:p.call(y,e)?!1:g.test(e)?x[e]=!0:(y[e]=!0,!1)}function b(e,r,o,c){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function S(e,r,o,c){if(r===null||typeof r>"u"||b(e,r,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function _(e,r,o,c,h,m,v){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=o,this.propertyName=e,this.type=r,this.sanitizeURL=m,this.removeEmptyString=v}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){j[e]=new _(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];j[r]=new _(r,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){j[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){j[e]=new _(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){j[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){j[e]=new _(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){j[e]=new _(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){j[e]=new _(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){j[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function A(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(N,A);j[r]=new _(r,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(N,A);j[r]=new _(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(N,A);j[r]=new _(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){j[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){j[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)});function T(e,r,o,c){var h=j.hasOwnProperty(r)?j[r]:null;(h!==null?h.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(S(r,o,h,c)&&(o=null),c||h===null?w(r)&&(o===null?e.removeAttribute(r):e.setAttribute(r,""+o)):h.mustUseProperty?e[h.propertyName]=o===null?h.type===3?!1:"":o:(r=h.attributeName,c=h.attributeNamespace,o===null?e.removeAttribute(r):(h=h.type,o=h===3||h===4&&o===!0?"":""+o,c?e.setAttributeNS(c,r,o):e.setAttribute(r,o))))}var $=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),J=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),ce=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),te=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),z=Symbol.iterator;function W(e){return e===null||typeof e!="object"?null:(e=z&&e[z]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Object.assign,P;function M(e){if(P===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);P=r&&r[1]||""}return`
`+P+e}var Ne=!1;function ke(e,r){if(!e||Ne)return"";Ne=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(D){var c=D}Reflect.construct(e,[],r)}else{try{r.call()}catch(D){c=D}e.call(r.prototype)}else{try{throw Error()}catch(D){c=D}e()}}catch(D){if(D&&c&&typeof D.stack=="string"){for(var h=D.stack.split(`
`),m=c.stack.split(`
`),v=h.length-1,k=m.length-1;1<=v&&0<=k&&h[v]!==m[k];)k--;for(;1<=v&&0<=k;v--,k--)if(h[v]!==m[k]){if(v!==1||k!==1)do if(v--,k--,0>k||h[v]!==m[k]){var R=`
`+h[v].replace(" at new "," at ");return e.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",e.displayName)),R}while(1<=v&&0<=k);break}}}finally{Ne=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?M(e):""}function F(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=ke(e.type,!1),e;case 11:return e=ke(e.type.render,!1),e;case 1:return e=ke(e.type,!0),e;default:return""}}function X(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Z:return"Fragment";case J:return"Portal";case ce:return"Profiler";case se:return"StrictMode";case q:return"Suspense";case re:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case te:return(e.displayName||"Context")+".Consumer";case U:return(e._context.displayName||"Context")+".Provider";case he:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ee:return r=e.displayName||null,r!==null?r:X(e.type)||"Memo";case me:r=e._payload,e=e._init;try{return X(e(r))}catch{}}return null}function oe(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(r);case 8:return r===se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function ge(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function be(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ye(e){var r=be(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),c=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,m=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return h.call(this)},set:function(v){c=""+v,m.call(this,v)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(v){c=""+v},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function fa(e){e._valueTracker||(e._valueTracker=Ye(e))}function dd(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return e&&(c=be(e)?e.checked?"true":"false":e.value),e=c,e!==o?(r.setValue(e),!0):!1}function pa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function nl(e,r){var o=r.checked;return Q({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o!=null?o:e._wrapperState.initialChecked})}function hd(e,r){var o=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;o=ge(r.value!=null?r.value:o),e._wrapperState={initialChecked:c,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function fd(e,r){r=r.checked,r!=null&&T(e,"checked",r,!1)}function sl(e,r){fd(e,r);var o=ge(r.value),c=r.type;if(o!=null)c==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?il(e,r.type,o):r.hasOwnProperty("defaultValue")&&il(e,r.type,ge(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function pd(e,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,o||r===e.value||(e.value=r),e.defaultValue=r}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function il(e,r,o){(r!=="number"||pa(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var ri=Array.isArray;function Jn(e,r,o,c){if(e=e.options,r){r={};for(var h=0;h<o.length;h++)r["$"+o[h]]=!0;for(o=0;o<e.length;o++)h=r.hasOwnProperty("$"+e[o].value),e[o].selected!==h&&(e[o].selected=h),h&&c&&(e[o].defaultSelected=!0)}else{for(o=""+ge(o),r=null,h=0;h<e.length;h++){if(e[h].value===o){e[h].selected=!0,c&&(e[h].defaultSelected=!0);return}r!==null||e[h].disabled||(r=e[h])}r!==null&&(r.selected=!0)}}function al(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(s(91));return Q({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function md(e,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(s(92));if(ri(o)){if(1<o.length)throw Error(s(93));o=o[0]}r=o}r==null&&(r=""),o=r}e._wrapperState={initialValue:ge(o)}}function gd(e,r){var o=ge(r.value),c=ge(r.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),r.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),c!=null&&(e.defaultValue=""+c)}function yd(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function vd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ol(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?vd(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ma,xd=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,c,h){MSApp.execUnsafeLocalFunction(function(){return e(r,o,c,h)})}:e})(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function ni(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var si={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jg=["Webkit","ms","Moz","O"];Object.keys(si).forEach(function(e){jg.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),si[r]=si[e]})});function wd(e,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||si.hasOwnProperty(e)&&si[e]?(""+r).trim():r+"px"}function bd(e,r){e=e.style;for(var o in r)if(r.hasOwnProperty(o)){var c=o.indexOf("--")===0,h=wd(o,r[o],c);o==="float"&&(o="cssFloat"),c?e.setProperty(o,h):e[o]=h}}var Sg=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ll(e,r){if(r){if(Sg[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(s(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(s(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(s(61))}if(r.style!=null&&typeof r.style!="object")throw Error(s(62))}}function cl(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ul=null;function dl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hl=null,Yn=null,Xn=null;function _d(e){if(e=ki(e)){if(typeof hl!="function")throw Error(s(280));var r=e.stateNode;r&&(r=za(r),hl(e.stateNode,e.type,r))}}function jd(e){Yn?Xn?Xn.push(e):Xn=[e]:Yn=e}function Sd(){if(Yn){var e=Yn,r=Xn;if(Xn=Yn=null,_d(e),r)for(e=0;e<r.length;e++)_d(r[e])}}function Nd(e,r){return e(r)}function kd(){}var fl=!1;function Ed(e,r,o){if(fl)return e(r,o);fl=!0;try{return Nd(e,r,o)}finally{fl=!1,(Yn!==null||Xn!==null)&&(kd(),Sd())}}function ii(e,r){var o=e.stateNode;if(o===null)return null;var c=za(o);if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(s(231,r,typeof o));return o}var pl=!1;if(f)try{var ai={};Object.defineProperty(ai,"passive",{get:function(){pl=!0}}),window.addEventListener("test",ai,ai),window.removeEventListener("test",ai,ai)}catch{pl=!1}function Ng(e,r,o,c,h,m,v,k,R){var D=Array.prototype.slice.call(arguments,3);try{r.apply(o,D)}catch(H){this.onError(H)}}var oi=!1,ga=null,ya=!1,ml=null,kg={onError:function(e){oi=!0,ga=e}};function Eg(e,r,o,c,h,m,v,k,R){oi=!1,ga=null,Ng.apply(kg,arguments)}function Cg(e,r,o,c,h,m,v,k,R){if(Eg.apply(this,arguments),oi){if(oi){var D=ga;oi=!1,ga=null}else throw Error(s(198));ya||(ya=!0,ml=D)}}function vn(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function Cd(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function Rd(e){if(vn(e)!==e)throw Error(s(188))}function Rg(e){var r=e.alternate;if(!r){if(r=vn(e),r===null)throw Error(s(188));return r!==e?null:e}for(var o=e,c=r;;){var h=o.return;if(h===null)break;var m=h.alternate;if(m===null){if(c=h.return,c!==null){o=c;continue}break}if(h.child===m.child){for(m=h.child;m;){if(m===o)return Rd(h),e;if(m===c)return Rd(h),r;m=m.sibling}throw Error(s(188))}if(o.return!==c.return)o=h,c=m;else{for(var v=!1,k=h.child;k;){if(k===o){v=!0,o=h,c=m;break}if(k===c){v=!0,c=h,o=m;break}k=k.sibling}if(!v){for(k=m.child;k;){if(k===o){v=!0,o=m,c=h;break}if(k===c){v=!0,c=m,o=h;break}k=k.sibling}if(!v)throw Error(s(189))}}if(o.alternate!==c)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?e:r}function Pd(e){return e=Rg(e),e!==null?Td(e):null}function Td(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=Td(e);if(r!==null)return r;e=e.sibling}return null}var Od=t.unstable_scheduleCallback,Ad=t.unstable_cancelCallback,Pg=t.unstable_shouldYield,Tg=t.unstable_requestPaint,We=t.unstable_now,Og=t.unstable_getCurrentPriorityLevel,gl=t.unstable_ImmediatePriority,Id=t.unstable_UserBlockingPriority,va=t.unstable_NormalPriority,Ag=t.unstable_LowPriority,Ld=t.unstable_IdlePriority,xa=null,ur=null;function Ig(e){if(ur&&typeof ur.onCommitFiberRoot=="function")try{ur.onCommitFiberRoot(xa,e,void 0,(e.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:Dg,Lg=Math.log,$g=Math.LN2;function Dg(e){return e>>>=0,e===0?32:31-(Lg(e)/$g|0)|0}var wa=64,ba=4194304;function li(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function _a(e,r){var o=e.pendingLanes;if(o===0)return 0;var c=0,h=e.suspendedLanes,m=e.pingedLanes,v=o&268435455;if(v!==0){var k=v&~h;k!==0?c=li(k):(m&=v,m!==0&&(c=li(m)))}else v=o&~h,v!==0?c=li(v):m!==0&&(c=li(m));if(c===0)return 0;if(r!==0&&r!==c&&(r&h)===0&&(h=c&-c,m=r&-r,h>=m||h===16&&(m&4194240)!==0))return r;if((c&4)!==0&&(c|=o&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=c;0<r;)o=31-Yt(r),h=1<<o,c|=e[o],r&=~h;return c}function zg(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ug(e,r){for(var o=e.suspendedLanes,c=e.pingedLanes,h=e.expirationTimes,m=e.pendingLanes;0<m;){var v=31-Yt(m),k=1<<v,R=h[v];R===-1?((k&o)===0||(k&c)!==0)&&(h[v]=zg(k,r)):R<=r&&(e.expiredLanes|=k),m&=~k}}function yl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $d(){var e=wa;return wa<<=1,(wa&4194240)===0&&(wa=64),e}function vl(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function ci(e,r,o){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Yt(r),e[r]=o}function Mg(e,r){var o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<o;){var h=31-Yt(o),m=1<<h;r[h]=0,c[h]=-1,e[h]=-1,o&=~m}}function xl(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var c=31-Yt(o),h=1<<c;h&r|e[c]&r&&(e[c]|=r),o&=~h}}var Ae=0;function Dd(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var zd,wl,Ud,Md,Fd,bl=!1,ja=[],Ur=null,Mr=null,Fr=null,ui=new Map,di=new Map,qr=[],Fg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qd(e,r){switch(e){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":Fr=null;break;case"pointerover":case"pointerout":ui.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":di.delete(r.pointerId)}}function hi(e,r,o,c,h,m){return e===null||e.nativeEvent!==m?(e={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[h]},r!==null&&(r=ki(r),r!==null&&wl(r)),e):(e.eventSystemFlags|=c,r=e.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),e)}function qg(e,r,o,c,h){switch(r){case"focusin":return Ur=hi(Ur,e,r,o,c,h),!0;case"dragenter":return Mr=hi(Mr,e,r,o,c,h),!0;case"mouseover":return Fr=hi(Fr,e,r,o,c,h),!0;case"pointerover":var m=h.pointerId;return ui.set(m,hi(ui.get(m)||null,e,r,o,c,h)),!0;case"gotpointercapture":return m=h.pointerId,di.set(m,hi(di.get(m)||null,e,r,o,c,h)),!0}return!1}function Bd(e){var r=xn(e.target);if(r!==null){var o=vn(r);if(o!==null){if(r=o.tag,r===13){if(r=Cd(o),r!==null){e.blockedOn=r,Fd(e.priority,function(){Ud(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sa(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=jl(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var c=new o.constructor(o.type,o);ul=c,o.target.dispatchEvent(c),ul=null}else return r=ki(o),r!==null&&wl(r),e.blockedOn=o,!1;r.shift()}return!0}function Vd(e,r,o){Sa(e)&&o.delete(r)}function Bg(){bl=!1,Ur!==null&&Sa(Ur)&&(Ur=null),Mr!==null&&Sa(Mr)&&(Mr=null),Fr!==null&&Sa(Fr)&&(Fr=null),ui.forEach(Vd),di.forEach(Vd)}function fi(e,r){e.blockedOn===r&&(e.blockedOn=null,bl||(bl=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Bg)))}function pi(e){function r(h){return fi(h,e)}if(0<ja.length){fi(ja[0],e);for(var o=1;o<ja.length;o++){var c=ja[o];c.blockedOn===e&&(c.blockedOn=null)}}for(Ur!==null&&fi(Ur,e),Mr!==null&&fi(Mr,e),Fr!==null&&fi(Fr,e),ui.forEach(r),di.forEach(r),o=0;o<qr.length;o++)c=qr[o],c.blockedOn===e&&(c.blockedOn=null);for(;0<qr.length&&(o=qr[0],o.blockedOn===null);)Bd(o),o.blockedOn===null&&qr.shift()}var Zn=$.ReactCurrentBatchConfig,Na=!0;function Vg(e,r,o,c){var h=Ae,m=Zn.transition;Zn.transition=null;try{Ae=1,_l(e,r,o,c)}finally{Ae=h,Zn.transition=m}}function Hg(e,r,o,c){var h=Ae,m=Zn.transition;Zn.transition=null;try{Ae=4,_l(e,r,o,c)}finally{Ae=h,Zn.transition=m}}function _l(e,r,o,c){if(Na){var h=jl(e,r,o,c);if(h===null)Ml(e,r,c,ka,o),qd(e,c);else if(qg(h,e,r,o,c))c.stopPropagation();else if(qd(e,c),r&4&&-1<Fg.indexOf(e)){for(;h!==null;){var m=ki(h);if(m!==null&&zd(m),m=jl(e,r,o,c),m===null&&Ml(e,r,c,ka,o),m===h)break;h=m}h!==null&&c.stopPropagation()}else Ml(e,r,c,null,o)}}var ka=null;function jl(e,r,o,c){if(ka=null,e=dl(c),e=xn(e),e!==null)if(r=vn(e),r===null)e=null;else if(o=r.tag,o===13){if(e=Cd(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return ka=e,null}function Hd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Og()){case gl:return 1;case Id:return 4;case va:case Ag:return 16;case Ld:return 536870912;default:return 16}default:return 16}}var Br=null,Sl=null,Ea=null;function Kd(){if(Ea)return Ea;var e,r=Sl,o=r.length,c,h="value"in Br?Br.value:Br.textContent,m=h.length;for(e=0;e<o&&r[e]===h[e];e++);var v=o-e;for(c=1;c<=v&&r[o-c]===h[m-c];c++);return Ea=h.slice(e,1<c?1-c:void 0)}function Ca(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Ra(){return!0}function Wd(){return!1}function Ot(e){function r(o,c,h,m,v){this._reactName=o,this._targetInst=h,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var k in e)e.hasOwnProperty(k)&&(o=e[k],this[k]=o?o(m):m[k]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ra:Wd,this.isPropagationStopped=Wd,this}return Q(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ra)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ra)},persist:function(){},isPersistent:Ra}),r}var es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nl=Ot(es),mi=Q({},es,{view:0,detail:0}),Kg=Ot(mi),kl,El,gi,Pa=Q({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gi&&(gi&&e.type==="mousemove"?(kl=e.screenX-gi.screenX,El=e.screenY-gi.screenY):El=kl=0,gi=e),kl)},movementY:function(e){return"movementY"in e?e.movementY:El}}),Qd=Ot(Pa),Wg=Q({},Pa,{dataTransfer:0}),Qg=Ot(Wg),Gg=Q({},mi,{relatedTarget:0}),Cl=Ot(Gg),Jg=Q({},es,{animationName:0,elapsedTime:0,pseudoElement:0}),Yg=Ot(Jg),Xg=Q({},es,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zg=Ot(Xg),ey=Q({},es,{data:0}),Gd=Ot(ey),ty={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ry={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ny={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sy(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=ny[e])?!!r[e]:!1}function Rl(){return sy}var iy=Q({},mi,{key:function(e){if(e.key){var r=ty[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Ca(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ry[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rl,charCode:function(e){return e.type==="keypress"?Ca(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ca(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ay=Ot(iy),oy=Q({},Pa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jd=Ot(oy),ly=Q({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rl}),cy=Ot(ly),uy=Q({},es,{propertyName:0,elapsedTime:0,pseudoElement:0}),dy=Ot(uy),hy=Q({},Pa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fy=Ot(hy),py=[9,13,27,32],Pl=f&&"CompositionEvent"in window,yi=null;f&&"documentMode"in document&&(yi=document.documentMode);var my=f&&"TextEvent"in window&&!yi,Yd=f&&(!Pl||yi&&8<yi&&11>=yi),Xd=" ",Zd=!1;function eh(e,r){switch(e){case"keyup":return py.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function th(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ts=!1;function gy(e,r){switch(e){case"compositionend":return th(r);case"keypress":return r.which!==32?null:(Zd=!0,Xd);case"textInput":return e=r.data,e===Xd&&Zd?null:e;default:return null}}function yy(e,r){if(ts)return e==="compositionend"||!Pl&&eh(e,r)?(e=Kd(),Ea=Sl=Br=null,ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Yd&&r.locale!=="ko"?null:r.data;default:return null}}var vy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rh(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!vy[e.type]:r==="textarea"}function nh(e,r,o,c){jd(c),r=La(r,"onChange"),0<r.length&&(o=new Nl("onChange","change",null,o,c),e.push({event:o,listeners:r}))}var vi=null,xi=null;function xy(e){bh(e,0)}function Ta(e){var r=as(e);if(dd(r))return e}function wy(e,r){if(e==="change")return r}var sh=!1;if(f){var Tl;if(f){var Ol="oninput"in document;if(!Ol){var ih=document.createElement("div");ih.setAttribute("oninput","return;"),Ol=typeof ih.oninput=="function"}Tl=Ol}else Tl=!1;sh=Tl&&(!document.documentMode||9<document.documentMode)}function ah(){vi&&(vi.detachEvent("onpropertychange",oh),xi=vi=null)}function oh(e){if(e.propertyName==="value"&&Ta(xi)){var r=[];nh(r,xi,e,dl(e)),Ed(xy,r)}}function by(e,r,o){e==="focusin"?(ah(),vi=r,xi=o,vi.attachEvent("onpropertychange",oh)):e==="focusout"&&ah()}function _y(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ta(xi)}function jy(e,r){if(e==="click")return Ta(r)}function Sy(e,r){if(e==="input"||e==="change")return Ta(r)}function Ny(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Xt=typeof Object.is=="function"?Object.is:Ny;function wi(e,r){if(Xt(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var h=o[c];if(!p.call(r,h)||!Xt(e[h],r[h]))return!1}return!0}function lh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ch(e,r){var o=lh(e);e=0;for(var c;o;){if(o.nodeType===3){if(c=e+o.textContent.length,e<=r&&c>=r)return{node:o,offset:r-e};e=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=lh(o)}}function uh(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?uh(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function dh(){for(var e=window,r=pa();r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=pa(e.document)}return r}function Al(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function ky(e){var r=dh(),o=e.focusedElem,c=e.selectionRange;if(r!==o&&o&&o.ownerDocument&&uh(o.ownerDocument.documentElement,o)){if(c!==null&&Al(o)){if(r=c.start,e=c.end,e===void 0&&(e=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(e,o.value.length);else if(e=(r=o.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var h=o.textContent.length,m=Math.min(c.start,h);c=c.end===void 0?m:Math.min(c.end,h),!e.extend&&m>c&&(h=c,c=m,m=h),h=ch(o,m);var v=ch(o,c);h&&v&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),e.removeAllRanges(),m>c?(e.addRange(r),e.extend(v.node,v.offset)):(r.setEnd(v.node,v.offset),e.addRange(r)))}}for(r=[],e=o;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)e=r[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ey=f&&"documentMode"in document&&11>=document.documentMode,rs=null,Il=null,bi=null,Ll=!1;function hh(e,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ll||rs==null||rs!==pa(c)||(c=rs,"selectionStart"in c&&Al(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),bi&&wi(bi,c)||(bi=c,c=La(Il,"onSelect"),0<c.length&&(r=new Nl("onSelect","select",null,r,o),e.push({event:r,listeners:c}),r.target=rs)))}function Oa(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var ns={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionend:Oa("Transition","TransitionEnd")},$l={},fh={};f&&(fh=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function Aa(e){if($l[e])return $l[e];if(!ns[e])return e;var r=ns[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in fh)return $l[e]=r[o];return e}var ph=Aa("animationend"),mh=Aa("animationiteration"),gh=Aa("animationstart"),yh=Aa("transitionend"),vh=new Map,xh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vr(e,r){vh.set(e,r),u(r,[e])}for(var Dl=0;Dl<xh.length;Dl++){var zl=xh[Dl],Cy=zl.toLowerCase(),Ry=zl[0].toUpperCase()+zl.slice(1);Vr(Cy,"on"+Ry)}Vr(ph,"onAnimationEnd"),Vr(mh,"onAnimationIteration"),Vr(gh,"onAnimationStart"),Vr("dblclick","onDoubleClick"),Vr("focusin","onFocus"),Vr("focusout","onBlur"),Vr(yh,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _i="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Py=new Set("cancel close invalid load scroll toggle".split(" ").concat(_i));function wh(e,r,o){var c=e.type||"unknown-event";e.currentTarget=o,Cg(c,r,void 0,e),e.currentTarget=null}function bh(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var c=e[o],h=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var v=c.length-1;0<=v;v--){var k=c[v],R=k.instance,D=k.currentTarget;if(k=k.listener,R!==m&&h.isPropagationStopped())break e;wh(h,k,D),m=R}else for(v=0;v<c.length;v++){if(k=c[v],R=k.instance,D=k.currentTarget,k=k.listener,R!==m&&h.isPropagationStopped())break e;wh(h,k,D),m=R}}}if(ya)throw e=ml,ya=!1,ml=null,e}function $e(e,r){var o=r[Kl];o===void 0&&(o=r[Kl]=new Set);var c=e+"__bubble";o.has(c)||(_h(r,e,2,!1),o.add(c))}function Ul(e,r,o){var c=0;r&&(c|=4),_h(o,e,c,r)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function ji(e){if(!e[Ia]){e[Ia]=!0,a.forEach(function(o){o!=="selectionchange"&&(Py.has(o)||Ul(o,!1,e),Ul(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Ia]||(r[Ia]=!0,Ul("selectionchange",!1,r))}}function _h(e,r,o,c){switch(Hd(r)){case 1:var h=Vg;break;case 4:h=Hg;break;default:h=_l}o=h.bind(null,r,o,e),h=void 0,!pl||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?e.addEventListener(r,o,{capture:!0,passive:h}):e.addEventListener(r,o,!0):h!==void 0?e.addEventListener(r,o,{passive:h}):e.addEventListener(r,o,!1)}function Ml(e,r,o,c,h){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var k=c.stateNode.containerInfo;if(k===h||k.nodeType===8&&k.parentNode===h)break;if(v===4)for(v=c.return;v!==null;){var R=v.tag;if((R===3||R===4)&&(R=v.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;v=v.return}for(;k!==null;){if(v=xn(k),v===null)return;if(R=v.tag,R===5||R===6){c=m=v;continue e}k=k.parentNode}}c=c.return}Ed(function(){var D=m,H=dl(o),G=[];e:{var V=vh.get(e);if(V!==void 0){var ie=Nl,le=e;switch(e){case"keypress":if(Ca(o)===0)break e;case"keydown":case"keyup":ie=ay;break;case"focusin":le="focus",ie=Cl;break;case"focusout":le="blur",ie=Cl;break;case"beforeblur":case"afterblur":ie=Cl;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=Qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=Qg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=cy;break;case ph:case mh:case gh:ie=Yg;break;case yh:ie=dy;break;case"scroll":ie=Kg;break;case"wheel":ie=fy;break;case"copy":case"cut":case"paste":ie=Zg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=Jd}var de=(r&4)!==0,Qe=!de&&e==="scroll",I=de?V!==null?V+"Capture":null:V;de=[];for(var O=D,L;O!==null;){L=O;var Y=L.stateNode;if(L.tag===5&&Y!==null&&(L=Y,I!==null&&(Y=ii(O,I),Y!=null&&de.push(Si(O,Y,L)))),Qe)break;O=O.return}0<de.length&&(V=new ie(V,le,null,o,H),G.push({event:V,listeners:de}))}}if((r&7)===0){e:{if(V=e==="mouseover"||e==="pointerover",ie=e==="mouseout"||e==="pointerout",V&&o!==ul&&(le=o.relatedTarget||o.fromElement)&&(xn(le)||le[wr]))break e;if((ie||V)&&(V=H.window===H?H:(V=H.ownerDocument)?V.defaultView||V.parentWindow:window,ie?(le=o.relatedTarget||o.toElement,ie=D,le=le?xn(le):null,le!==null&&(Qe=vn(le),le!==Qe||le.tag!==5&&le.tag!==6)&&(le=null)):(ie=null,le=D),ie!==le)){if(de=Qd,Y="onMouseLeave",I="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(de=Jd,Y="onPointerLeave",I="onPointerEnter",O="pointer"),Qe=ie==null?V:as(ie),L=le==null?V:as(le),V=new de(Y,O+"leave",ie,o,H),V.target=Qe,V.relatedTarget=L,Y=null,xn(H)===D&&(de=new de(I,O+"enter",le,o,H),de.target=L,de.relatedTarget=Qe,Y=de),Qe=Y,ie&&le)t:{for(de=ie,I=le,O=0,L=de;L;L=ss(L))O++;for(L=0,Y=I;Y;Y=ss(Y))L++;for(;0<O-L;)de=ss(de),O--;for(;0<L-O;)I=ss(I),L--;for(;O--;){if(de===I||I!==null&&de===I.alternate)break t;de=ss(de),I=ss(I)}de=null}else de=null;ie!==null&&jh(G,V,ie,de,!1),le!==null&&Qe!==null&&jh(G,Qe,le,de,!0)}}e:{if(V=D?as(D):window,ie=V.nodeName&&V.nodeName.toLowerCase(),ie==="select"||ie==="input"&&V.type==="file")var fe=wy;else if(rh(V))if(sh)fe=Sy;else{fe=_y;var ve=by}else(ie=V.nodeName)&&ie.toLowerCase()==="input"&&(V.type==="checkbox"||V.type==="radio")&&(fe=jy);if(fe&&(fe=fe(e,D))){nh(G,fe,o,H);break e}ve&&ve(e,V,D),e==="focusout"&&(ve=V._wrapperState)&&ve.controlled&&V.type==="number"&&il(V,"number",V.value)}switch(ve=D?as(D):window,e){case"focusin":(rh(ve)||ve.contentEditable==="true")&&(rs=ve,Il=D,bi=null);break;case"focusout":bi=Il=rs=null;break;case"mousedown":Ll=!0;break;case"contextmenu":case"mouseup":case"dragend":Ll=!1,hh(G,o,H);break;case"selectionchange":if(Ey)break;case"keydown":case"keyup":hh(G,o,H)}var xe;if(Pl)e:{switch(e){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else ts?eh(e,o)&&(Se="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Se="onCompositionStart");Se&&(Yd&&o.locale!=="ko"&&(ts||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&ts&&(xe=Kd()):(Br=H,Sl="value"in Br?Br.value:Br.textContent,ts=!0)),ve=La(D,Se),0<ve.length&&(Se=new Gd(Se,e,null,o,H),G.push({event:Se,listeners:ve}),xe?Se.data=xe:(xe=th(o),xe!==null&&(Se.data=xe)))),(xe=my?gy(e,o):yy(e,o))&&(D=La(D,"onBeforeInput"),0<D.length&&(H=new Gd("onBeforeInput","beforeinput",null,o,H),G.push({event:H,listeners:D}),H.data=xe))}bh(G,r)})}function Si(e,r,o){return{instance:e,listener:r,currentTarget:o}}function La(e,r){for(var o=r+"Capture",c=[];e!==null;){var h=e,m=h.stateNode;h.tag===5&&m!==null&&(h=m,m=ii(e,o),m!=null&&c.unshift(Si(e,m,h)),m=ii(e,r),m!=null&&c.push(Si(e,m,h))),e=e.return}return c}function ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jh(e,r,o,c,h){for(var m=r._reactName,v=[];o!==null&&o!==c;){var k=o,R=k.alternate,D=k.stateNode;if(R!==null&&R===c)break;k.tag===5&&D!==null&&(k=D,h?(R=ii(o,m),R!=null&&v.unshift(Si(o,R,k))):h||(R=ii(o,m),R!=null&&v.push(Si(o,R,k)))),o=o.return}v.length!==0&&e.push({event:r,listeners:v})}var Ty=/\r\n?/g,Oy=/\u0000|\uFFFD/g;function Sh(e){return(typeof e=="string"?e:""+e).replace(Ty,`
`).replace(Oy,"")}function $a(e,r,o){if(r=Sh(r),Sh(e)!==r&&o)throw Error(s(425))}function Da(){}var Fl=null,ql=null;function Bl(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Vl=typeof setTimeout=="function"?setTimeout:void 0,Ay=typeof clearTimeout=="function"?clearTimeout:void 0,Nh=typeof Promise=="function"?Promise:void 0,Iy=typeof queueMicrotask=="function"?queueMicrotask:typeof Nh<"u"?function(e){return Nh.resolve(null).then(e).catch(Ly)}:Vl;function Ly(e){setTimeout(function(){throw e})}function Hl(e,r){var o=r,c=0;do{var h=o.nextSibling;if(e.removeChild(o),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(c===0){e.removeChild(h),pi(r);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=h}while(o);pi(r)}function Hr(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function kh(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}var is=Math.random().toString(36).slice(2),dr="__reactFiber$"+is,Ni="__reactProps$"+is,wr="__reactContainer$"+is,Kl="__reactEvents$"+is,$y="__reactListeners$"+is,Dy="__reactHandles$"+is;function xn(e){var r=e[dr];if(r)return r;for(var o=e.parentNode;o;){if(r=o[wr]||o[dr]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=kh(e);e!==null;){if(o=e[dr])return o;e=kh(e)}return r}e=o,o=e.parentNode}return null}function ki(e){return e=e[dr]||e[wr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function as(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(s(33))}function za(e){return e[Ni]||null}var Wl=[],os=-1;function Kr(e){return{current:e}}function De(e){0>os||(e.current=Wl[os],Wl[os]=null,os--)}function Ie(e,r){os++,Wl[os]=e.current,e.current=r}var Wr={},ut=Kr(Wr),bt=Kr(!1),wn=Wr;function ls(e,r){var o=e.type.contextTypes;if(!o)return Wr;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var h={},m;for(m in o)h[m]=r[m];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=h),h}function _t(e){return e=e.childContextTypes,e!=null}function Ua(){De(bt),De(ut)}function Eh(e,r,o){if(ut.current!==Wr)throw Error(s(168));Ie(ut,r),Ie(bt,o)}function Ch(e,r,o){var c=e.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var h in c)if(!(h in r))throw Error(s(108,oe(e)||"Unknown",h));return Q({},o,c)}function Ma(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Wr,wn=ut.current,Ie(ut,e),Ie(bt,bt.current),!0}function Rh(e,r,o){var c=e.stateNode;if(!c)throw Error(s(169));o?(e=Ch(e,r,wn),c.__reactInternalMemoizedMergedChildContext=e,De(bt),De(ut),Ie(ut,e)):De(bt),Ie(bt,o)}var br=null,Fa=!1,Ql=!1;function Ph(e){br===null?br=[e]:br.push(e)}function zy(e){Fa=!0,Ph(e)}function Qr(){if(!Ql&&br!==null){Ql=!0;var e=0,r=Ae;try{var o=br;for(Ae=1;e<o.length;e++){var c=o[e];do c=c(!0);while(c!==null)}br=null,Fa=!1}catch(h){throw br!==null&&(br=br.slice(e+1)),Od(gl,Qr),h}finally{Ae=r,Ql=!1}}return null}var cs=[],us=0,qa=null,Ba=0,Ut=[],Mt=0,bn=null,_r=1,jr="";function _n(e,r){cs[us++]=Ba,cs[us++]=qa,qa=e,Ba=r}function Th(e,r,o){Ut[Mt++]=_r,Ut[Mt++]=jr,Ut[Mt++]=bn,bn=e;var c=_r;e=jr;var h=32-Yt(c)-1;c&=~(1<<h),o+=1;var m=32-Yt(r)+h;if(30<m){var v=h-h%5;m=(c&(1<<v)-1).toString(32),c>>=v,h-=v,_r=1<<32-Yt(r)+h|o<<h|c,jr=m+e}else _r=1<<m|o<<h|c,jr=e}function Gl(e){e.return!==null&&(_n(e,1),Th(e,1,0))}function Jl(e){for(;e===qa;)qa=cs[--us],cs[us]=null,Ba=cs[--us],cs[us]=null;for(;e===bn;)bn=Ut[--Mt],Ut[Mt]=null,jr=Ut[--Mt],Ut[Mt]=null,_r=Ut[--Mt],Ut[Mt]=null}var At=null,It=null,Ue=!1,Zt=null;function Oh(e,r){var o=Vt(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=e,r=e.deletions,r===null?(e.deletions=[o],e.flags|=16):r.push(o)}function Ah(e,r){switch(e.tag){case 5:var o=e.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,At=e,It=Hr(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,At=e,It=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=bn!==null?{id:_r,overflow:jr}:null,e.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=Vt(18,null,null,0),o.stateNode=r,o.return=e,e.child=o,At=e,It=null,!0):!1;default:return!1}}function Yl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xl(e){if(Ue){var r=It;if(r){var o=r;if(!Ah(e,r)){if(Yl(e))throw Error(s(418));r=Hr(o.nextSibling);var c=At;r&&Ah(e,r)?Oh(c,o):(e.flags=e.flags&-4097|2,Ue=!1,At=e)}}else{if(Yl(e))throw Error(s(418));e.flags=e.flags&-4097|2,Ue=!1,At=e}}}function Ih(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;At=e}function Va(e){if(e!==At)return!1;if(!Ue)return Ih(e),Ue=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!Bl(e.type,e.memoizedProps)),r&&(r=It)){if(Yl(e))throw Lh(),Error(s(418));for(;r;)Oh(e,r),r=Hr(r.nextSibling)}if(Ih(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(r===0){It=Hr(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}e=e.nextSibling}It=null}}else It=At?Hr(e.stateNode.nextSibling):null;return!0}function Lh(){for(var e=It;e;)e=Hr(e.nextSibling)}function ds(){It=At=null,Ue=!1}function Zl(e){Zt===null?Zt=[e]:Zt.push(e)}var Uy=$.ReactCurrentBatchConfig;function Ei(e,r,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(s(309));var c=o.stateNode}if(!c)throw Error(s(147,e));var h=c,m=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===m?r.ref:(r=function(v){var k=h.refs;v===null?delete k[m]:k[m]=v},r._stringRef=m,r)}if(typeof e!="string")throw Error(s(284));if(!o._owner)throw Error(s(290,e))}return e}function Ha(e,r){throw e=Object.prototype.toString.call(r),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function $h(e){var r=e._init;return r(e._payload)}function Dh(e){function r(I,O){if(e){var L=I.deletions;L===null?(I.deletions=[O],I.flags|=16):L.push(O)}}function o(I,O){if(!e)return null;for(;O!==null;)r(I,O),O=O.sibling;return null}function c(I,O){for(I=new Map;O!==null;)O.key!==null?I.set(O.key,O):I.set(O.index,O),O=O.sibling;return I}function h(I,O){return I=rn(I,O),I.index=0,I.sibling=null,I}function m(I,O,L){return I.index=L,e?(L=I.alternate,L!==null?(L=L.index,L<O?(I.flags|=2,O):L):(I.flags|=2,O)):(I.flags|=1048576,O)}function v(I){return e&&I.alternate===null&&(I.flags|=2),I}function k(I,O,L,Y){return O===null||O.tag!==6?(O=Vc(L,I.mode,Y),O.return=I,O):(O=h(O,L),O.return=I,O)}function R(I,O,L,Y){var fe=L.type;return fe===Z?H(I,O,L.props.children,Y,L.key):O!==null&&(O.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===me&&$h(fe)===O.type)?(Y=h(O,L.props),Y.ref=Ei(I,O,L),Y.return=I,Y):(Y=go(L.type,L.key,L.props,null,I.mode,Y),Y.ref=Ei(I,O,L),Y.return=I,Y)}function D(I,O,L,Y){return O===null||O.tag!==4||O.stateNode.containerInfo!==L.containerInfo||O.stateNode.implementation!==L.implementation?(O=Hc(L,I.mode,Y),O.return=I,O):(O=h(O,L.children||[]),O.return=I,O)}function H(I,O,L,Y,fe){return O===null||O.tag!==7?(O=Pn(L,I.mode,Y,fe),O.return=I,O):(O=h(O,L),O.return=I,O)}function G(I,O,L){if(typeof O=="string"&&O!==""||typeof O=="number")return O=Vc(""+O,I.mode,L),O.return=I,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case K:return L=go(O.type,O.key,O.props,null,I.mode,L),L.ref=Ei(I,null,O),L.return=I,L;case J:return O=Hc(O,I.mode,L),O.return=I,O;case me:var Y=O._init;return G(I,Y(O._payload),L)}if(ri(O)||W(O))return O=Pn(O,I.mode,L,null),O.return=I,O;Ha(I,O)}return null}function V(I,O,L,Y){var fe=O!==null?O.key:null;if(typeof L=="string"&&L!==""||typeof L=="number")return fe!==null?null:k(I,O,""+L,Y);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case K:return L.key===fe?R(I,O,L,Y):null;case J:return L.key===fe?D(I,O,L,Y):null;case me:return fe=L._init,V(I,O,fe(L._payload),Y)}if(ri(L)||W(L))return fe!==null?null:H(I,O,L,Y,null);Ha(I,L)}return null}function ie(I,O,L,Y,fe){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return I=I.get(L)||null,k(O,I,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case K:return I=I.get(Y.key===null?L:Y.key)||null,R(O,I,Y,fe);case J:return I=I.get(Y.key===null?L:Y.key)||null,D(O,I,Y,fe);case me:var ve=Y._init;return ie(I,O,L,ve(Y._payload),fe)}if(ri(Y)||W(Y))return I=I.get(L)||null,H(O,I,Y,fe,null);Ha(O,Y)}return null}function le(I,O,L,Y){for(var fe=null,ve=null,xe=O,Se=O=0,st=null;xe!==null&&Se<L.length;Se++){xe.index>Se?(st=xe,xe=null):st=xe.sibling;var Te=V(I,xe,L[Se],Y);if(Te===null){xe===null&&(xe=st);break}e&&xe&&Te.alternate===null&&r(I,xe),O=m(Te,O,Se),ve===null?fe=Te:ve.sibling=Te,ve=Te,xe=st}if(Se===L.length)return o(I,xe),Ue&&_n(I,Se),fe;if(xe===null){for(;Se<L.length;Se++)xe=G(I,L[Se],Y),xe!==null&&(O=m(xe,O,Se),ve===null?fe=xe:ve.sibling=xe,ve=xe);return Ue&&_n(I,Se),fe}for(xe=c(I,xe);Se<L.length;Se++)st=ie(xe,I,Se,L[Se],Y),st!==null&&(e&&st.alternate!==null&&xe.delete(st.key===null?Se:st.key),O=m(st,O,Se),ve===null?fe=st:ve.sibling=st,ve=st);return e&&xe.forEach(function(nn){return r(I,nn)}),Ue&&_n(I,Se),fe}function de(I,O,L,Y){var fe=W(L);if(typeof fe!="function")throw Error(s(150));if(L=fe.call(L),L==null)throw Error(s(151));for(var ve=fe=null,xe=O,Se=O=0,st=null,Te=L.next();xe!==null&&!Te.done;Se++,Te=L.next()){xe.index>Se?(st=xe,xe=null):st=xe.sibling;var nn=V(I,xe,Te.value,Y);if(nn===null){xe===null&&(xe=st);break}e&&xe&&nn.alternate===null&&r(I,xe),O=m(nn,O,Se),ve===null?fe=nn:ve.sibling=nn,ve=nn,xe=st}if(Te.done)return o(I,xe),Ue&&_n(I,Se),fe;if(xe===null){for(;!Te.done;Se++,Te=L.next())Te=G(I,Te.value,Y),Te!==null&&(O=m(Te,O,Se),ve===null?fe=Te:ve.sibling=Te,ve=Te);return Ue&&_n(I,Se),fe}for(xe=c(I,xe);!Te.done;Se++,Te=L.next())Te=ie(xe,I,Se,Te.value,Y),Te!==null&&(e&&Te.alternate!==null&&xe.delete(Te.key===null?Se:Te.key),O=m(Te,O,Se),ve===null?fe=Te:ve.sibling=Te,ve=Te);return e&&xe.forEach(function(v0){return r(I,v0)}),Ue&&_n(I,Se),fe}function Qe(I,O,L,Y){if(typeof L=="object"&&L!==null&&L.type===Z&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case K:e:{for(var fe=L.key,ve=O;ve!==null;){if(ve.key===fe){if(fe=L.type,fe===Z){if(ve.tag===7){o(I,ve.sibling),O=h(ve,L.props.children),O.return=I,I=O;break e}}else if(ve.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===me&&$h(fe)===ve.type){o(I,ve.sibling),O=h(ve,L.props),O.ref=Ei(I,ve,L),O.return=I,I=O;break e}o(I,ve);break}else r(I,ve);ve=ve.sibling}L.type===Z?(O=Pn(L.props.children,I.mode,Y,L.key),O.return=I,I=O):(Y=go(L.type,L.key,L.props,null,I.mode,Y),Y.ref=Ei(I,O,L),Y.return=I,I=Y)}return v(I);case J:e:{for(ve=L.key;O!==null;){if(O.key===ve)if(O.tag===4&&O.stateNode.containerInfo===L.containerInfo&&O.stateNode.implementation===L.implementation){o(I,O.sibling),O=h(O,L.children||[]),O.return=I,I=O;break e}else{o(I,O);break}else r(I,O);O=O.sibling}O=Hc(L,I.mode,Y),O.return=I,I=O}return v(I);case me:return ve=L._init,Qe(I,O,ve(L._payload),Y)}if(ri(L))return le(I,O,L,Y);if(W(L))return de(I,O,L,Y);Ha(I,L)}return typeof L=="string"&&L!==""||typeof L=="number"?(L=""+L,O!==null&&O.tag===6?(o(I,O.sibling),O=h(O,L),O.return=I,I=O):(o(I,O),O=Vc(L,I.mode,Y),O.return=I,I=O),v(I)):o(I,O)}return Qe}var hs=Dh(!0),zh=Dh(!1),Ka=Kr(null),Wa=null,fs=null,ec=null;function tc(){ec=fs=Wa=null}function rc(e){var r=Ka.current;De(Ka),e._currentValue=r}function nc(e,r,o){for(;e!==null;){var c=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),e===o)break;e=e.return}}function ps(e,r){Wa=e,ec=fs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&r)!==0&&(jt=!0),e.firstContext=null)}function Ft(e){var r=e._currentValue;if(ec!==e)if(e={context:e,memoizedValue:r,next:null},fs===null){if(Wa===null)throw Error(s(308));fs=e,Wa.dependencies={lanes:0,firstContext:e}}else fs=fs.next=e;return r}var jn=null;function sc(e){jn===null?jn=[e]:jn.push(e)}function Uh(e,r,o,c){var h=r.interleaved;return h===null?(o.next=o,sc(r)):(o.next=h.next,h.next=o),r.interleaved=o,Sr(e,c)}function Sr(e,r){e.lanes|=r;var o=e.alternate;for(o!==null&&(o.lanes|=r),o=e,e=e.return;e!==null;)e.childLanes|=r,o=e.alternate,o!==null&&(o.childLanes|=r),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Gr=!1;function ic(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mh(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nr(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Jr(e,r,o){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(Pe&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,Sr(e,o)}return h=c.interleaved,h===null?(r.next=r,sc(c)):(r.next=h.next,h.next=r),c.interleaved=r,Sr(e,o)}function Qa(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var c=r.lanes;c&=e.pendingLanes,o|=c,r.lanes=o,xl(e,o)}}function Fh(e,r){var o=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var h=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var v={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};m===null?h=m=v:m=m.next=v,o=o.next}while(o!==null);m===null?h=m=r:m=m.next=r}else h=m=r;o={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:m,shared:c.shared,effects:c.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}function Ga(e,r,o,c){var h=e.updateQueue;Gr=!1;var m=h.firstBaseUpdate,v=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var R=k,D=R.next;R.next=null,v===null?m=D:v.next=D,v=R;var H=e.alternate;H!==null&&(H=H.updateQueue,k=H.lastBaseUpdate,k!==v&&(k===null?H.firstBaseUpdate=D:k.next=D,H.lastBaseUpdate=R))}if(m!==null){var G=h.baseState;v=0,H=D=R=null,k=m;do{var V=k.lane,ie=k.eventTime;if((c&V)===V){H!==null&&(H=H.next={eventTime:ie,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var le=e,de=k;switch(V=r,ie=o,de.tag){case 1:if(le=de.payload,typeof le=="function"){G=le.call(ie,G,V);break e}G=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=de.payload,V=typeof le=="function"?le.call(ie,G,V):le,V==null)break e;G=Q({},G,V);break e;case 2:Gr=!0}}k.callback!==null&&k.lane!==0&&(e.flags|=64,V=h.effects,V===null?h.effects=[k]:V.push(k))}else ie={eventTime:ie,lane:V,tag:k.tag,payload:k.payload,callback:k.callback,next:null},H===null?(D=H=ie,R=G):H=H.next=ie,v|=V;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;V=k,k=V.next,V.next=null,h.lastBaseUpdate=V,h.shared.pending=null}}while(!0);if(H===null&&(R=G),h.baseState=R,h.firstBaseUpdate=D,h.lastBaseUpdate=H,r=h.shared.interleaved,r!==null){h=r;do v|=h.lane,h=h.next;while(h!==r)}else m===null&&(h.shared.lanes=0);kn|=v,e.lanes=v,e.memoizedState=G}}function qh(e,r,o){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var c=e[r],h=c.callback;if(h!==null){if(c.callback=null,c=o,typeof h!="function")throw Error(s(191,h));h.call(c)}}}var Ci={},hr=Kr(Ci),Ri=Kr(Ci),Pi=Kr(Ci);function Sn(e){if(e===Ci)throw Error(s(174));return e}function ac(e,r){switch(Ie(Pi,r),Ie(Ri,e),Ie(hr,Ci),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:ol(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=ol(r,e)}De(hr),Ie(hr,r)}function ms(){De(hr),De(Ri),De(Pi)}function Bh(e){Sn(Pi.current);var r=Sn(hr.current),o=ol(r,e.type);r!==o&&(Ie(Ri,e),Ie(hr,o))}function oc(e){Ri.current===e&&(De(hr),De(Ri))}var Fe=Kr(0);function Ja(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var lc=[];function cc(){for(var e=0;e<lc.length;e++)lc[e]._workInProgressVersionPrimary=null;lc.length=0}var Ya=$.ReactCurrentDispatcher,uc=$.ReactCurrentBatchConfig,Nn=0,qe=null,Xe=null,rt=null,Xa=!1,Ti=!1,Oi=0,My=0;function dt(){throw Error(s(321))}function dc(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!Xt(e[o],r[o]))return!1;return!0}function hc(e,r,o,c,h,m){if(Nn=m,qe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Ya.current=e===null||e.memoizedState===null?Vy:Hy,e=o(c,h),Ti){m=0;do{if(Ti=!1,Oi=0,25<=m)throw Error(s(301));m+=1,rt=Xe=null,r.updateQueue=null,Ya.current=Ky,e=o(c,h)}while(Ti)}if(Ya.current=to,r=Xe!==null&&Xe.next!==null,Nn=0,rt=Xe=qe=null,Xa=!1,r)throw Error(s(300));return e}function fc(){var e=Oi!==0;return Oi=0,e}function fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?qe.memoizedState=rt=e:rt=rt.next=e,rt}function qt(){if(Xe===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=Xe.next;var r=rt===null?qe.memoizedState:rt.next;if(r!==null)rt=r,Xe=e;else{if(e===null)throw Error(s(310));Xe=e,e={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},rt===null?qe.memoizedState=rt=e:rt=rt.next=e}return rt}function Ai(e,r){return typeof r=="function"?r(e):r}function pc(e){var r=qt(),o=r.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=e;var c=Xe,h=c.baseQueue,m=o.pending;if(m!==null){if(h!==null){var v=h.next;h.next=m.next,m.next=v}c.baseQueue=h=m,o.pending=null}if(h!==null){m=h.next,c=c.baseState;var k=v=null,R=null,D=m;do{var H=D.lane;if((Nn&H)===H)R!==null&&(R=R.next={lane:0,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null}),c=D.hasEagerState?D.eagerState:e(c,D.action);else{var G={lane:H,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null};R===null?(k=R=G,v=c):R=R.next=G,qe.lanes|=H,kn|=H}D=D.next}while(D!==null&&D!==m);R===null?v=c:R.next=k,Xt(c,r.memoizedState)||(jt=!0),r.memoizedState=c,r.baseState=v,r.baseQueue=R,o.lastRenderedState=c}if(e=o.interleaved,e!==null){h=e;do m=h.lane,qe.lanes|=m,kn|=m,h=h.next;while(h!==e)}else h===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function mc(e){var r=qt(),o=r.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=e;var c=o.dispatch,h=o.pending,m=r.memoizedState;if(h!==null){o.pending=null;var v=h=h.next;do m=e(m,v.action),v=v.next;while(v!==h);Xt(m,r.memoizedState)||(jt=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Vh(){}function Hh(e,r){var o=qe,c=qt(),h=r(),m=!Xt(c.memoizedState,h);if(m&&(c.memoizedState=h,jt=!0),c=c.queue,gc(Qh.bind(null,o,c,e),[e]),c.getSnapshot!==r||m||rt!==null&&rt.memoizedState.tag&1){if(o.flags|=2048,Ii(9,Wh.bind(null,o,c,h,r),void 0,null),nt===null)throw Error(s(349));(Nn&30)!==0||Kh(o,r,h)}return h}function Kh(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=qe.updateQueue,r===null?(r={lastEffect:null,stores:null},qe.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function Wh(e,r,o,c){r.value=o,r.getSnapshot=c,Gh(r)&&Jh(e)}function Qh(e,r,o){return o(function(){Gh(r)&&Jh(e)})}function Gh(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!Xt(e,o)}catch{return!0}}function Jh(e){var r=Sr(e,1);r!==null&&nr(r,e,1,-1)}function Yh(e){var r=fr();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:e},r.queue=e,e=e.dispatch=By.bind(null,qe,e),[r.memoizedState,e]}function Ii(e,r,o,c){return e={tag:e,create:r,destroy:o,deps:c,next:null},r=qe.updateQueue,r===null?(r={lastEffect:null,stores:null},qe.updateQueue=r,r.lastEffect=e.next=e):(o=r.lastEffect,o===null?r.lastEffect=e.next=e:(c=o.next,o.next=e,e.next=c,r.lastEffect=e)),e}function Xh(){return qt().memoizedState}function Za(e,r,o,c){var h=fr();qe.flags|=e,h.memoizedState=Ii(1|r,o,void 0,c===void 0?null:c)}function eo(e,r,o,c){var h=qt();c=c===void 0?null:c;var m=void 0;if(Xe!==null){var v=Xe.memoizedState;if(m=v.destroy,c!==null&&dc(c,v.deps)){h.memoizedState=Ii(r,o,m,c);return}}qe.flags|=e,h.memoizedState=Ii(1|r,o,m,c)}function Zh(e,r){return Za(8390656,8,e,r)}function gc(e,r){return eo(2048,8,e,r)}function ef(e,r){return eo(4,2,e,r)}function tf(e,r){return eo(4,4,e,r)}function rf(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function nf(e,r,o){return o=o!=null?o.concat([e]):null,eo(4,4,rf.bind(null,r,e),o)}function yc(){}function sf(e,r){var o=qt();r=r===void 0?null:r;var c=o.memoizedState;return c!==null&&r!==null&&dc(r,c[1])?c[0]:(o.memoizedState=[e,r],e)}function af(e,r){var o=qt();r=r===void 0?null:r;var c=o.memoizedState;return c!==null&&r!==null&&dc(r,c[1])?c[0]:(e=e(),o.memoizedState=[e,r],e)}function of(e,r,o){return(Nn&21)===0?(e.baseState&&(e.baseState=!1,jt=!0),e.memoizedState=o):(Xt(o,r)||(o=$d(),qe.lanes|=o,kn|=o,e.baseState=!0),r)}function Fy(e,r){var o=Ae;Ae=o!==0&&4>o?o:4,e(!0);var c=uc.transition;uc.transition={};try{e(!1),r()}finally{Ae=o,uc.transition=c}}function lf(){return qt().memoizedState}function qy(e,r,o){var c=en(e);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},cf(e))uf(r,o);else if(o=Uh(e,r,o,c),o!==null){var h=yt();nr(o,e,c,h),df(o,r,c)}}function By(e,r,o){var c=en(e),h={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(cf(e))uf(r,h);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var v=r.lastRenderedState,k=m(v,o);if(h.hasEagerState=!0,h.eagerState=k,Xt(k,v)){var R=r.interleaved;R===null?(h.next=h,sc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}o=Uh(e,r,h,c),o!==null&&(h=yt(),nr(o,e,c,h),df(o,r,c))}}function cf(e){var r=e.alternate;return e===qe||r!==null&&r===qe}function uf(e,r){Ti=Xa=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function df(e,r,o){if((o&4194240)!==0){var c=r.lanes;c&=e.pendingLanes,o|=c,r.lanes=o,xl(e,o)}}var to={readContext:Ft,useCallback:dt,useContext:dt,useEffect:dt,useImperativeHandle:dt,useInsertionEffect:dt,useLayoutEffect:dt,useMemo:dt,useReducer:dt,useRef:dt,useState:dt,useDebugValue:dt,useDeferredValue:dt,useTransition:dt,useMutableSource:dt,useSyncExternalStore:dt,useId:dt,unstable_isNewReconciler:!1},Vy={readContext:Ft,useCallback:function(e,r){return fr().memoizedState=[e,r===void 0?null:r],e},useContext:Ft,useEffect:Zh,useImperativeHandle:function(e,r,o){return o=o!=null?o.concat([e]):null,Za(4194308,4,rf.bind(null,r,e),o)},useLayoutEffect:function(e,r){return Za(4194308,4,e,r)},useInsertionEffect:function(e,r){return Za(4,2,e,r)},useMemo:function(e,r){var o=fr();return r=r===void 0?null:r,e=e(),o.memoizedState=[e,r],e},useReducer:function(e,r,o){var c=fr();return r=o!==void 0?o(r):r,c.memoizedState=c.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},c.queue=e,e=e.dispatch=qy.bind(null,qe,e),[c.memoizedState,e]},useRef:function(e){var r=fr();return e={current:e},r.memoizedState=e},useState:Yh,useDebugValue:yc,useDeferredValue:function(e){return fr().memoizedState=e},useTransition:function(){var e=Yh(!1),r=e[0];return e=Fy.bind(null,e[1]),fr().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,o){var c=qe,h=fr();if(Ue){if(o===void 0)throw Error(s(407));o=o()}else{if(o=r(),nt===null)throw Error(s(349));(Nn&30)!==0||Kh(c,r,o)}h.memoizedState=o;var m={value:o,getSnapshot:r};return h.queue=m,Zh(Qh.bind(null,c,m,e),[e]),c.flags|=2048,Ii(9,Wh.bind(null,c,m,o,r),void 0,null),o},useId:function(){var e=fr(),r=nt.identifierPrefix;if(Ue){var o=jr,c=_r;o=(c&~(1<<32-Yt(c)-1)).toString(32)+o,r=":"+r+"R"+o,o=Oi++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=My++,r=":"+r+"r"+o.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},Hy={readContext:Ft,useCallback:sf,useContext:Ft,useEffect:gc,useImperativeHandle:nf,useInsertionEffect:ef,useLayoutEffect:tf,useMemo:af,useReducer:pc,useRef:Xh,useState:function(){return pc(Ai)},useDebugValue:yc,useDeferredValue:function(e){var r=qt();return of(r,Xe.memoizedState,e)},useTransition:function(){var e=pc(Ai)[0],r=qt().memoizedState;return[e,r]},useMutableSource:Vh,useSyncExternalStore:Hh,useId:lf,unstable_isNewReconciler:!1},Ky={readContext:Ft,useCallback:sf,useContext:Ft,useEffect:gc,useImperativeHandle:nf,useInsertionEffect:ef,useLayoutEffect:tf,useMemo:af,useReducer:mc,useRef:Xh,useState:function(){return mc(Ai)},useDebugValue:yc,useDeferredValue:function(e){var r=qt();return Xe===null?r.memoizedState=e:of(r,Xe.memoizedState,e)},useTransition:function(){var e=mc(Ai)[0],r=qt().memoizedState;return[e,r]},useMutableSource:Vh,useSyncExternalStore:Hh,useId:lf,unstable_isNewReconciler:!1};function er(e,r){if(e&&e.defaultProps){r=Q({},r),e=e.defaultProps;for(var o in e)r[o]===void 0&&(r[o]=e[o]);return r}return r}function vc(e,r,o,c){r=e.memoizedState,o=o(c,r),o=o==null?r:Q({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var ro={isMounted:function(e){return(e=e._reactInternals)?vn(e)===e:!1},enqueueSetState:function(e,r,o){e=e._reactInternals;var c=yt(),h=en(e),m=Nr(c,h);m.payload=r,o!=null&&(m.callback=o),r=Jr(e,m,h),r!==null&&(nr(r,e,h,c),Qa(r,e,h))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var c=yt(),h=en(e),m=Nr(c,h);m.tag=1,m.payload=r,o!=null&&(m.callback=o),r=Jr(e,m,h),r!==null&&(nr(r,e,h,c),Qa(r,e,h))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=yt(),c=en(e),h=Nr(o,c);h.tag=2,r!=null&&(h.callback=r),r=Jr(e,h,c),r!==null&&(nr(r,e,c,o),Qa(r,e,c))}};function hf(e,r,o,c,h,m,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,m,v):r.prototype&&r.prototype.isPureReactComponent?!wi(o,c)||!wi(h,m):!0}function ff(e,r,o){var c=!1,h=Wr,m=r.contextType;return typeof m=="object"&&m!==null?m=Ft(m):(h=_t(r)?wn:ut.current,c=r.contextTypes,m=(c=c!=null)?ls(e,h):Wr),r=new r(o,m),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=ro,e.stateNode=r,r._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=m),r}function pf(e,r,o,c){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==e&&ro.enqueueReplaceState(r,r.state,null)}function xc(e,r,o,c){var h=e.stateNode;h.props=o,h.state=e.memoizedState,h.refs={},ic(e);var m=r.contextType;typeof m=="object"&&m!==null?h.context=Ft(m):(m=_t(r)?wn:ut.current,h.context=ls(e,m)),h.state=e.memoizedState,m=r.getDerivedStateFromProps,typeof m=="function"&&(vc(e,r,m,o),h.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&ro.enqueueReplaceState(h,h.state,null),Ga(e,o,h,c),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function gs(e,r){try{var o="",c=r;do o+=F(c),c=c.return;while(c);var h=o}catch(m){h=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:r,stack:h,digest:null}}function wc(e,r,o){return{value:e,source:null,stack:o!=null?o:null,digest:r!=null?r:null}}function bc(e,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var Wy=typeof WeakMap=="function"?WeakMap:Map;function mf(e,r,o){o=Nr(-1,o),o.tag=3,o.payload={element:null};var c=r.value;return o.callback=function(){co||(co=!0,$c=c),bc(e,r)},o}function gf(e,r,o){o=Nr(-1,o),o.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var h=r.value;o.payload=function(){return c(h)},o.callback=function(){bc(e,r)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(o.callback=function(){bc(e,r),typeof c!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var v=r.stack;this.componentDidCatch(r.value,{componentStack:v!==null?v:""})}),o}function yf(e,r,o){var c=e.pingCache;if(c===null){c=e.pingCache=new Wy;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(o)||(h.add(o),e=o0.bind(null,e,r,o),r.then(e,e))}function vf(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function xf(e,r,o,c,h){return(e.mode&1)===0?(e===r?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=Nr(-1,1),r.tag=2,Jr(o,r,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=h,e)}var Qy=$.ReactCurrentOwner,jt=!1;function gt(e,r,o,c){r.child=e===null?zh(r,null,o,c):hs(r,e.child,o,c)}function wf(e,r,o,c,h){o=o.render;var m=r.ref;return ps(r,h),c=hc(e,r,o,c,m,h),o=fc(),e!==null&&!jt?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~h,kr(e,r,h)):(Ue&&o&&Gl(r),r.flags|=1,gt(e,r,c,h),r.child)}function bf(e,r,o,c,h){if(e===null){var m=o.type;return typeof m=="function"&&!Bc(m)&&m.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=m,_f(e,r,m,c,h)):(e=go(o.type,null,c,r,r.mode,h),e.ref=r.ref,e.return=r,r.child=e)}if(m=e.child,(e.lanes&h)===0){var v=m.memoizedProps;if(o=o.compare,o=o!==null?o:wi,o(v,c)&&e.ref===r.ref)return kr(e,r,h)}return r.flags|=1,e=rn(m,c),e.ref=r.ref,e.return=r,r.child=e}function _f(e,r,o,c,h){if(e!==null){var m=e.memoizedProps;if(wi(m,c)&&e.ref===r.ref)if(jt=!1,r.pendingProps=c=m,(e.lanes&h)!==0)(e.flags&131072)!==0&&(jt=!0);else return r.lanes=e.lanes,kr(e,r,h)}return _c(e,r,o,c,h)}function jf(e,r,o){var c=r.pendingProps,h=c.children,m=e!==null?e.memoizedState:null;if(c.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(vs,Lt),Lt|=o;else{if((o&1073741824)===0)return e=m!==null?m.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,Ie(vs,Lt),Lt|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=m!==null?m.baseLanes:o,Ie(vs,Lt),Lt|=c}else m!==null?(c=m.baseLanes|o,r.memoizedState=null):c=o,Ie(vs,Lt),Lt|=c;return gt(e,r,h,o),r.child}function Sf(e,r){var o=r.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function _c(e,r,o,c,h){var m=_t(o)?wn:ut.current;return m=ls(r,m),ps(r,h),o=hc(e,r,o,c,m,h),c=fc(),e!==null&&!jt?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~h,kr(e,r,h)):(Ue&&c&&Gl(r),r.flags|=1,gt(e,r,o,h),r.child)}function Nf(e,r,o,c,h){if(_t(o)){var m=!0;Ma(r)}else m=!1;if(ps(r,h),r.stateNode===null)so(e,r),ff(r,o,c),xc(r,o,c,h),c=!0;else if(e===null){var v=r.stateNode,k=r.memoizedProps;v.props=k;var R=v.context,D=o.contextType;typeof D=="object"&&D!==null?D=Ft(D):(D=_t(o)?wn:ut.current,D=ls(r,D));var H=o.getDerivedStateFromProps,G=typeof H=="function"||typeof v.getSnapshotBeforeUpdate=="function";G||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==c||R!==D)&&pf(r,v,c,D),Gr=!1;var V=r.memoizedState;v.state=V,Ga(r,c,v,h),R=r.memoizedState,k!==c||V!==R||bt.current||Gr?(typeof H=="function"&&(vc(r,o,H,c),R=r.memoizedState),(k=Gr||hf(r,o,k,c,V,R,D))?(G||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=R),v.props=c,v.state=R,v.context=D,c=k):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{v=r.stateNode,Mh(e,r),k=r.memoizedProps,D=r.type===r.elementType?k:er(r.type,k),v.props=D,G=r.pendingProps,V=v.context,R=o.contextType,typeof R=="object"&&R!==null?R=Ft(R):(R=_t(o)?wn:ut.current,R=ls(r,R));var ie=o.getDerivedStateFromProps;(H=typeof ie=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==G||V!==R)&&pf(r,v,c,R),Gr=!1,V=r.memoizedState,v.state=V,Ga(r,c,v,h);var le=r.memoizedState;k!==G||V!==le||bt.current||Gr?(typeof ie=="function"&&(vc(r,o,ie,c),le=r.memoizedState),(D=Gr||hf(r,o,D,c,V,le,R)||!1)?(H||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,le,R),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,le,R)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||k===e.memoizedProps&&V===e.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&V===e.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=le),v.props=c,v.state=le,v.context=R,c=D):(typeof v.componentDidUpdate!="function"||k===e.memoizedProps&&V===e.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&V===e.memoizedState||(r.flags|=1024),c=!1)}return jc(e,r,o,c,m,h)}function jc(e,r,o,c,h,m){Sf(e,r);var v=(r.flags&128)!==0;if(!c&&!v)return h&&Rh(r,o,!1),kr(e,r,m);c=r.stateNode,Qy.current=r;var k=v&&typeof o.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,e!==null&&v?(r.child=hs(r,e.child,null,m),r.child=hs(r,null,k,m)):gt(e,r,k,m),r.memoizedState=c.state,h&&Rh(r,o,!0),r.child}function kf(e){var r=e.stateNode;r.pendingContext?Eh(e,r.pendingContext,r.pendingContext!==r.context):r.context&&Eh(e,r.context,!1),ac(e,r.containerInfo)}function Ef(e,r,o,c,h){return ds(),Zl(h),r.flags|=256,gt(e,r,o,c),r.child}var Sc={dehydrated:null,treeContext:null,retryLane:0};function Nc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Cf(e,r,o){var c=r.pendingProps,h=Fe.current,m=!1,v=(r.flags&128)!==0,k;if((k=v)||(k=e!==null&&e.memoizedState===null?!1:(h&2)!==0),k?(m=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),Ie(Fe,h&1),e===null)return Xl(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((r.mode&1)===0?r.lanes=1:e.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(v=c.children,e=c.fallback,m?(c=r.mode,m=r.child,v={mode:"hidden",children:v},(c&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=v):m=yo(v,c,0,null),e=Pn(e,c,o,null),m.return=r,e.return=r,m.sibling=e,r.child=m,r.child.memoizedState=Nc(o),r.memoizedState=Sc,e):kc(r,v));if(h=e.memoizedState,h!==null&&(k=h.dehydrated,k!==null))return Gy(e,r,v,c,k,h,o);if(m){m=c.fallback,v=r.mode,h=e.child,k=h.sibling;var R={mode:"hidden",children:c.children};return(v&1)===0&&r.child!==h?(c=r.child,c.childLanes=0,c.pendingProps=R,r.deletions=null):(c=rn(h,R),c.subtreeFlags=h.subtreeFlags&14680064),k!==null?m=rn(k,m):(m=Pn(m,v,o,null),m.flags|=2),m.return=r,c.return=r,c.sibling=m,r.child=c,c=m,m=r.child,v=e.child.memoizedState,v=v===null?Nc(o):{baseLanes:v.baseLanes|o,cachePool:null,transitions:v.transitions},m.memoizedState=v,m.childLanes=e.childLanes&~o,r.memoizedState=Sc,c}return m=e.child,e=m.sibling,c=rn(m,{mode:"visible",children:c.children}),(r.mode&1)===0&&(c.lanes=o),c.return=r,c.sibling=null,e!==null&&(o=r.deletions,o===null?(r.deletions=[e],r.flags|=16):o.push(e)),r.child=c,r.memoizedState=null,c}function kc(e,r){return r=yo({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function no(e,r,o,c){return c!==null&&Zl(c),hs(r,e.child,null,o),e=kc(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Gy(e,r,o,c,h,m,v){if(o)return r.flags&256?(r.flags&=-257,c=wc(Error(s(422))),no(e,r,v,c)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(m=c.fallback,h=r.mode,c=yo({mode:"visible",children:c.children},h,0,null),m=Pn(m,h,v,null),m.flags|=2,c.return=r,m.return=r,c.sibling=m,r.child=c,(r.mode&1)!==0&&hs(r,e.child,null,v),r.child.memoizedState=Nc(v),r.memoizedState=Sc,m);if((r.mode&1)===0)return no(e,r,v,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var k=c.dgst;return c=k,m=Error(s(419)),c=wc(m,c,void 0),no(e,r,v,c)}if(k=(v&e.childLanes)!==0,jt||k){if(c=nt,c!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|v))!==0?0:h,h!==0&&h!==m.retryLane&&(m.retryLane=h,Sr(e,h),nr(c,e,h,-1))}return qc(),c=wc(Error(s(421))),no(e,r,v,c)}return h.data==="$?"?(r.flags|=128,r.child=e.child,r=l0.bind(null,e),h._reactRetry=r,null):(e=m.treeContext,It=Hr(h.nextSibling),At=r,Ue=!0,Zt=null,e!==null&&(Ut[Mt++]=_r,Ut[Mt++]=jr,Ut[Mt++]=bn,_r=e.id,jr=e.overflow,bn=r),r=kc(r,c.children),r.flags|=4096,r)}function Rf(e,r,o){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r),nc(e.return,r,o)}function Ec(e,r,o,c,h){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:h}:(m.isBackwards=r,m.rendering=null,m.renderingStartTime=0,m.last=c,m.tail=o,m.tailMode=h)}function Pf(e,r,o){var c=r.pendingProps,h=c.revealOrder,m=c.tail;if(gt(e,r,c.children,o),c=Fe.current,(c&2)!==0)c=c&1|2,r.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Rf(e,o,r);else if(e.tag===19)Rf(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(Ie(Fe,c),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(o=r.child,h=null;o!==null;)e=o.alternate,e!==null&&Ja(e)===null&&(h=o),o=o.sibling;o=h,o===null?(h=r.child,r.child=null):(h=o.sibling,o.sibling=null),Ec(r,!1,h,o,m);break;case"backwards":for(o=null,h=r.child,r.child=null;h!==null;){if(e=h.alternate,e!==null&&Ja(e)===null){r.child=h;break}e=h.sibling,h.sibling=o,o=h,h=e}Ec(r,!0,o,null,m);break;case"together":Ec(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function so(e,r){(r.mode&1)===0&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function kr(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),kn|=r.lanes,(o&r.childLanes)===0)return null;if(e!==null&&r.child!==e.child)throw Error(s(153));if(r.child!==null){for(e=r.child,o=rn(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=rn(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function Jy(e,r,o){switch(r.tag){case 3:kf(r),ds();break;case 5:Bh(r);break;case 1:_t(r.type)&&Ma(r);break;case 4:ac(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,h=r.memoizedProps.value;Ie(Ka,c._currentValue),c._currentValue=h;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?(Ie(Fe,Fe.current&1),r.flags|=128,null):(o&r.child.childLanes)!==0?Cf(e,r,o):(Ie(Fe,Fe.current&1),e=kr(e,r,o),e!==null?e.sibling:null);Ie(Fe,Fe.current&1);break;case 19:if(c=(o&r.childLanes)!==0,(e.flags&128)!==0){if(c)return Pf(e,r,o);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ie(Fe,Fe.current),c)break;return null;case 22:case 23:return r.lanes=0,jf(e,r,o)}return kr(e,r,o)}var Tf,Cc,Of,Af;Tf=function(e,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Cc=function(){},Of=function(e,r,o,c){var h=e.memoizedProps;if(h!==c){e=r.stateNode,Sn(hr.current);var m=null;switch(o){case"input":h=nl(e,h),c=nl(e,c),m=[];break;case"select":h=Q({},h,{value:void 0}),c=Q({},c,{value:void 0}),m=[];break;case"textarea":h=al(e,h),c=al(e,c),m=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=Da)}ll(o,c);var v;o=null;for(D in h)if(!c.hasOwnProperty(D)&&h.hasOwnProperty(D)&&h[D]!=null)if(D==="style"){var k=h[D];for(v in k)k.hasOwnProperty(v)&&(o||(o={}),o[v]="")}else D!=="dangerouslySetInnerHTML"&&D!=="children"&&D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(l.hasOwnProperty(D)?m||(m=[]):(m=m||[]).push(D,null));for(D in c){var R=c[D];if(k=h!=null?h[D]:void 0,c.hasOwnProperty(D)&&R!==k&&(R!=null||k!=null))if(D==="style")if(k){for(v in k)!k.hasOwnProperty(v)||R&&R.hasOwnProperty(v)||(o||(o={}),o[v]="");for(v in R)R.hasOwnProperty(v)&&k[v]!==R[v]&&(o||(o={}),o[v]=R[v])}else o||(m||(m=[]),m.push(D,o)),o=R;else D==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,k=k?k.__html:void 0,R!=null&&k!==R&&(m=m||[]).push(D,R)):D==="children"?typeof R!="string"&&typeof R!="number"||(m=m||[]).push(D,""+R):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&(l.hasOwnProperty(D)?(R!=null&&D==="onScroll"&&$e("scroll",e),m||k===R||(m=[])):(m=m||[]).push(D,R))}o&&(m=m||[]).push("style",o);var D=m;(r.updateQueue=D)&&(r.flags|=4)}},Af=function(e,r,o,c){o!==c&&(r.flags|=4)};function Li(e,r){if(!Ue)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function ht(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,c=0;if(r)for(var h=e.child;h!==null;)o|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)o|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=c,e.childLanes=o,r}function Yy(e,r,o){var c=r.pendingProps;switch(Jl(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(r),null;case 1:return _t(r.type)&&Ua(),ht(r),null;case 3:return c=r.stateNode,ms(),De(bt),De(ut),cc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Va(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Zt!==null&&(Uc(Zt),Zt=null))),Cc(e,r),ht(r),null;case 5:oc(r);var h=Sn(Pi.current);if(o=r.type,e!==null&&r.stateNode!=null)Of(e,r,o,c,h),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(s(166));return ht(r),null}if(e=Sn(hr.current),Va(r)){c=r.stateNode,o=r.type;var m=r.memoizedProps;switch(c[dr]=r,c[Ni]=m,e=(r.mode&1)!==0,o){case"dialog":$e("cancel",c),$e("close",c);break;case"iframe":case"object":case"embed":$e("load",c);break;case"video":case"audio":for(h=0;h<_i.length;h++)$e(_i[h],c);break;case"source":$e("error",c);break;case"img":case"image":case"link":$e("error",c),$e("load",c);break;case"details":$e("toggle",c);break;case"input":hd(c,m),$e("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!m.multiple},$e("invalid",c);break;case"textarea":md(c,m),$e("invalid",c)}ll(o,m),h=null;for(var v in m)if(m.hasOwnProperty(v)){var k=m[v];v==="children"?typeof k=="string"?c.textContent!==k&&(m.suppressHydrationWarning!==!0&&$a(c.textContent,k,e),h=["children",k]):typeof k=="number"&&c.textContent!==""+k&&(m.suppressHydrationWarning!==!0&&$a(c.textContent,k,e),h=["children",""+k]):l.hasOwnProperty(v)&&k!=null&&v==="onScroll"&&$e("scroll",c)}switch(o){case"input":fa(c),pd(c,m,!0);break;case"textarea":fa(c),yd(c);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(c.onclick=Da)}c=h,r.updateQueue=c,c!==null&&(r.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vd(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=v.createElement(o,{is:c.is}):(e=v.createElement(o),o==="select"&&(v=e,c.multiple?v.multiple=!0:c.size&&(v.size=c.size))):e=v.createElementNS(e,o),e[dr]=r,e[Ni]=c,Tf(e,r,!1,!1),r.stateNode=e;e:{switch(v=cl(o,c),o){case"dialog":$e("cancel",e),$e("close",e),h=c;break;case"iframe":case"object":case"embed":$e("load",e),h=c;break;case"video":case"audio":for(h=0;h<_i.length;h++)$e(_i[h],e);h=c;break;case"source":$e("error",e),h=c;break;case"img":case"image":case"link":$e("error",e),$e("load",e),h=c;break;case"details":$e("toggle",e),h=c;break;case"input":hd(e,c),h=nl(e,c),$e("invalid",e);break;case"option":h=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},h=Q({},c,{value:void 0}),$e("invalid",e);break;case"textarea":md(e,c),h=al(e,c),$e("invalid",e);break;default:h=c}ll(o,h),k=h;for(m in k)if(k.hasOwnProperty(m)){var R=k[m];m==="style"?bd(e,R):m==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&xd(e,R)):m==="children"?typeof R=="string"?(o!=="textarea"||R!=="")&&ni(e,R):typeof R=="number"&&ni(e,""+R):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(l.hasOwnProperty(m)?R!=null&&m==="onScroll"&&$e("scroll",e):R!=null&&T(e,m,R,v))}switch(o){case"input":fa(e),pd(e,c,!1);break;case"textarea":fa(e),yd(e);break;case"option":c.value!=null&&e.setAttribute("value",""+ge(c.value));break;case"select":e.multiple=!!c.multiple,m=c.value,m!=null?Jn(e,!!c.multiple,m,!1):c.defaultValue!=null&&Jn(e,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=Da)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return ht(r),null;case 6:if(e&&r.stateNode!=null)Af(e,r,e.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(s(166));if(o=Sn(Pi.current),Sn(hr.current),Va(r)){if(c=r.stateNode,o=r.memoizedProps,c[dr]=r,(m=c.nodeValue!==o)&&(e=At,e!==null))switch(e.tag){case 3:$a(c.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$a(c.nodeValue,o,(e.mode&1)!==0)}m&&(r.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[dr]=r,r.stateNode=c}return ht(r),null;case 13:if(De(Fe),c=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ue&&It!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Lh(),ds(),r.flags|=98560,m=!1;else if(m=Va(r),c!==null&&c.dehydrated!==null){if(e===null){if(!m)throw Error(s(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[dr]=r}else ds(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ht(r),m=!1}else Zt!==null&&(Uc(Zt),Zt=null),m=!0;if(!m)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=o,r):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(r.child.flags|=8192,(r.mode&1)!==0&&(e===null||(Fe.current&1)!==0?Ze===0&&(Ze=3):qc())),r.updateQueue!==null&&(r.flags|=4),ht(r),null);case 4:return ms(),Cc(e,r),e===null&&ji(r.stateNode.containerInfo),ht(r),null;case 10:return rc(r.type._context),ht(r),null;case 17:return _t(r.type)&&Ua(),ht(r),null;case 19:if(De(Fe),m=r.memoizedState,m===null)return ht(r),null;if(c=(r.flags&128)!==0,v=m.rendering,v===null)if(c)Li(m,!1);else{if(Ze!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(v=Ja(e),v!==null){for(r.flags|=128,Li(m,!1),c=v.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=o,o=r.child;o!==null;)m=o,e=c,m.flags&=14680066,v=m.alternate,v===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=v.childLanes,m.lanes=v.lanes,m.child=v.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=v.memoizedProps,m.memoizedState=v.memoizedState,m.updateQueue=v.updateQueue,m.type=v.type,e=v.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Ie(Fe,Fe.current&1|2),r.child}e=e.sibling}m.tail!==null&&We()>xs&&(r.flags|=128,c=!0,Li(m,!1),r.lanes=4194304)}else{if(!c)if(e=Ja(v),e!==null){if(r.flags|=128,c=!0,o=e.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),Li(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!Ue)return ht(r),null}else 2*We()-m.renderingStartTime>xs&&o!==1073741824&&(r.flags|=128,c=!0,Li(m,!1),r.lanes=4194304);m.isBackwards?(v.sibling=r.child,r.child=v):(o=m.last,o!==null?o.sibling=v:r.child=v,m.last=v)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=We(),r.sibling=null,o=Fe.current,Ie(Fe,c?o&1|2:o&1),r):(ht(r),null);case 22:case 23:return Fc(),c=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(r.flags|=8192),c&&(r.mode&1)!==0?(Lt&1073741824)!==0&&(ht(r),r.subtreeFlags&6&&(r.flags|=8192)):ht(r),null;case 24:return null;case 25:return null}throw Error(s(156,r.tag))}function Xy(e,r){switch(Jl(r),r.tag){case 1:return _t(r.type)&&Ua(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return ms(),De(bt),De(ut),cc(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 5:return oc(r),null;case 13:if(De(Fe),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(s(340));ds()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return De(Fe),null;case 4:return ms(),null;case 10:return rc(r.type._context),null;case 22:case 23:return Fc(),null;case 24:return null;default:return null}}var io=!1,ft=!1,Zy=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ys(e,r){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){Be(e,r,c)}else o.current=null}function Rc(e,r,o){try{o()}catch(c){Be(e,r,c)}}var If=!1;function e0(e,r){if(Fl=Na,e=dh(),Al(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var h=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var v=0,k=-1,R=-1,D=0,H=0,G=e,V=null;t:for(;;){for(var ie;G!==o||h!==0&&G.nodeType!==3||(k=v+h),G!==m||c!==0&&G.nodeType!==3||(R=v+c),G.nodeType===3&&(v+=G.nodeValue.length),(ie=G.firstChild)!==null;)V=G,G=ie;for(;;){if(G===e)break t;if(V===o&&++D===h&&(k=v),V===m&&++H===c&&(R=v),(ie=G.nextSibling)!==null)break;G=V,V=G.parentNode}G=ie}o=k===-1||R===-1?null:{start:k,end:R}}else o=null}o=o||{start:0,end:0}}else o=null;for(ql={focusedElem:e,selectionRange:o},Na=!1,ae=r;ae!==null;)if(r=ae,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,ae=e;else for(;ae!==null;){r=ae;try{var le=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var de=le.memoizedProps,Qe=le.memoizedState,I=r.stateNode,O=I.getSnapshotBeforeUpdate(r.elementType===r.type?de:er(r.type,de),Qe);I.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var L=r.stateNode.containerInfo;L.nodeType===1?L.textContent="":L.nodeType===9&&L.documentElement&&L.removeChild(L.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(Y){Be(r,r.return,Y)}if(e=r.sibling,e!==null){e.return=r.return,ae=e;break}ae=r.return}return le=If,If=!1,le}function $i(e,r,o){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&e)===e){var m=h.destroy;h.destroy=void 0,m!==void 0&&Rc(r,o,m)}h=h.next}while(h!==c)}}function ao(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var c=o.create;o.destroy=c()}o=o.next}while(o!==r)}}function Pc(e){var r=e.ref;if(r!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof r=="function"?r(e):r.current=e}}function Lf(e){var r=e.alternate;r!==null&&(e.alternate=null,Lf(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[dr],delete r[Ni],delete r[Kl],delete r[$y],delete r[Dy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $f(e){return e.tag===5||e.tag===3||e.tag===4}function Df(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$f(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Tc(e,r,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(e,r):o.insertBefore(e,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(e,o)):(r=o,r.appendChild(e)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Da));else if(c!==4&&(e=e.child,e!==null))for(Tc(e,r,o),e=e.sibling;e!==null;)Tc(e,r,o),e=e.sibling}function Oc(e,r,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(Oc(e,r,o),e=e.sibling;e!==null;)Oc(e,r,o),e=e.sibling}var at=null,tr=!1;function Yr(e,r,o){for(o=o.child;o!==null;)zf(e,r,o),o=o.sibling}function zf(e,r,o){if(ur&&typeof ur.onCommitFiberUnmount=="function")try{ur.onCommitFiberUnmount(xa,o)}catch{}switch(o.tag){case 5:ft||ys(o,r);case 6:var c=at,h=tr;at=null,Yr(e,r,o),at=c,tr=h,at!==null&&(tr?(e=at,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):at.removeChild(o.stateNode));break;case 18:at!==null&&(tr?(e=at,o=o.stateNode,e.nodeType===8?Hl(e.parentNode,o):e.nodeType===1&&Hl(e,o),pi(e)):Hl(at,o.stateNode));break;case 4:c=at,h=tr,at=o.stateNode.containerInfo,tr=!0,Yr(e,r,o),at=c,tr=h;break;case 0:case 11:case 14:case 15:if(!ft&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var m=h,v=m.destroy;m=m.tag,v!==void 0&&((m&2)!==0||(m&4)!==0)&&Rc(o,r,v),h=h.next}while(h!==c)}Yr(e,r,o);break;case 1:if(!ft&&(ys(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(k){Be(o,r,k)}Yr(e,r,o);break;case 21:Yr(e,r,o);break;case 22:o.mode&1?(ft=(c=ft)||o.memoizedState!==null,Yr(e,r,o),ft=c):Yr(e,r,o);break;default:Yr(e,r,o)}}function Uf(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Zy),r.forEach(function(c){var h=c0.bind(null,e,c);o.has(c)||(o.add(c),c.then(h,h))})}}function rr(e,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];try{var m=e,v=r,k=v;e:for(;k!==null;){switch(k.tag){case 5:at=k.stateNode,tr=!1;break e;case 3:at=k.stateNode.containerInfo,tr=!0;break e;case 4:at=k.stateNode.containerInfo,tr=!0;break e}k=k.return}if(at===null)throw Error(s(160));zf(m,v,h),at=null,tr=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(D){Be(h,r,D)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Mf(r,e),r=r.sibling}function Mf(e,r){var o=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rr(r,e),pr(e),c&4){try{$i(3,e,e.return),ao(3,e)}catch(de){Be(e,e.return,de)}try{$i(5,e,e.return)}catch(de){Be(e,e.return,de)}}break;case 1:rr(r,e),pr(e),c&512&&o!==null&&ys(o,o.return);break;case 5:if(rr(r,e),pr(e),c&512&&o!==null&&ys(o,o.return),e.flags&32){var h=e.stateNode;try{ni(h,"")}catch(de){Be(e,e.return,de)}}if(c&4&&(h=e.stateNode,h!=null)){var m=e.memoizedProps,v=o!==null?o.memoizedProps:m,k=e.type,R=e.updateQueue;if(e.updateQueue=null,R!==null)try{k==="input"&&m.type==="radio"&&m.name!=null&&fd(h,m),cl(k,v);var D=cl(k,m);for(v=0;v<R.length;v+=2){var H=R[v],G=R[v+1];H==="style"?bd(h,G):H==="dangerouslySetInnerHTML"?xd(h,G):H==="children"?ni(h,G):T(h,H,G,D)}switch(k){case"input":sl(h,m);break;case"textarea":gd(h,m);break;case"select":var V=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!m.multiple;var ie=m.value;ie!=null?Jn(h,!!m.multiple,ie,!1):V!==!!m.multiple&&(m.defaultValue!=null?Jn(h,!!m.multiple,m.defaultValue,!0):Jn(h,!!m.multiple,m.multiple?[]:"",!1))}h[Ni]=m}catch(de){Be(e,e.return,de)}}break;case 6:if(rr(r,e),pr(e),c&4){if(e.stateNode===null)throw Error(s(162));h=e.stateNode,m=e.memoizedProps;try{h.nodeValue=m}catch(de){Be(e,e.return,de)}}break;case 3:if(rr(r,e),pr(e),c&4&&o!==null&&o.memoizedState.isDehydrated)try{pi(r.containerInfo)}catch(de){Be(e,e.return,de)}break;case 4:rr(r,e),pr(e);break;case 13:rr(r,e),pr(e),h=e.child,h.flags&8192&&(m=h.memoizedState!==null,h.stateNode.isHidden=m,!m||h.alternate!==null&&h.alternate.memoizedState!==null||(Lc=We())),c&4&&Uf(e);break;case 22:if(H=o!==null&&o.memoizedState!==null,e.mode&1?(ft=(D=ft)||H,rr(r,e),ft=D):rr(r,e),pr(e),c&8192){if(D=e.memoizedState!==null,(e.stateNode.isHidden=D)&&!H&&(e.mode&1)!==0)for(ae=e,H=e.child;H!==null;){for(G=ae=H;ae!==null;){switch(V=ae,ie=V.child,V.tag){case 0:case 11:case 14:case 15:$i(4,V,V.return);break;case 1:ys(V,V.return);var le=V.stateNode;if(typeof le.componentWillUnmount=="function"){c=V,o=V.return;try{r=c,le.props=r.memoizedProps,le.state=r.memoizedState,le.componentWillUnmount()}catch(de){Be(c,o,de)}}break;case 5:ys(V,V.return);break;case 22:if(V.memoizedState!==null){Bf(G);continue}}ie!==null?(ie.return=V,ae=ie):Bf(G)}H=H.sibling}e:for(H=null,G=e;;){if(G.tag===5){if(H===null){H=G;try{h=G.stateNode,D?(m=h.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(k=G.stateNode,R=G.memoizedProps.style,v=R!=null&&R.hasOwnProperty("display")?R.display:null,k.style.display=wd("display",v))}catch(de){Be(e,e.return,de)}}}else if(G.tag===6){if(H===null)try{G.stateNode.nodeValue=D?"":G.memoizedProps}catch(de){Be(e,e.return,de)}}else if((G.tag!==22&&G.tag!==23||G.memoizedState===null||G===e)&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===e)break e;for(;G.sibling===null;){if(G.return===null||G.return===e)break e;H===G&&(H=null),G=G.return}H===G&&(H=null),G.sibling.return=G.return,G=G.sibling}}break;case 19:rr(r,e),pr(e),c&4&&Uf(e);break;case 21:break;default:rr(r,e),pr(e)}}function pr(e){var r=e.flags;if(r&2){try{e:{for(var o=e.return;o!==null;){if($f(o)){var c=o;break e}o=o.return}throw Error(s(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(ni(h,""),c.flags&=-33);var m=Df(e);Oc(e,m,h);break;case 3:case 4:var v=c.stateNode.containerInfo,k=Df(e);Tc(e,k,v);break;default:throw Error(s(161))}}catch(R){Be(e,e.return,R)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function t0(e,r,o){ae=e,Ff(e)}function Ff(e,r,o){for(var c=(e.mode&1)!==0;ae!==null;){var h=ae,m=h.child;if(h.tag===22&&c){var v=h.memoizedState!==null||io;if(!v){var k=h.alternate,R=k!==null&&k.memoizedState!==null||ft;k=io;var D=ft;if(io=v,(ft=R)&&!D)for(ae=h;ae!==null;)v=ae,R=v.child,v.tag===22&&v.memoizedState!==null?Vf(h):R!==null?(R.return=v,ae=R):Vf(h);for(;m!==null;)ae=m,Ff(m),m=m.sibling;ae=h,io=k,ft=D}qf(e)}else(h.subtreeFlags&8772)!==0&&m!==null?(m.return=h,ae=m):qf(e)}}function qf(e){for(;ae!==null;){var r=ae;if((r.flags&8772)!==0){var o=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:ft||ao(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!ft)if(o===null)c.componentDidMount();else{var h=r.elementType===r.type?o.memoizedProps:er(r.type,o.memoizedProps);c.componentDidUpdate(h,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var m=r.updateQueue;m!==null&&qh(r,m,c);break;case 3:var v=r.updateQueue;if(v!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}qh(r,v,o)}break;case 5:var k=r.stateNode;if(o===null&&r.flags&4){o=k;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&o.focus();break;case"img":R.src&&(o.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var D=r.alternate;if(D!==null){var H=D.memoizedState;if(H!==null){var G=H.dehydrated;G!==null&&pi(G)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}ft||r.flags&512&&Pc(r)}catch(V){Be(r,r.return,V)}}if(r===e){ae=null;break}if(o=r.sibling,o!==null){o.return=r.return,ae=o;break}ae=r.return}}function Bf(e){for(;ae!==null;){var r=ae;if(r===e){ae=null;break}var o=r.sibling;if(o!==null){o.return=r.return,ae=o;break}ae=r.return}}function Vf(e){for(;ae!==null;){var r=ae;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{ao(4,r)}catch(R){Be(r,o,R)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var h=r.return;try{c.componentDidMount()}catch(R){Be(r,h,R)}}var m=r.return;try{Pc(r)}catch(R){Be(r,m,R)}break;case 5:var v=r.return;try{Pc(r)}catch(R){Be(r,v,R)}}}catch(R){Be(r,r.return,R)}if(r===e){ae=null;break}var k=r.sibling;if(k!==null){k.return=r.return,ae=k;break}ae=r.return}}var r0=Math.ceil,oo=$.ReactCurrentDispatcher,Ac=$.ReactCurrentOwner,Bt=$.ReactCurrentBatchConfig,Pe=0,nt=null,Ge=null,ot=0,Lt=0,vs=Kr(0),Ze=0,Di=null,kn=0,lo=0,Ic=0,zi=null,St=null,Lc=0,xs=1/0,Er=null,co=!1,$c=null,Xr=null,uo=!1,Zr=null,ho=0,Ui=0,Dc=null,fo=-1,po=0;function yt(){return(Pe&6)!==0?We():fo!==-1?fo:fo=We()}function en(e){return(e.mode&1)===0?1:(Pe&2)!==0&&ot!==0?ot&-ot:Uy.transition!==null?(po===0&&(po=$d()),po):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:Hd(e.type)),e)}function nr(e,r,o,c){if(50<Ui)throw Ui=0,Dc=null,Error(s(185));ci(e,o,c),((Pe&2)===0||e!==nt)&&(e===nt&&((Pe&2)===0&&(lo|=o),Ze===4&&tn(e,ot)),Nt(e,c),o===1&&Pe===0&&(r.mode&1)===0&&(xs=We()+500,Fa&&Qr()))}function Nt(e,r){var o=e.callbackNode;Ug(e,r);var c=_a(e,e===nt?ot:0);if(c===0)o!==null&&Ad(o),e.callbackNode=null,e.callbackPriority=0;else if(r=c&-c,e.callbackPriority!==r){if(o!=null&&Ad(o),r===1)e.tag===0?zy(Kf.bind(null,e)):Ph(Kf.bind(null,e)),Iy(function(){(Pe&6)===0&&Qr()}),o=null;else{switch(Dd(c)){case 1:o=gl;break;case 4:o=Id;break;case 16:o=va;break;case 536870912:o=Ld;break;default:o=va}o=ep(o,Hf.bind(null,e))}e.callbackPriority=r,e.callbackNode=o}}function Hf(e,r){if(fo=-1,po=0,(Pe&6)!==0)throw Error(s(327));var o=e.callbackNode;if(ws()&&e.callbackNode!==o)return null;var c=_a(e,e===nt?ot:0);if(c===0)return null;if((c&30)!==0||(c&e.expiredLanes)!==0||r)r=mo(e,c);else{r=c;var h=Pe;Pe|=2;var m=Qf();(nt!==e||ot!==r)&&(Er=null,xs=We()+500,Cn(e,r));do try{i0();break}catch(k){Wf(e,k)}while(!0);tc(),oo.current=m,Pe=h,Ge!==null?r=0:(nt=null,ot=0,r=Ze)}if(r!==0){if(r===2&&(h=yl(e),h!==0&&(c=h,r=zc(e,h))),r===1)throw o=Di,Cn(e,0),tn(e,c),Nt(e,We()),o;if(r===6)tn(e,c);else{if(h=e.current.alternate,(c&30)===0&&!n0(h)&&(r=mo(e,c),r===2&&(m=yl(e),m!==0&&(c=m,r=zc(e,m))),r===1))throw o=Di,Cn(e,0),tn(e,c),Nt(e,We()),o;switch(e.finishedWork=h,e.finishedLanes=c,r){case 0:case 1:throw Error(s(345));case 2:Rn(e,St,Er);break;case 3:if(tn(e,c),(c&130023424)===c&&(r=Lc+500-We(),10<r)){if(_a(e,0)!==0)break;if(h=e.suspendedLanes,(h&c)!==c){yt(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=Vl(Rn.bind(null,e,St,Er),r);break}Rn(e,St,Er);break;case 4:if(tn(e,c),(c&4194240)===c)break;for(r=e.eventTimes,h=-1;0<c;){var v=31-Yt(c);m=1<<v,v=r[v],v>h&&(h=v),c&=~m}if(c=h,c=We()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*r0(c/1960))-c,10<c){e.timeoutHandle=Vl(Rn.bind(null,e,St,Er),c);break}Rn(e,St,Er);break;case 5:Rn(e,St,Er);break;default:throw Error(s(329))}}}return Nt(e,We()),e.callbackNode===o?Hf.bind(null,e):null}function zc(e,r){var o=zi;return e.current.memoizedState.isDehydrated&&(Cn(e,r).flags|=256),e=mo(e,r),e!==2&&(r=St,St=o,r!==null&&Uc(r)),e}function Uc(e){St===null?St=e:St.push.apply(St,e)}function n0(e){for(var r=e;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var h=o[c],m=h.getSnapshot;h=h.value;try{if(!Xt(m(),h))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function tn(e,r){for(r&=~Ic,r&=~lo,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var o=31-Yt(r),c=1<<o;e[o]=-1,r&=~c}}function Kf(e){if((Pe&6)!==0)throw Error(s(327));ws();var r=_a(e,0);if((r&1)===0)return Nt(e,We()),null;var o=mo(e,r);if(e.tag!==0&&o===2){var c=yl(e);c!==0&&(r=c,o=zc(e,c))}if(o===1)throw o=Di,Cn(e,0),tn(e,r),Nt(e,We()),o;if(o===6)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Rn(e,St,Er),Nt(e,We()),null}function Mc(e,r){var o=Pe;Pe|=1;try{return e(r)}finally{Pe=o,Pe===0&&(xs=We()+500,Fa&&Qr())}}function En(e){Zr!==null&&Zr.tag===0&&(Pe&6)===0&&ws();var r=Pe;Pe|=1;var o=Bt.transition,c=Ae;try{if(Bt.transition=null,Ae=1,e)return e()}finally{Ae=c,Bt.transition=o,Pe=r,(Pe&6)===0&&Qr()}}function Fc(){Lt=vs.current,De(vs)}function Cn(e,r){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,Ay(o)),Ge!==null)for(o=Ge.return;o!==null;){var c=o;switch(Jl(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Ua();break;case 3:ms(),De(bt),De(ut),cc();break;case 5:oc(c);break;case 4:ms();break;case 13:De(Fe);break;case 19:De(Fe);break;case 10:rc(c.type._context);break;case 22:case 23:Fc()}o=o.return}if(nt=e,Ge=e=rn(e.current,null),ot=Lt=r,Ze=0,Di=null,Ic=lo=kn=0,St=zi=null,jn!==null){for(r=0;r<jn.length;r++)if(o=jn[r],c=o.interleaved,c!==null){o.interleaved=null;var h=c.next,m=o.pending;if(m!==null){var v=m.next;m.next=h,c.next=v}o.pending=c}jn=null}return e}function Wf(e,r){do{var o=Ge;try{if(tc(),Ya.current=to,Xa){for(var c=qe.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}Xa=!1}if(Nn=0,rt=Xe=qe=null,Ti=!1,Oi=0,Ac.current=null,o===null||o.return===null){Ze=1,Di=r,Ge=null;break}e:{var m=e,v=o.return,k=o,R=r;if(r=ot,k.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var D=R,H=k,G=H.tag;if((H.mode&1)===0&&(G===0||G===11||G===15)){var V=H.alternate;V?(H.updateQueue=V.updateQueue,H.memoizedState=V.memoizedState,H.lanes=V.lanes):(H.updateQueue=null,H.memoizedState=null)}var ie=vf(v);if(ie!==null){ie.flags&=-257,xf(ie,v,k,m,r),ie.mode&1&&yf(m,D,r),r=ie,R=D;var le=r.updateQueue;if(le===null){var de=new Set;de.add(R),r.updateQueue=de}else le.add(R);break e}else{if((r&1)===0){yf(m,D,r),qc();break e}R=Error(s(426))}}else if(Ue&&k.mode&1){var Qe=vf(v);if(Qe!==null){(Qe.flags&65536)===0&&(Qe.flags|=256),xf(Qe,v,k,m,r),Zl(gs(R,k));break e}}m=R=gs(R,k),Ze!==4&&(Ze=2),zi===null?zi=[m]:zi.push(m),m=v;do{switch(m.tag){case 3:m.flags|=65536,r&=-r,m.lanes|=r;var I=mf(m,R,r);Fh(m,I);break e;case 1:k=R;var O=m.type,L=m.stateNode;if((m.flags&128)===0&&(typeof O.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Xr===null||!Xr.has(L)))){m.flags|=65536,r&=-r,m.lanes|=r;var Y=gf(m,k,r);Fh(m,Y);break e}}m=m.return}while(m!==null)}Jf(o)}catch(fe){r=fe,Ge===o&&o!==null&&(Ge=o=o.return);continue}break}while(!0)}function Qf(){var e=oo.current;return oo.current=to,e===null?to:e}function qc(){(Ze===0||Ze===3||Ze===2)&&(Ze=4),nt===null||(kn&268435455)===0&&(lo&268435455)===0||tn(nt,ot)}function mo(e,r){var o=Pe;Pe|=2;var c=Qf();(nt!==e||ot!==r)&&(Er=null,Cn(e,r));do try{s0();break}catch(h){Wf(e,h)}while(!0);if(tc(),Pe=o,oo.current=c,Ge!==null)throw Error(s(261));return nt=null,ot=0,Ze}function s0(){for(;Ge!==null;)Gf(Ge)}function i0(){for(;Ge!==null&&!Pg();)Gf(Ge)}function Gf(e){var r=Zf(e.alternate,e,Lt);e.memoizedProps=e.pendingProps,r===null?Jf(e):Ge=r,Ac.current=null}function Jf(e){var r=e;do{var o=r.alternate;if(e=r.return,(r.flags&32768)===0){if(o=Yy(o,r,Lt),o!==null){Ge=o;return}}else{if(o=Xy(o,r),o!==null){o.flags&=32767,Ge=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ze=6,Ge=null;return}}if(r=r.sibling,r!==null){Ge=r;return}Ge=r=e}while(r!==null);Ze===0&&(Ze=5)}function Rn(e,r,o){var c=Ae,h=Bt.transition;try{Bt.transition=null,Ae=1,a0(e,r,o,c)}finally{Bt.transition=h,Ae=c}return null}function a0(e,r,o,c){do ws();while(Zr!==null);if((Pe&6)!==0)throw Error(s(327));o=e.finishedWork;var h=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var m=o.lanes|o.childLanes;if(Mg(e,m),e===nt&&(Ge=nt=null,ot=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||uo||(uo=!0,ep(va,function(){return ws(),null})),m=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||m){m=Bt.transition,Bt.transition=null;var v=Ae;Ae=1;var k=Pe;Pe|=4,Ac.current=null,e0(e,o),Mf(o,e),ky(ql),Na=!!Fl,ql=Fl=null,e.current=o,t0(o),Tg(),Pe=k,Ae=v,Bt.transition=m}else e.current=o;if(uo&&(uo=!1,Zr=e,ho=h),m=e.pendingLanes,m===0&&(Xr=null),Ig(o.stateNode),Nt(e,We()),r!==null)for(c=e.onRecoverableError,o=0;o<r.length;o++)h=r[o],c(h.value,{componentStack:h.stack,digest:h.digest});if(co)throw co=!1,e=$c,$c=null,e;return(ho&1)!==0&&e.tag!==0&&ws(),m=e.pendingLanes,(m&1)!==0?e===Dc?Ui++:(Ui=0,Dc=e):Ui=0,Qr(),null}function ws(){if(Zr!==null){var e=Dd(ho),r=Bt.transition,o=Ae;try{if(Bt.transition=null,Ae=16>e?16:e,Zr===null)var c=!1;else{if(e=Zr,Zr=null,ho=0,(Pe&6)!==0)throw Error(s(331));var h=Pe;for(Pe|=4,ae=e.current;ae!==null;){var m=ae,v=m.child;if((ae.flags&16)!==0){var k=m.deletions;if(k!==null){for(var R=0;R<k.length;R++){var D=k[R];for(ae=D;ae!==null;){var H=ae;switch(H.tag){case 0:case 11:case 15:$i(8,H,m)}var G=H.child;if(G!==null)G.return=H,ae=G;else for(;ae!==null;){H=ae;var V=H.sibling,ie=H.return;if(Lf(H),H===D){ae=null;break}if(V!==null){V.return=ie,ae=V;break}ae=ie}}}var le=m.alternate;if(le!==null){var de=le.child;if(de!==null){le.child=null;do{var Qe=de.sibling;de.sibling=null,de=Qe}while(de!==null)}}ae=m}}if((m.subtreeFlags&2064)!==0&&v!==null)v.return=m,ae=v;else e:for(;ae!==null;){if(m=ae,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:$i(9,m,m.return)}var I=m.sibling;if(I!==null){I.return=m.return,ae=I;break e}ae=m.return}}var O=e.current;for(ae=O;ae!==null;){v=ae;var L=v.child;if((v.subtreeFlags&2064)!==0&&L!==null)L.return=v,ae=L;else e:for(v=O;ae!==null;){if(k=ae,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:ao(9,k)}}catch(fe){Be(k,k.return,fe)}if(k===v){ae=null;break e}var Y=k.sibling;if(Y!==null){Y.return=k.return,ae=Y;break e}ae=k.return}}if(Pe=h,Qr(),ur&&typeof ur.onPostCommitFiberRoot=="function")try{ur.onPostCommitFiberRoot(xa,e)}catch{}c=!0}return c}finally{Ae=o,Bt.transition=r}}return!1}function Yf(e,r,o){r=gs(o,r),r=mf(e,r,1),e=Jr(e,r,1),r=yt(),e!==null&&(ci(e,1,r),Nt(e,r))}function Be(e,r,o){if(e.tag===3)Yf(e,e,o);else for(;r!==null;){if(r.tag===3){Yf(r,e,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Xr===null||!Xr.has(c))){e=gs(o,e),e=gf(r,e,1),r=Jr(r,e,1),e=yt(),r!==null&&(ci(r,1,e),Nt(r,e));break}}r=r.return}}function o0(e,r,o){var c=e.pingCache;c!==null&&c.delete(r),r=yt(),e.pingedLanes|=e.suspendedLanes&o,nt===e&&(ot&o)===o&&(Ze===4||Ze===3&&(ot&130023424)===ot&&500>We()-Lc?Cn(e,0):Ic|=o),Nt(e,r)}function Xf(e,r){r===0&&((e.mode&1)===0?r=1:(r=ba,ba<<=1,(ba&130023424)===0&&(ba=4194304)));var o=yt();e=Sr(e,r),e!==null&&(ci(e,r,o),Nt(e,o))}function l0(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),Xf(e,o)}function c0(e,r){var o=0;switch(e.tag){case 13:var c=e.stateNode,h=e.memoizedState;h!==null&&(o=h.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(s(314))}c!==null&&c.delete(r),Xf(e,o)}var Zf;Zf=function(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps||bt.current)jt=!0;else{if((e.lanes&o)===0&&(r.flags&128)===0)return jt=!1,Jy(e,r,o);jt=(e.flags&131072)!==0}else jt=!1,Ue&&(r.flags&1048576)!==0&&Th(r,Ba,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;so(e,r),e=r.pendingProps;var h=ls(r,ut.current);ps(r,o),h=hc(null,r,c,e,h,o);var m=fc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,_t(c)?(m=!0,Ma(r)):m=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,ic(r),h.updater=ro,r.stateNode=h,h._reactInternals=r,xc(r,c,e,o),r=jc(null,r,c,!0,m,o)):(r.tag=0,Ue&&m&&Gl(r),gt(null,r,h,o),r=r.child),r;case 16:c=r.elementType;e:{switch(so(e,r),e=r.pendingProps,h=c._init,c=h(c._payload),r.type=c,h=r.tag=d0(c),e=er(c,e),h){case 0:r=_c(null,r,c,e,o);break e;case 1:r=Nf(null,r,c,e,o);break e;case 11:r=wf(null,r,c,e,o);break e;case 14:r=bf(null,r,c,er(c.type,e),o);break e}throw Error(s(306,c,""))}return r;case 0:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:er(c,h),_c(e,r,c,h,o);case 1:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:er(c,h),Nf(e,r,c,h,o);case 3:e:{if(kf(r),e===null)throw Error(s(387));c=r.pendingProps,m=r.memoizedState,h=m.element,Mh(e,r),Ga(r,c,null,o);var v=r.memoizedState;if(c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){h=gs(Error(s(423)),r),r=Ef(e,r,c,o,h);break e}else if(c!==h){h=gs(Error(s(424)),r),r=Ef(e,r,c,o,h);break e}else for(It=Hr(r.stateNode.containerInfo.firstChild),At=r,Ue=!0,Zt=null,o=zh(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ds(),c===h){r=kr(e,r,o);break e}gt(e,r,c,o)}r=r.child}return r;case 5:return Bh(r),e===null&&Xl(r),c=r.type,h=r.pendingProps,m=e!==null?e.memoizedProps:null,v=h.children,Bl(c,h)?v=null:m!==null&&Bl(c,m)&&(r.flags|=32),Sf(e,r),gt(e,r,v,o),r.child;case 6:return e===null&&Xl(r),null;case 13:return Cf(e,r,o);case 4:return ac(r,r.stateNode.containerInfo),c=r.pendingProps,e===null?r.child=hs(r,null,c,o):gt(e,r,c,o),r.child;case 11:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:er(c,h),wf(e,r,c,h,o);case 7:return gt(e,r,r.pendingProps,o),r.child;case 8:return gt(e,r,r.pendingProps.children,o),r.child;case 12:return gt(e,r,r.pendingProps.children,o),r.child;case 10:e:{if(c=r.type._context,h=r.pendingProps,m=r.memoizedProps,v=h.value,Ie(Ka,c._currentValue),c._currentValue=v,m!==null)if(Xt(m.value,v)){if(m.children===h.children&&!bt.current){r=kr(e,r,o);break e}}else for(m=r.child,m!==null&&(m.return=r);m!==null;){var k=m.dependencies;if(k!==null){v=m.child;for(var R=k.firstContext;R!==null;){if(R.context===c){if(m.tag===1){R=Nr(-1,o&-o),R.tag=2;var D=m.updateQueue;if(D!==null){D=D.shared;var H=D.pending;H===null?R.next=R:(R.next=H.next,H.next=R),D.pending=R}}m.lanes|=o,R=m.alternate,R!==null&&(R.lanes|=o),nc(m.return,o,r),k.lanes|=o;break}R=R.next}}else if(m.tag===10)v=m.type===r.type?null:m.child;else if(m.tag===18){if(v=m.return,v===null)throw Error(s(341));v.lanes|=o,k=v.alternate,k!==null&&(k.lanes|=o),nc(v,o,r),v=m.sibling}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===r){v=null;break}if(m=v.sibling,m!==null){m.return=v.return,v=m;break}v=v.return}m=v}gt(e,r,h.children,o),r=r.child}return r;case 9:return h=r.type,c=r.pendingProps.children,ps(r,o),h=Ft(h),c=c(h),r.flags|=1,gt(e,r,c,o),r.child;case 14:return c=r.type,h=er(c,r.pendingProps),h=er(c.type,h),bf(e,r,c,h,o);case 15:return _f(e,r,r.type,r.pendingProps,o);case 17:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:er(c,h),so(e,r),r.tag=1,_t(c)?(e=!0,Ma(r)):e=!1,ps(r,o),ff(r,c,h),xc(r,c,h,o),jc(null,r,c,!0,e,o);case 19:return Pf(e,r,o);case 22:return jf(e,r,o)}throw Error(s(156,r.tag))};function ep(e,r){return Od(e,r)}function u0(e,r,o,c){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(e,r,o,c){return new u0(e,r,o,c)}function Bc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function d0(e){if(typeof e=="function")return Bc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===he)return 11;if(e===ee)return 14}return 2}function rn(e,r){var o=e.alternate;return o===null?(o=Vt(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function go(e,r,o,c,h,m){var v=2;if(c=e,typeof e=="function")Bc(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case Z:return Pn(o.children,h,m,r);case se:v=8,h|=8;break;case ce:return e=Vt(12,o,r,h|2),e.elementType=ce,e.lanes=m,e;case q:return e=Vt(13,o,r,h),e.elementType=q,e.lanes=m,e;case re:return e=Vt(19,o,r,h),e.elementType=re,e.lanes=m,e;case B:return yo(o,h,m,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case U:v=10;break e;case te:v=9;break e;case he:v=11;break e;case ee:v=14;break e;case me:v=16,c=null;break e}throw Error(s(130,e==null?e:typeof e,""))}return r=Vt(v,o,r,h),r.elementType=e,r.type=c,r.lanes=m,r}function Pn(e,r,o,c){return e=Vt(7,e,c,r),e.lanes=o,e}function yo(e,r,o,c){return e=Vt(22,e,c,r),e.elementType=B,e.lanes=o,e.stateNode={isHidden:!1},e}function Vc(e,r,o){return e=Vt(6,e,null,r),e.lanes=o,e}function Hc(e,r,o){return r=Vt(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function h0(e,r,o,c,h){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vl(0),this.expirationTimes=vl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vl(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Kc(e,r,o,c,h,m,v,k,R){return e=new h0(e,r,o,k,R),r===1?(r=1,m===!0&&(r|=8)):r=0,m=Vt(3,null,null,r),e.current=m,m.stateNode=e,m.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ic(m),e}function f0(e,r,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:c==null?null:""+c,children:e,containerInfo:r,implementation:o}}function tp(e){if(!e)return Wr;e=e._reactInternals;e:{if(vn(e)!==e||e.tag!==1)throw Error(s(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(_t(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(s(171))}if(e.tag===1){var o=e.type;if(_t(o))return Ch(e,o,r)}return r}function rp(e,r,o,c,h,m,v,k,R){return e=Kc(o,c,!0,e,h,m,v,k,R),e.context=tp(null),o=e.current,c=yt(),h=en(o),m=Nr(c,h),m.callback=r!=null?r:null,Jr(o,m,h),e.current.lanes=h,ci(e,h,c),Nt(e,c),e}function vo(e,r,o,c){var h=r.current,m=yt(),v=en(h);return o=tp(o),r.context===null?r.context=o:r.pendingContext=o,r=Nr(m,v),r.payload={element:e},c=c===void 0?null:c,c!==null&&(r.callback=c),e=Jr(h,r,v),e!==null&&(nr(e,h,v,m),Qa(e,h,v)),v}function xo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function np(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function Wc(e,r){np(e,r),(e=e.alternate)&&np(e,r)}function p0(){return null}var sp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}wo.prototype.render=Qc.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(s(409));vo(e,r,null,null)},wo.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;En(function(){vo(null,e,null,null)}),r[wr]=null}};function wo(e){this._internalRoot=e}wo.prototype.unstable_scheduleHydration=function(e){if(e){var r=Md();e={blockedOn:null,target:e,priority:r};for(var o=0;o<qr.length&&r!==0&&r<qr[o].priority;o++);qr.splice(o,0,e),o===0&&Bd(e)}};function Gc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ip(){}function m0(e,r,o,c,h){if(h){if(typeof c=="function"){var m=c;c=function(){var D=xo(v);m.call(D)}}var v=rp(r,c,e,0,null,!1,!1,"",ip);return e._reactRootContainer=v,e[wr]=v.current,ji(e.nodeType===8?e.parentNode:e),En(),v}for(;h=e.lastChild;)e.removeChild(h);if(typeof c=="function"){var k=c;c=function(){var D=xo(R);k.call(D)}}var R=Kc(e,0,!1,null,null,!1,!1,"",ip);return e._reactRootContainer=R,e[wr]=R.current,ji(e.nodeType===8?e.parentNode:e),En(function(){vo(r,R,o,c)}),R}function _o(e,r,o,c,h){var m=o._reactRootContainer;if(m){var v=m;if(typeof h=="function"){var k=h;h=function(){var R=xo(v);k.call(R)}}vo(r,v,e,h)}else v=m0(o,r,e,h,c);return xo(v)}zd=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var o=li(r.pendingLanes);o!==0&&(xl(r,o|1),Nt(r,We()),(Pe&6)===0&&(xs=We()+500,Qr()))}break;case 13:En(function(){var c=Sr(e,1);if(c!==null){var h=yt();nr(c,e,1,h)}}),Wc(e,1)}},wl=function(e){if(e.tag===13){var r=Sr(e,134217728);if(r!==null){var o=yt();nr(r,e,134217728,o)}Wc(e,134217728)}},Ud=function(e){if(e.tag===13){var r=en(e),o=Sr(e,r);if(o!==null){var c=yt();nr(o,e,r,c)}Wc(e,r)}},Md=function(){return Ae},Fd=function(e,r){var o=Ae;try{return Ae=e,r()}finally{Ae=o}},hl=function(e,r,o){switch(r){case"input":if(sl(e,o),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==e&&c.form===e.form){var h=za(c);if(!h)throw Error(s(90));dd(c),sl(c,h)}}}break;case"textarea":gd(e,o);break;case"select":r=o.value,r!=null&&Jn(e,!!o.multiple,r,!1)}},Nd=Mc,kd=En;var g0={usingClientEntryPoint:!1,Events:[ki,as,za,jd,Sd,Mc]},Mi={findFiberByHostInstance:xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y0={bundleType:Mi.bundleType,version:Mi.version,rendererPackageName:Mi.rendererPackageName,rendererConfig:Mi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pd(e),e===null?null:e.stateNode},findFiberByHostInstance:Mi.findFiberByHostInstance||p0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jo.isDisabled&&jo.supportsFiber)try{xa=jo.inject(y0),ur=jo}catch{}}return kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g0,kt.createPortal=function(e,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gc(r))throw Error(s(200));return f0(e,r,null,o)},kt.createRoot=function(e,r){if(!Gc(e))throw Error(s(299));var o=!1,c="",h=sp;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=Kc(e,1,!1,null,null,o,!1,c,h),e[wr]=r.current,ji(e.nodeType===8?e.parentNode:e),new Qc(r)},kt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=Pd(r),e=e===null?null:e.stateNode,e},kt.flushSync=function(e){return En(e)},kt.hydrate=function(e,r,o){if(!bo(r))throw Error(s(200));return _o(null,e,r,!0,o)},kt.hydrateRoot=function(e,r,o){if(!Gc(e))throw Error(s(405));var c=o!=null&&o.hydratedSources||null,h=!1,m="",v=sp;if(o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),r=rp(r,null,e,1,o!=null?o:null,h,!1,m,v),e[wr]=r.current,ji(e),c)for(e=0;e<c.length;e++)o=c[e],h=o._getVersion,h=h(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,h]:r.mutableSourceEagerHydrationData.push(o,h);return new wo(r)},kt.render=function(e,r,o){if(!bo(r))throw Error(s(200));return _o(null,e,r,!1,o)},kt.unmountComponentAtNode=function(e){if(!bo(e))throw Error(s(40));return e._reactRootContainer?(En(function(){_o(null,null,e,!1,function(){e._reactRootContainer=null,e[wr]=null})}),!0):!1},kt.unstable_batchedUpdates=Mc,kt.unstable_renderSubtreeIntoContainer=function(e,r,o,c){if(!bo(o))throw Error(s(200));if(e==null||e._reactInternals===void 0)throw Error(s(38));return _o(e,r,o,!1,c)},kt.version="18.3.1-next-f1338f8080-20240426",kt}var pp;function N0(){if(pp)return Zc.exports;pp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Zc.exports=S0(),Zc.exports}var mp;function k0(){if(mp)return No;mp=1;var n=N0();return No.createRoot=n.createRoot,No.hydrateRoot=n.hydrateRoot,No}var E0=k0();const C0=bm(E0);/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var gp="popstate";function R0(n={}){function t(a,l){let{pathname:u,search:d,hash:f}=a.location;return hu("",{pathname:u,search:d,hash:f},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function s(a,l){return typeof l=="string"?l:Qi(l)}return T0(t,s,null,n)}function Me(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function Qt(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function P0(){return Math.random().toString(36).substring(2,10)}function yp(n,t){return{usr:n.state,key:n.key,idx:t}}function hu(n,t,s=null,a){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Js(t):t,state:s,key:t&&t.key||a||P0()}}function Qi({pathname:n="/",search:t="",hash:s=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(n+=s.charAt(0)==="#"?s:"#"+s),n}function Js(n){let t={};if(n){let s=n.indexOf("#");s>=0&&(t.hash=n.substring(s),n=n.substring(0,s));let a=n.indexOf("?");a>=0&&(t.search=n.substring(a),n=n.substring(0,a)),n&&(t.pathname=n)}return t}function T0(n,t,s,a={}){let{window:l=document.defaultView,v5Compat:u=!1}=a,d=l.history,f="POP",p=null,g=y();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function y(){return(d.state||{idx:null}).idx}function x(){f="POP";let j=y(),N=j==null?null:j-g;g=j,p&&p({action:f,location:_.location,delta:N})}function w(j,N){f="PUSH";let A=hu(_.location,j,N);g=y()+1;let T=yp(A,g),$=_.createHref(A);try{d.pushState(T,"",$)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;l.location.assign($)}u&&p&&p({action:f,location:_.location,delta:1})}function b(j,N){f="REPLACE";let A=hu(_.location,j,N);g=y();let T=yp(A,g),$=_.createHref(A);d.replaceState(T,"",$),u&&p&&p({action:f,location:_.location,delta:0})}function S(j){return O0(j)}let _={get action(){return f},get location(){return n(l,d)},listen(j){if(p)throw new Error("A history only accepts one active listener");return l.addEventListener(gp,x),p=j,()=>{l.removeEventListener(gp,x),p=null}},createHref(j){return t(l,j)},createURL:S,encodeLocation(j){let N=S(j);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:w,replace:b,go(j){return d.go(j)}};return _}function O0(n,t=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),Me(s,"No window.location.(origin|href) available to create URL");let a=typeof n=="string"?n:Qi(n);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=s+a),new URL(a,s)}function _m(n,t,s="/"){return A0(n,t,s,!1)}function A0(n,t,s,a){let l=typeof t=="string"?Js(t):t,u=Dr(l.pathname||"/",s);if(u==null)return null;let d=jm(n);I0(d);let f=null;for(let p=0;f==null&&p<d.length;++p){let g=H0(u);f=B0(d[p],g,a)}return f}function jm(n,t=[],s=[],a="",l=!1){let u=(d,f,p=l,g)=>{let y={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(a)&&p)return;Me(y.relativePath.startsWith(a),`Absolute route path "${y.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(a.length)}let x=Ir([a,y.relativePath]),w=s.concat(y);d.children&&d.children.length>0&&(Me(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),jm(d.children,t,w,x,p)),!(d.path==null&&!d.index)&&t.push({path:x,score:F0(x,d.index),routesMeta:w})};return n.forEach((d,f)=>{var p;if(d.path===""||!((p=d.path)!=null&&p.includes("?")))u(d,f);else for(let g of Sm(d.path))u(d,f,!0,g)}),t}function Sm(n){let t=n.split("/");if(t.length===0)return[];let[s,...a]=t,l=s.endsWith("?"),u=s.replace(/\?$/,"");if(a.length===0)return l?[u,""]:[u];let d=Sm(a.join("/")),f=[];return f.push(...d.map(p=>p===""?u:[u,p].join("/"))),l&&f.push(...d),f.map(p=>n.startsWith("/")&&p===""?"/":p)}function I0(n){n.sort((t,s)=>t.score!==s.score?s.score-t.score:q0(t.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}var L0=/^:[\w-]+$/,$0=3,D0=2,z0=1,U0=10,M0=-2,vp=n=>n==="*";function F0(n,t){let s=n.split("/"),a=s.length;return s.some(vp)&&(a+=M0),t&&(a+=D0),s.filter(l=>!vp(l)).reduce((l,u)=>l+(L0.test(u)?$0:u===""?z0:U0),a)}function q0(n,t){return n.length===t.length&&n.slice(0,-1).every((a,l)=>a===t[l])?n[n.length-1]-t[t.length-1]:0}function B0(n,t,s=!1){let{routesMeta:a}=n,l={},u="/",d=[];for(let f=0;f<a.length;++f){let p=a[f],g=f===a.length-1,y=u==="/"?t:t.slice(u.length)||"/",x=Mo({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},y),w=p.route;if(!x&&g&&s&&!a[a.length-1].route.index&&(x=Mo({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},y)),!x)return null;Object.assign(l,x.params),d.push({params:l,pathname:Ir([u,x.pathname]),pathnameBase:G0(Ir([u,x.pathnameBase])),route:w}),x.pathnameBase!=="/"&&(u=Ir([u,x.pathnameBase]))}return d}function Mo(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[s,a]=V0(n.path,n.caseSensitive,n.end),l=t.match(s);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),f=l.slice(1);return{params:a.reduce((g,{paramName:y,isOptional:x},w)=>{if(y==="*"){let S=f[w]||"";d=u.slice(0,u.length-S.length).replace(/(.)\/+$/,"$1")}const b=f[w];return x&&!b?g[y]=void 0:g[y]=(b||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:d,pattern:n}}function V0(n,t=!1,s=!0){Qt(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let a=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,p)=>(a.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(a.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),a]}function H0(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Qt(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Dr(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=n.charAt(s);return a&&a!=="/"?null:n.slice(s)||"/"}var K0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function W0(n,t="/"){let{pathname:s,search:a="",hash:l=""}=typeof n=="string"?Js(n):n,u;return s?(s=s.replace(/\/\/+/g,"/"),s.startsWith("/")?u=xp(s.substring(1),"/"):u=xp(s,t)):u=t,{pathname:u,search:J0(a),hash:Y0(l)}}function xp(n,t){let s=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function ru(n,t,s,a){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Q0(n){return n.filter((t,s)=>s===0||t.route.path&&t.route.path.length>0)}function Ku(n){let t=Q0(n);return t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase)}function Wu(n,t,s,a=!1){let l;typeof n=="string"?l=Js(n):(l={...n},Me(!l.pathname||!l.pathname.includes("?"),ru("?","pathname","search",l)),Me(!l.pathname||!l.pathname.includes("#"),ru("#","pathname","hash",l)),Me(!l.search||!l.search.includes("#"),ru("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,f;if(d==null)f=s;else{let x=t.length-1;if(!a&&d.startsWith("..")){let w=d.split("/");for(;w[0]==="..";)w.shift(),x-=1;l.pathname=w.join("/")}f=x>=0?t[x]:"/"}let p=W0(l,f),g=d&&d!=="/"&&d.endsWith("/"),y=(u||d===".")&&s.endsWith("/");return!p.pathname.endsWith("/")&&(g||y)&&(p.pathname+="/"),p}var Ir=n=>n.join("/").replace(/\/\/+/g,"/"),G0=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),J0=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Y0=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,X0=class{constructor(n,t,s,a=!1){this.status=n,this.statusText=t||"",this.internal=a,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}};function Z0(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function ev(n){return n.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Nm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function km(n,t){let s=n;if(typeof s!="string"||!K0.test(s))return{absoluteURL:void 0,isExternal:!1,to:s};let a=s,l=!1;if(Nm)try{let u=new URL(window.location.href),d=s.startsWith("//")?new URL(u.protocol+s):new URL(s),f=Dr(d.pathname,t);d.origin===u.origin&&f!=null?s=f+d.search+d.hash:l=!0}catch{Qt(!1,`<Link to="${s}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:l,to:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Em=["POST","PUT","PATCH","DELETE"];new Set(Em);var tv=["GET",...Em];new Set(tv);var Ys=E.createContext(null);Ys.displayName="DataRouter";var Qo=E.createContext(null);Qo.displayName="DataRouterState";var rv=E.createContext(!1),Cm=E.createContext({isTransitioning:!1});Cm.displayName="ViewTransition";var nv=E.createContext(new Map);nv.displayName="Fetchers";var sv=E.createContext(null);sv.displayName="Await";var zt=E.createContext(null);zt.displayName="Navigation";var la=E.createContext(null);la.displayName="Location";var Gt=E.createContext({outlet:null,matches:[],isDataRoute:!1});Gt.displayName="Route";var Qu=E.createContext(null);Qu.displayName="RouteError";var Rm="REACT_ROUTER_ERROR",iv="REDIRECT",av="ROUTE_ERROR_RESPONSE";function ov(n){if(n.startsWith(`${Rm}:${iv}:{`))try{let t=JSON.parse(n.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function lv(n){if(n.startsWith(`${Rm}:${av}:{`))try{let t=JSON.parse(n.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new X0(t.status,t.statusText,t.data)}catch{}}function cv(n,{relative:t}={}){Me(Xs(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:a}=E.useContext(zt),{hash:l,pathname:u,search:d}=ua(n,{relative:t}),f=u;return s!=="/"&&(f=u==="/"?s:Ir([s,u])),a.createHref({pathname:f,search:d,hash:l})}function Xs(){return E.useContext(la)!=null}function cr(){return Me(Xs(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(la).location}var Pm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Tm(n){E.useContext(zt).static||E.useLayoutEffect(n)}function Jt(){let{isDataRoute:n}=E.useContext(Gt);return n?Sv():uv()}function uv(){Me(Xs(),"useNavigate() may be used only in the context of a <Router> component.");let n=E.useContext(Ys),{basename:t,navigator:s}=E.useContext(zt),{matches:a}=E.useContext(Gt),{pathname:l}=cr(),u=JSON.stringify(Ku(a)),d=E.useRef(!1);return Tm(()=>{d.current=!0}),E.useCallback((p,g={})=>{if(Qt(d.current,Pm),!d.current)return;if(typeof p=="number"){s.go(p);return}let y=Wu(p,JSON.parse(u),l,g.relative==="path");n==null&&t!=="/"&&(y.pathname=y.pathname==="/"?t:Ir([t,y.pathname])),(g.replace?s.replace:s.push)(y,g.state,g)},[t,s,u,l,n])}var dv=E.createContext(null);function hv(n){let t=E.useContext(Gt).outlet;return E.useMemo(()=>t&&E.createElement(dv.Provider,{value:n},t),[t,n])}function ca(){let{matches:n}=E.useContext(Gt),t=n[n.length-1];return t?t.params:{}}function ua(n,{relative:t}={}){let{matches:s}=E.useContext(Gt),{pathname:a}=cr(),l=JSON.stringify(Ku(s));return E.useMemo(()=>Wu(n,JSON.parse(l),a,t==="path"),[n,l,a,t])}function fv(n,t){return Om(n,t)}function Om(n,t,s,a,l){var A;Me(Xs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=E.useContext(zt),{matches:d}=E.useContext(Gt),f=d[d.length-1],p=f?f.params:{},g=f?f.pathname:"/",y=f?f.pathnameBase:"/",x=f&&f.route;{let T=x&&x.path||"";Im(g,!x||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let w=cr(),b;if(t){let T=typeof t=="string"?Js(t):t;Me(y==="/"||((A=T.pathname)==null?void 0:A.startsWith(y)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${y}" but pathname "${T.pathname}" was given in the \`location\` prop.`),b=T}else b=w;let S=b.pathname||"/",_=S;if(y!=="/"){let T=y.replace(/^\//,"").split("/");_="/"+S.replace(/^\//,"").split("/").slice(T.length).join("/")}let j=_m(n,{pathname:_});Qt(x||j!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Qt(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=vv(j&&j.map(T=>Object.assign({},T,{params:Object.assign({},p,T.params),pathname:Ir([y,u.encodeLocation?u.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?y:Ir([y,u.encodeLocation?u.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),d,s,a,l);return t&&N?E.createElement(la.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},N):N}function pv(){let n=jv(),t=Z0(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),s=n instanceof Error?n.stack:null,a="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:a},u={padding:"2px 4px",backgroundColor:a},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:u},"ErrorBoundary")," or"," ",E.createElement("code",{style:u},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),s?E.createElement("pre",{style:l},s):null,d)}var mv=E.createElement(pv,null),Am=class extends E.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){this.props.onError?this.props.onError(n,t):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const s=lv(n.digest);s&&(n=s)}let t=n!==void 0?E.createElement(Gt.Provider,{value:this.props.routeContext},E.createElement(Qu.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?E.createElement(gv,{error:n},t):t}};Am.contextType=rv;var nu=new WeakMap;function gv({children:n,error:t}){let{basename:s}=E.useContext(zt);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let a=ov(t.digest);if(a){let l=nu.get(t);if(l)throw l;let u=km(a.location,s);if(Nm&&!nu.get(t))if(u.isExternal||a.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:a.replace}));throw nu.set(t,d),d}return E.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function yv({routeContext:n,match:t,children:s}){let a=E.useContext(Ys);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(Gt.Provider,{value:n},s)}function vv(n,t=[],s=null,a=null,l=null){if(n==null){if(!s)return null;if(s.errors)n=s.matches;else if(t.length===0&&!s.initialized&&s.matches.length>0)n=s.matches;else return null}let u=n,d=s==null?void 0:s.errors;if(d!=null){let y=u.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);Me(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,y+1))}let f=!1,p=-1;if(s)for(let y=0;y<u.length;y++){let x=u[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=y),x.route.id){let{loaderData:w,errors:b}=s,S=x.route.loader&&!w.hasOwnProperty(x.route.id)&&(!b||b[x.route.id]===void 0);if(x.route.lazy||S){f=!0,p>=0?u=u.slice(0,p+1):u=[u[0]];break}}}let g=s&&a?(y,x)=>{var w,b,S;a(y,{location:s.location,params:(S=(b=(w=s.matches)==null?void 0:w[0])==null?void 0:b.params)!=null?S:{},unstable_pattern:ev(s.matches),errorInfo:x})}:void 0;return u.reduceRight((y,x,w)=>{let b,S=!1,_=null,j=null;s&&(b=d&&x.route.id?d[x.route.id]:void 0,_=x.route.errorElement||mv,f&&(p<0&&w===0?(Im("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,j=null):p===w&&(S=!0,j=x.route.hydrateFallbackElement||null)));let N=t.concat(u.slice(0,w+1)),A=()=>{let T;return b?T=_:S?T=j:x.route.Component?T=E.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=y,E.createElement(yv,{match:x,routeContext:{outlet:y,matches:N,isDataRoute:s!=null},children:T})};return s&&(x.route.ErrorBoundary||x.route.errorElement||w===0)?E.createElement(Am,{location:s.location,revalidation:s.revalidation,component:_,error:b,children:A(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:g}):A()},null)}function Gu(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xv(n){let t=E.useContext(Ys);return Me(t,Gu(n)),t}function wv(n){let t=E.useContext(Qo);return Me(t,Gu(n)),t}function bv(n){let t=E.useContext(Gt);return Me(t,Gu(n)),t}function Ju(n){let t=bv(n),s=t.matches[t.matches.length-1];return Me(s.route.id,`${n} can only be used on routes that contain a unique "id"`),s.route.id}function _v(){return Ju("useRouteId")}function jv(){var a;let n=E.useContext(Qu),t=wv("useRouteError"),s=Ju("useRouteError");return n!==void 0?n:(a=t.errors)==null?void 0:a[s]}function Sv(){let{router:n}=xv("useNavigate"),t=Ju("useNavigate"),s=E.useRef(!1);return Tm(()=>{s.current=!0}),E.useCallback(async(l,u={})=>{Qt(s.current,Pm),s.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:t,...u}))},[n,t])}var wp={};function Im(n,t,s){!t&&!wp[n]&&(wp[n]=!0,Qt(!1,s))}E.memo(Nv);function Nv({routes:n,future:t,state:s,onError:a}){return Om(n,void 0,s,a,t)}function Fo({to:n,replace:t,state:s,relative:a}){Me(Xs(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=E.useContext(zt);Qt(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=E.useContext(Gt),{pathname:d}=cr(),f=Jt(),p=Wu(n,Ku(u),d,a==="path"),g=JSON.stringify(p);return E.useEffect(()=>{f(JSON.parse(g),{replace:t,state:s,relative:a})},[f,g,a,t,s]),null}function kv(n){return hv(n.context)}function ze(n){Me(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ev({basename:n="/",children:t=null,location:s,navigationType:a="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Me(!Xs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=n.replace(/^\/*/,"/"),p=E.useMemo(()=>({basename:f,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[f,l,u,d]);typeof s=="string"&&(s=Js(s));let{pathname:g="/",search:y="",hash:x="",state:w=null,key:b="default"}=s,S=E.useMemo(()=>{let _=Dr(g,f);return _==null?null:{location:{pathname:_,search:y,hash:x,state:w,key:b},navigationType:a}},[f,g,y,x,w,b,a]);return Qt(S!=null,`<Router basename="${f}"> is not able to match the URL "${g}${y}${x}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:E.createElement(zt.Provider,{value:p},E.createElement(la.Provider,{children:t,value:S}))}function Cv({children:n,location:t}){return fv(fu(n),t)}function fu(n,t=[]){let s=[];return E.Children.forEach(n,(a,l)=>{if(!E.isValidElement(a))return;let u=[...t,l];if(a.type===E.Fragment){s.push.apply(s,fu(a.props.children,u));return}Me(a.type===ze,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Me(!a.props.index||!a.props.children,"An index route cannot have child routes.");let d={id:a.props.id||u.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=fu(a.props.children,u)),s.push(d)}),s}var Lo="get",$o="application/x-www-form-urlencoded";function Go(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Rv(n){return Go(n)&&n.tagName.toLowerCase()==="button"}function Pv(n){return Go(n)&&n.tagName.toLowerCase()==="form"}function Tv(n){return Go(n)&&n.tagName.toLowerCase()==="input"}function Ov(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Av(n,t){return n.button===0&&(!t||t==="_self")&&!Ov(n)}function pu(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((t,s)=>{let a=n[s];return t.concat(Array.isArray(a)?a.map(l=>[s,l]):[[s,a]])},[]))}function Iv(n,t){let s=pu(n);return t&&t.forEach((a,l)=>{s.has(l)||t.getAll(l).forEach(u=>{s.append(l,u)})}),s}var ko=null;function Lv(){if(ko===null)try{new FormData(document.createElement("form"),0),ko=!1}catch{ko=!0}return ko}var $v=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function su(n){return n!=null&&!$v.has(n)?(Qt(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$o}"`),null):n}function Dv(n,t){let s,a,l,u,d;if(Pv(n)){let f=n.getAttribute("action");a=f?Dr(f,t):null,s=n.getAttribute("method")||Lo,l=su(n.getAttribute("enctype"))||$o,u=new FormData(n)}else if(Rv(n)||Tv(n)&&(n.type==="submit"||n.type==="image")){let f=n.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=n.getAttribute("formaction")||f.getAttribute("action");if(a=p?Dr(p,t):null,s=n.getAttribute("formmethod")||f.getAttribute("method")||Lo,l=su(n.getAttribute("formenctype"))||su(f.getAttribute("enctype"))||$o,u=new FormData(f,n),!Lv()){let{name:g,type:y,value:x}=n;if(y==="image"){let w=g?`${g}.`:"";u.append(`${w}x`,"0"),u.append(`${w}y`,"0")}else g&&u.append(g,x)}}else{if(Go(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Lo,a=null,l=$o,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:a,method:s.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yu(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function zv(n,t,s,a){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${a}`:l.pathname=`${l.pathname}.${a}`:l.pathname==="/"?l.pathname=`_root.${a}`:t&&Dr(l.pathname,t)==="/"?l.pathname=`${t.replace(/\/$/,"")}/_root.${a}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${a}`,l}async function Uv(n,t){if(n.id in t)return t[n.id];try{let s=await import(n.module);return t[n.id]=s,s}catch(s){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Mv(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Fv(n,t,s){let a=await Promise.all(n.map(async l=>{let u=t.routes[l.route.id];if(u){let d=await Uv(u,s);return d.links?d.links():[]}return[]}));return Hv(a.flat(1).filter(Mv).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function bp(n,t,s,a,l,u){let d=(p,g)=>s[g]?p.route.id!==s[g].route.id:!0,f=(p,g)=>{var y;return s[g].pathname!==p.pathname||((y=s[g].route.path)==null?void 0:y.endsWith("*"))&&s[g].params["*"]!==p.params["*"]};return u==="assets"?t.filter((p,g)=>d(p,g)||f(p,g)):u==="data"?t.filter((p,g)=>{var x;let y=a.routes[p.route.id];if(!y||!y.hasLoader)return!1;if(d(p,g)||f(p,g))return!0;if(p.route.shouldRevalidate){let w=p.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:((x=s[0])==null?void 0:x.params)||{},nextUrl:new URL(n,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function qv(n,t,{includeHydrateFallback:s}={}){return Bv(n.map(a=>{let l=t.routes[a.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),s&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function Bv(n){return[...new Set(n)]}function Vv(n){let t={},s=Object.keys(n).sort();for(let a of s)t[a]=n[a];return t}function Hv(n,t){let s=new Set;return new Set(t),n.reduce((a,l)=>{let u=JSON.stringify(Vv(l));return s.has(u)||(s.add(u),a.push({key:u,link:l})),a},[])}function Lm(){let n=E.useContext(Ys);return Yu(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Kv(){let n=E.useContext(Qo);return Yu(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Xu=E.createContext(void 0);Xu.displayName="FrameworkContext";function $m(){let n=E.useContext(Xu);return Yu(n,"You must render this element inside a <HydratedRouter> element"),n}function Wv(n,t){let s=E.useContext(Xu),[a,l]=E.useState(!1),[u,d]=E.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:g,onMouseLeave:y,onTouchStart:x}=t,w=E.useRef(null);E.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let _=N=>{N.forEach(A=>{d(A.isIntersecting)})},j=new IntersectionObserver(_,{threshold:.5});return w.current&&j.observe(w.current),()=>{j.disconnect()}}},[n]),E.useEffect(()=>{if(a){let _=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(_)}}},[a]);let b=()=>{l(!0)},S=()=>{l(!1),d(!1)};return s?n!=="intent"?[u,w,{}]:[u,w,{onFocus:qi(f,b),onBlur:qi(p,S),onMouseEnter:qi(g,b),onMouseLeave:qi(y,S),onTouchStart:qi(x,b)}]:[!1,w,{}]}function qi(n,t){return s=>{n&&n(s),s.defaultPrevented||t(s)}}function Qv({page:n,...t}){let{router:s}=Lm(),a=E.useMemo(()=>_m(s.routes,n,s.basename),[s.routes,n,s.basename]);return a?E.createElement(Jv,{page:n,matches:a,...t}):null}function Gv(n){let{manifest:t,routeModules:s}=$m(),[a,l]=E.useState([]);return E.useEffect(()=>{let u=!1;return Fv(n,t,s).then(d=>{u||l(d)}),()=>{u=!0}},[n,t,s]),a}function Jv({page:n,matches:t,...s}){let a=cr(),{future:l,manifest:u,routeModules:d}=$m(),{basename:f}=Lm(),{loaderData:p,matches:g}=Kv(),y=E.useMemo(()=>bp(n,t,g,u,a,"data"),[n,t,g,u,a]),x=E.useMemo(()=>bp(n,t,g,u,a,"assets"),[n,t,g,u,a]),w=E.useMemo(()=>{if(n===a.pathname+a.search+a.hash)return[];let _=new Set,j=!1;if(t.forEach(A=>{var $;let T=u.routes[A.route.id];!T||!T.hasLoader||(!y.some(K=>K.route.id===A.route.id)&&A.route.id in p&&(($=d[A.route.id])!=null&&$.shouldRevalidate)||T.hasClientLoader?j=!0:_.add(A.route.id))}),_.size===0)return[];let N=zv(n,f,l.unstable_trailingSlashAwareDataRequests,"data");return j&&_.size>0&&N.searchParams.set("_routes",t.filter(A=>_.has(A.route.id)).map(A=>A.route.id).join(",")),[N.pathname+N.search]},[f,l.unstable_trailingSlashAwareDataRequests,p,a,u,y,t,n,d]),b=E.useMemo(()=>qv(x,u),[x,u]),S=Gv(x);return E.createElement(E.Fragment,null,w.map(_=>E.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...s})),b.map(_=>E.createElement("link",{key:_,rel:"modulepreload",href:_,...s})),S.map(({key:_,link:j})=>{var N;return E.createElement("link",{key:_,nonce:s.nonce,...j,crossOrigin:(N=j.crossOrigin)!=null?N:s.crossOrigin})}))}function Yv(...n){return t=>{n.forEach(s=>{typeof s=="function"?s(t):s!=null&&(s.current=t)})}}var Xv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xv&&(window.__reactRouterVersion="7.13.0")}catch{}function Zv({basename:n,children:t,unstable_useTransitions:s,window:a}){let l=E.useRef();l.current==null&&(l.current=R0({window:a,v5Compat:!0}));let u=l.current,[d,f]=E.useState({action:u.action,location:u.location}),p=E.useCallback(g=>{s===!1?f(g):E.startTransition(()=>f(g))},[s]);return E.useLayoutEffect(()=>u.listen(p),[u,p]),E.createElement(Ev,{basename:n,children:t,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:s})}var Dm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wt=E.forwardRef(function({onClick:t,discover:s="render",prefetch:a="none",relative:l,reloadDocument:u,replace:d,state:f,target:p,to:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:w,...b},S){let{basename:_,unstable_useTransitions:j}=E.useContext(zt),N=typeof g=="string"&&Dm.test(g),A=km(g,_);g=A.to;let T=cv(g,{relative:l}),[$,K,J]=Wv(a,b),Z=rx(g,{replace:d,state:f,target:p,preventScrollReset:y,relative:l,viewTransition:x,unstable_defaultShouldRevalidate:w,unstable_useTransitions:j});function se(U){t&&t(U),U.defaultPrevented||Z(U)}let ce=E.createElement("a",{...b,...J,href:A.absoluteURL||T,onClick:A.isExternal||u?t:se,ref:Yv(S,K),target:p,"data-discover":!N&&s==="render"?"true":void 0});return $&&!N?E.createElement(E.Fragment,null,ce,E.createElement(Qv,{page:T})):ce});wt.displayName="Link";var zm=E.forwardRef(function({"aria-current":t="page",caseSensitive:s=!1,className:a="",end:l=!1,style:u,to:d,viewTransition:f,children:p,...g},y){let x=ua(d,{relative:g.relative}),w=cr(),b=E.useContext(Qo),{navigator:S,basename:_}=E.useContext(zt),j=b!=null&&ox(x)&&f===!0,N=S.encodeLocation?S.encodeLocation(x).pathname:x.pathname,A=w.pathname,T=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;s||(A=A.toLowerCase(),T=T?T.toLowerCase():null,N=N.toLowerCase()),T&&_&&(T=Dr(T,_)||T);const $=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let K=A===N||!l&&A.startsWith(N)&&A.charAt($)==="/",J=T!=null&&(T===N||!l&&T.startsWith(N)&&T.charAt(N.length)==="/"),Z={isActive:K,isPending:J,isTransitioning:j},se=K?t:void 0,ce;typeof a=="function"?ce=a(Z):ce=[a,K?"active":null,J?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let U=typeof u=="function"?u(Z):u;return E.createElement(wt,{...g,"aria-current":se,className:ce,ref:y,style:U,to:d,viewTransition:f},typeof p=="function"?p(Z):p)});zm.displayName="NavLink";var ex=E.forwardRef(({discover:n="render",fetcherKey:t,navigate:s,reloadDocument:a,replace:l,state:u,method:d=Lo,action:f,onSubmit:p,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:w,...b},S)=>{let{unstable_useTransitions:_}=E.useContext(zt),j=ix(),N=ax(f,{relative:g}),A=d.toLowerCase()==="get"?"get":"post",T=typeof f=="string"&&Dm.test(f),$=K=>{if(p&&p(K),K.defaultPrevented)return;K.preventDefault();let J=K.nativeEvent.submitter,Z=(J==null?void 0:J.getAttribute("formmethod"))||d,se=()=>j(J||K.currentTarget,{fetcherKey:t,method:Z,navigate:s,replace:l,state:u,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:w});_&&s!==!1?E.startTransition(()=>se()):se()};return E.createElement("form",{ref:S,method:A,action:N,onSubmit:a?p:$,...b,"data-discover":!T&&n==="render"?"true":void 0})});ex.displayName="Form";function tx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Um(n){let t=E.useContext(Ys);return Me(t,tx(n)),t}function rx(n,{target:t,replace:s,state:a,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:f,unstable_useTransitions:p}={}){let g=Jt(),y=cr(),x=ua(n,{relative:u});return E.useCallback(w=>{if(Av(w,t)){w.preventDefault();let b=s!==void 0?s:Qi(y)===Qi(x),S=()=>g(n,{replace:b,state:a,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:f});p?E.startTransition(()=>S()):S()}},[y,g,x,s,a,t,n,l,u,d,f,p])}function Mm(n){Qt(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=E.useRef(pu(n)),s=E.useRef(!1),a=cr(),l=E.useMemo(()=>Iv(a.search,s.current?null:t.current),[a.search]),u=Jt(),d=E.useCallback((f,p)=>{const g=pu(typeof f=="function"?f(new URLSearchParams(l)):f);s.current=!0,u("?"+g,p)},[u,l]);return[l,d]}var nx=0,sx=()=>`__${String(++nx)}__`;function ix(){let{router:n}=Um("useSubmit"),{basename:t}=E.useContext(zt),s=_v(),a=n.fetch,l=n.navigate;return E.useCallback(async(u,d={})=>{let{action:f,method:p,encType:g,formData:y,body:x}=Dv(u,t);if(d.navigate===!1){let w=d.fetcherKey||sx();await a(w,s,d.action||f,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,flushSync:d.flushSync})}else await l(d.action||f,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:s,flushSync:d.flushSync,viewTransition:d.viewTransition})},[a,l,t,s])}function ax(n,{relative:t}={}){let{basename:s}=E.useContext(zt),a=E.useContext(Gt);Me(a,"useFormAction must be used inside a RouteContext");let[l]=a.matches.slice(-1),u={...ua(n||".",{relative:t})},d=cr();if(n==null){u.search=d.search;let f=new URLSearchParams(u.search),p=f.getAll("index");if(p.some(y=>y==="")){f.delete("index"),p.filter(x=>x).forEach(x=>f.append("index",x));let y=f.toString();u.search=y?`?${y}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(u.pathname=u.pathname==="/"?s:Ir([s,u.pathname])),Qi(u)}function ox(n,{relative:t}={}){let s=E.useContext(Cm);Me(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=Um("useViewTransitionState"),l=ua(n,{relative:t});if(!s.isTransitioning)return!1;let u=Dr(s.currentLocation.pathname,a)||s.currentLocation.pathname,d=Dr(s.nextLocation.pathname,a)||s.nextLocation.pathname;return Mo(l.pathname,d)!=null||Mo(l.pathname,u)!=null}var Zs=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},lx={setTimeout:(n,t)=>setTimeout(n,t),clearTimeout:n=>clearTimeout(n),setInterval:(n,t)=>setInterval(n,t),clearInterval:n=>clearInterval(n)},ln,Bu,um,cx=(um=class{constructor(){ye(this,ln,lx);ye(this,Bu,!1)}setTimeoutProvider(n){ne(this,ln,n)}setTimeout(n,t){return C(this,ln).setTimeout(n,t)}clearTimeout(n){C(this,ln).clearTimeout(n)}setInterval(n,t){return C(this,ln).setInterval(n,t)}clearInterval(n){C(this,ln).clearInterval(n)}},ln=new WeakMap,Bu=new WeakMap,um),$n=new cx;function ux(n){setTimeout(n,0)}var Qn=typeof window>"u"||"Deno"in globalThis;function xt(){}function dx(n,t){return typeof n=="function"?n(t):n}function mu(n){return typeof n=="number"&&n>=0&&n!==1/0}function Fm(n,t){return Math.max(n+(t||0)-Date.now(),0)}function yn(n,t){return typeof n=="function"?n(t):n}function Kt(n,t){return typeof n=="function"?n(t):n}function _p(n,t){const{type:s="all",exact:a,fetchStatus:l,predicate:u,queryKey:d,stale:f}=n;if(d){if(a){if(t.queryHash!==Zu(d,t.options))return!1}else if(!Gi(t.queryKey,d))return!1}if(s!=="all"){const p=t.isActive();if(s==="active"&&!p||s==="inactive"&&p)return!1}return!(typeof f=="boolean"&&t.isStale()!==f||l&&l!==t.state.fetchStatus||u&&!u(t))}function jp(n,t){const{exact:s,status:a,predicate:l,mutationKey:u}=n;if(u){if(!t.options.mutationKey)return!1;if(s){if(Gn(t.options.mutationKey)!==Gn(u))return!1}else if(!Gi(t.options.mutationKey,u))return!1}return!(a&&t.state.status!==a||l&&!l(t))}function Zu(n,t){return((t==null?void 0:t.queryKeyHashFn)||Gn)(n)}function Gn(n){return JSON.stringify(n,(t,s)=>gu(s)?Object.keys(s).sort().reduce((a,l)=>(a[l]=s[l],a),{}):s)}function Gi(n,t){return n===t?!0:typeof n!=typeof t?!1:n&&t&&typeof n=="object"&&typeof t=="object"?Object.keys(t).every(s=>Gi(n[s],t[s])):!1}var hx=Object.prototype.hasOwnProperty;function qm(n,t,s=0){if(n===t)return n;if(s>500)return t;const a=Sp(n)&&Sp(t);if(!a&&!(gu(n)&&gu(t)))return t;const u=(a?n:Object.keys(n)).length,d=a?t:Object.keys(t),f=d.length,p=a?new Array(f):{};let g=0;for(let y=0;y<f;y++){const x=a?y:d[y],w=n[x],b=t[x];if(w===b){p[x]=w,(a?y<u:hx.call(n,x))&&g++;continue}if(w===null||b===null||typeof w!="object"||typeof b!="object"){p[x]=b;continue}const S=qm(w,b,s+1);p[x]=S,S===w&&g++}return u===f&&g===u?n:p}function qo(n,t){if(!t||Object.keys(n).length!==Object.keys(t).length)return!1;for(const s in n)if(n[s]!==t[s])return!1;return!0}function Sp(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function gu(n){if(!Np(n))return!1;const t=n.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Np(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function Np(n){return Object.prototype.toString.call(n)==="[object Object]"}function fx(n){return new Promise(t=>{$n.setTimeout(t,n)})}function yu(n,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(n,t):s.structuralSharing!==!1?qm(n,t):t}function px(n,t,s=0){const a=[...n,t];return s&&a.length>s?a.slice(1):a}function mx(n,t,s=0){const a=[t,...n];return s&&a.length>s?a.slice(0,-1):a}var ed=Symbol();function Bm(n,t){return!n.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!n.queryFn||n.queryFn===ed?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function td(n,t){return typeof n=="function"?n(...t):!!n}function gx(n,t,s){let a=!1,l;return Object.defineProperty(n,"signal",{enumerable:!0,get:()=>(l!=null||(l=t()),a||(a=!0,l.aborted?s():l.addEventListener("abort",s,{once:!0})),l)}),n}var zn,cn,Is,dm,yx=(dm=class extends Zs{constructor(){super();ye(this,zn);ye(this,cn);ye(this,Is);ne(this,Is,t=>{if(!Qn&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){C(this,cn)||this.setEventListener(C(this,Is))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,cn))==null||t.call(this),ne(this,cn,void 0))}setEventListener(t){var s;ne(this,Is,t),(s=C(this,cn))==null||s.call(this),ne(this,cn,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){C(this,zn)!==t&&(ne(this,zn,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof C(this,zn)=="boolean"?C(this,zn):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},zn=new WeakMap,cn=new WeakMap,Is=new WeakMap,dm),rd=new yx;function vu(){let n,t;const s=new Promise((l,u)=>{n=l,t=u});s.status="pending",s.catch(()=>{});function a(l){Object.assign(s,l),delete s.resolve,delete s.reject}return s.resolve=l=>{a({status:"fulfilled",value:l}),n(l)},s.reject=l=>{a({status:"rejected",reason:l}),t(l)},s}var vx=ux;function xx(){let n=[],t=0,s=f=>{f()},a=f=>{f()},l=vx;const u=f=>{t?n.push(f):l(()=>{s(f)})},d=()=>{const f=n;n=[],f.length&&l(()=>{a(()=>{f.forEach(p=>{s(p)})})})};return{batch:f=>{let p;t++;try{p=f()}finally{t--,t||d()}return p},batchCalls:f=>(...p)=>{u(()=>{f(...p)})},schedule:u,setNotifyFunction:f=>{s=f},setBatchNotifyFunction:f=>{a=f},setScheduler:f=>{l=f}}}var tt=xx(),Ls,un,$s,hm,wx=(hm=class extends Zs{constructor(){super();ye(this,Ls,!0);ye(this,un);ye(this,$s);ne(this,$s,t=>{if(!Qn&&window.addEventListener){const s=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}}})}onSubscribe(){C(this,un)||this.setEventListener(C(this,$s))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,un))==null||t.call(this),ne(this,un,void 0))}setEventListener(t){var s;ne(this,$s,t),(s=C(this,un))==null||s.call(this),ne(this,un,t(this.setOnline.bind(this)))}setOnline(t){C(this,Ls)!==t&&(ne(this,Ls,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return C(this,Ls)}},Ls=new WeakMap,un=new WeakMap,$s=new WeakMap,hm),Bo=new wx;function bx(n){return Math.min(1e3*2**n,3e4)}function Vm(n){return(n!=null?n:"online")==="online"?Bo.isOnline():!0}var xu=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function Hm(n){let t=!1,s=0,a;const l=vu(),u=()=>l.status!=="pending",d=_=>{var j;if(!u()){const N=new xu(_);w(N),(j=n.onCancel)==null||j.call(n,N)}},f=()=>{t=!0},p=()=>{t=!1},g=()=>rd.isFocused()&&(n.networkMode==="always"||Bo.isOnline())&&n.canRun(),y=()=>Vm(n.networkMode)&&n.canRun(),x=_=>{u()||(a==null||a(),l.resolve(_))},w=_=>{u()||(a==null||a(),l.reject(_))},b=()=>new Promise(_=>{var j;a=N=>{(u()||g())&&_(N)},(j=n.onPause)==null||j.call(n)}).then(()=>{var _;a=void 0,u()||(_=n.onContinue)==null||_.call(n)}),S=()=>{if(u())return;let _;const j=s===0?n.initialPromise:void 0;try{_=j!=null?j:n.fn()}catch(N){_=Promise.reject(N)}Promise.resolve(_).then(x).catch(N=>{var J,Z,se;if(u())return;const A=(J=n.retry)!=null?J:Qn?0:3,T=(Z=n.retryDelay)!=null?Z:bx,$=typeof T=="function"?T(s,N):T,K=A===!0||typeof A=="number"&&s<A||typeof A=="function"&&A(s,N);if(t||!K){w(N);return}s++,(se=n.onFail)==null||se.call(n,s,N),fx($).then(()=>g()?void 0:b()).then(()=>{t?w(N):S()})})};return{promise:l,status:()=>l.status,cancel:d,continue:()=>(a==null||a(),l),cancelRetry:f,continueRetry:p,canStart:y,start:()=>(y()?S():b().then(S),l)}}var Un,fm,Km=(fm=class{constructor(){ye(this,Un)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),mu(this.gcTime)&&ne(this,Un,$n.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n!=null?n:Qn?1/0:300*1e3)}clearGcTimeout(){C(this,Un)&&($n.clearTimeout(C(this,Un)),ne(this,Un,void 0))}},Un=new WeakMap,fm),Mn,Ds,Ht,Fn,it,na,qn,ar,Cr,pm,_x=(pm=class extends Km{constructor(t){var s;super();ye(this,ar);ye(this,Mn);ye(this,Ds);ye(this,Ht);ye(this,Fn);ye(this,it);ye(this,na);ye(this,qn);ne(this,qn,!1),ne(this,na,t.defaultOptions),this.setOptions(t.options),this.observers=[],ne(this,Fn,t.client),ne(this,Ht,C(this,Fn).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ne(this,Mn,Ep(this.options)),this.state=(s=t.state)!=null?s:C(this,Mn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=C(this,it))==null?void 0:t.promise}setOptions(t){if(this.options={...C(this,na),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Ep(this.options);s.data!==void 0&&(this.setState(kp(s.data,s.dataUpdatedAt)),ne(this,Mn,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&C(this,Ht).remove(this)}setData(t,s){const a=yu(this.state.data,t,this.options);return Ee(this,ar,Cr).call(this,{data:a,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),a}setState(t,s){Ee(this,ar,Cr).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var a,l;const s=(a=C(this,it))==null?void 0:a.promise;return(l=C(this,it))==null||l.cancel(t),s?s.then(xt).catch(xt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(C(this,Mn))}isActive(){return this.observers.some(t=>Kt(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ed||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>yn(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Fm(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=C(this,it))==null||s.continue()}onOnline(){var s;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=C(this,it))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),C(this,Ht).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(C(this,it)&&(C(this,qn)?C(this,it).cancel({revert:!0}):C(this,it).cancelRetry()),this.scheduleGc()),C(this,Ht).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ee(this,ar,Cr).call(this,{type:"invalidate"})}async fetch(t,s){var p,g,y,x,w,b,S,_,j,N,A,T;if(this.state.fetchStatus!=="idle"&&((p=C(this,it))==null?void 0:p.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(C(this,it))return C(this,it).continueRetry(),C(this,it).promise}if(t&&this.setOptions(t),!this.options.queryFn){const $=this.observers.find(K=>K.options.queryFn);$&&this.setOptions($.options)}const a=new AbortController,l=$=>{Object.defineProperty($,"signal",{enumerable:!0,get:()=>(ne(this,qn,!0),a.signal)})},u=()=>{const $=Bm(this.options,s),J=(()=>{const Z={client:C(this,Fn),queryKey:this.queryKey,meta:this.meta};return l(Z),Z})();return ne(this,qn,!1),this.options.persister?this.options.persister($,J,this):$(J)},f=(()=>{const $={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:C(this,Fn),state:this.state,fetchFn:u};return l($),$})();(g=this.options.behavior)==null||g.onFetch(f,this),ne(this,Ds,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((y=f.fetchOptions)==null?void 0:y.meta))&&Ee(this,ar,Cr).call(this,{type:"fetch",meta:(x=f.fetchOptions)==null?void 0:x.meta}),ne(this,it,Hm({initialPromise:s==null?void 0:s.initialPromise,fn:f.fetchFn,onCancel:$=>{$ instanceof xu&&$.revert&&this.setState({...C(this,Ds),fetchStatus:"idle"}),a.abort()},onFail:($,K)=>{Ee(this,ar,Cr).call(this,{type:"failed",failureCount:$,error:K})},onPause:()=>{Ee(this,ar,Cr).call(this,{type:"pause"})},onContinue:()=>{Ee(this,ar,Cr).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0}));try{const $=await C(this,it).start();if($===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData($),(b=(w=C(this,Ht).config).onSuccess)==null||b.call(w,$,this),(_=(S=C(this,Ht).config).onSettled)==null||_.call(S,$,this.state.error,this),$}catch($){if($ instanceof xu){if($.silent)return C(this,it).promise;if($.revert){if(this.state.data===void 0)throw $;return this.state.data}}throw Ee(this,ar,Cr).call(this,{type:"error",error:$}),(N=(j=C(this,Ht).config).onError)==null||N.call(j,$,this),(T=(A=C(this,Ht).config).onSettled)==null||T.call(A,this.state.data,$,this),$}finally{this.scheduleGc()}}},Mn=new WeakMap,Ds=new WeakMap,Ht=new WeakMap,Fn=new WeakMap,it=new WeakMap,na=new WeakMap,qn=new WeakMap,ar=new WeakSet,Cr=function(t){const s=a=>{var l;switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...Wm(a.data,this.options),fetchMeta:(l=t.meta)!=null?l:null};case"success":const u={...a,...kp(t.data,t.dataUpdatedAt),dataUpdateCount:a.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ne(this,Ds,t.manual?u:void 0),u;case"error":const d=t.error;return{...a,error:d,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:d,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=s(this.state),tt.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),C(this,Ht).notify({query:this,type:"updated",action:t})})},pm);function Wm(n,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Vm(t.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function kp(n,t){return{data:n,dataUpdatedAt:t!=null?t:Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ep(n){const t=typeof n.initialData=="function"?n.initialData():n.initialData,s=t!==void 0,a=s?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?a!=null?a:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Ct,Re,sa,vt,Bn,zs,Pr,dn,ia,Us,Ms,Vn,Hn,hn,Fs,Oe,Vi,wu,bu,_u,ju,Su,Nu,ku,Qm,mm,jx=(mm=class extends Zs{constructor(t,s){super();ye(this,Oe);ye(this,Ct);ye(this,Re);ye(this,sa);ye(this,vt);ye(this,Bn);ye(this,zs);ye(this,Pr);ye(this,dn);ye(this,ia);ye(this,Us);ye(this,Ms);ye(this,Vn);ye(this,Hn);ye(this,hn);ye(this,Fs,new Set);this.options=s,ne(this,Ct,t),ne(this,dn,null),ne(this,Pr,vu()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(C(this,Re).addObserver(this),Cp(C(this,Re),this.options)?Ee(this,Oe,Vi).call(this):this.updateResult(),Ee(this,Oe,ju).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Eu(C(this,Re),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Eu(C(this,Re),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ee(this,Oe,Su).call(this),Ee(this,Oe,Nu).call(this),C(this,Re).removeObserver(this)}setOptions(t){const s=this.options,a=C(this,Re);if(this.options=C(this,Ct).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Kt(this.options.enabled,C(this,Re))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ee(this,Oe,ku).call(this),C(this,Re).setOptions(this.options),s._defaulted&&!qo(this.options,s)&&C(this,Ct).getQueryCache().notify({type:"observerOptionsUpdated",query:C(this,Re),observer:this});const l=this.hasListeners();l&&Rp(C(this,Re),a,this.options,s)&&Ee(this,Oe,Vi).call(this),this.updateResult(),l&&(C(this,Re)!==a||Kt(this.options.enabled,C(this,Re))!==Kt(s.enabled,C(this,Re))||yn(this.options.staleTime,C(this,Re))!==yn(s.staleTime,C(this,Re)))&&Ee(this,Oe,wu).call(this);const u=Ee(this,Oe,bu).call(this);l&&(C(this,Re)!==a||Kt(this.options.enabled,C(this,Re))!==Kt(s.enabled,C(this,Re))||u!==C(this,hn))&&Ee(this,Oe,_u).call(this,u)}getOptimisticResult(t){const s=C(this,Ct).getQueryCache().build(C(this,Ct),t),a=this.createResult(s,t);return Nx(this,a)&&(ne(this,vt,a),ne(this,zs,this.options),ne(this,Bn,C(this,Re).state)),a}getCurrentResult(){return C(this,vt)}trackResult(t,s){return new Proxy(t,{get:(a,l)=>(this.trackProp(l),s==null||s(l),l==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&C(this,Pr).status==="pending"&&C(this,Pr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(a,l))})}trackProp(t){C(this,Fs).add(t)}getCurrentQuery(){return C(this,Re)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=C(this,Ct).defaultQueryOptions(t),a=C(this,Ct).getQueryCache().build(C(this,Ct),s);return a.fetch().then(()=>this.createResult(a,s))}fetch(t){var s;return Ee(this,Oe,Vi).call(this,{...t,cancelRefetch:(s=t.cancelRefetch)!=null?s:!0}).then(()=>(this.updateResult(),C(this,vt)))}createResult(t,s){var ce;const a=C(this,Re),l=this.options,u=C(this,vt),d=C(this,Bn),f=C(this,zs),g=t!==a?t.state:C(this,sa),{state:y}=t;let x={...y},w=!1,b;if(s._optimisticResults){const U=this.hasListeners(),te=!U&&Cp(t,s),he=U&&Rp(t,a,s,l);(te||he)&&(x={...x,...Wm(y.data,t.options)}),s._optimisticResults==="isRestoring"&&(x.fetchStatus="idle")}let{error:S,errorUpdatedAt:_,status:j}=x;b=x.data;let N=!1;if(s.placeholderData!==void 0&&b===void 0&&j==="pending"){let U;u!=null&&u.isPlaceholderData&&s.placeholderData===(f==null?void 0:f.placeholderData)?(U=u.data,N=!0):U=typeof s.placeholderData=="function"?s.placeholderData((ce=C(this,Ms))==null?void 0:ce.state.data,C(this,Ms)):s.placeholderData,U!==void 0&&(j="success",b=yu(u==null?void 0:u.data,U,s),w=!0)}if(s.select&&b!==void 0&&!N)if(u&&b===(d==null?void 0:d.data)&&s.select===C(this,ia))b=C(this,Us);else try{ne(this,ia,s.select),b=s.select(b),b=yu(u==null?void 0:u.data,b,s),ne(this,Us,b),ne(this,dn,null)}catch(U){ne(this,dn,U)}C(this,dn)&&(S=C(this,dn),b=C(this,Us),_=Date.now(),j="error");const A=x.fetchStatus==="fetching",T=j==="pending",$=j==="error",K=T&&A,J=b!==void 0,se={status:j,fetchStatus:x.fetchStatus,isPending:T,isSuccess:j==="success",isError:$,isInitialLoading:K,isLoading:K,data:b,dataUpdatedAt:x.dataUpdatedAt,error:S,errorUpdatedAt:_,failureCount:x.fetchFailureCount,failureReason:x.fetchFailureReason,errorUpdateCount:x.errorUpdateCount,isFetched:x.dataUpdateCount>0||x.errorUpdateCount>0,isFetchedAfterMount:x.dataUpdateCount>g.dataUpdateCount||x.errorUpdateCount>g.errorUpdateCount,isFetching:A,isRefetching:A&&!T,isLoadingError:$&&!J,isPaused:x.fetchStatus==="paused",isPlaceholderData:w,isRefetchError:$&&J,isStale:nd(t,s),refetch:this.refetch,promise:C(this,Pr),isEnabled:Kt(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const U=se.data!==void 0,te=se.status==="error"&&!U,he=ee=>{te?ee.reject(se.error):U&&ee.resolve(se.data)},q=()=>{const ee=ne(this,Pr,se.promise=vu());he(ee)},re=C(this,Pr);switch(re.status){case"pending":t.queryHash===a.queryHash&&he(re);break;case"fulfilled":(te||se.data!==re.value)&&q();break;case"rejected":(!te||se.error!==re.reason)&&q();break}}return se}updateResult(){const t=C(this,vt),s=this.createResult(C(this,Re),this.options);if(ne(this,Bn,C(this,Re).state),ne(this,zs,this.options),C(this,Bn).data!==void 0&&ne(this,Ms,C(this,Re)),qo(s,t))return;ne(this,vt,s);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,u=typeof l=="function"?l():l;if(u==="all"||!u&&!C(this,Fs).size)return!0;const d=new Set(u!=null?u:C(this,Fs));return this.options.throwOnError&&d.add("error"),Object.keys(C(this,vt)).some(f=>{const p=f;return C(this,vt)[p]!==t[p]&&d.has(p)})};Ee(this,Oe,Qm).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ee(this,Oe,ju).call(this)}},Ct=new WeakMap,Re=new WeakMap,sa=new WeakMap,vt=new WeakMap,Bn=new WeakMap,zs=new WeakMap,Pr=new WeakMap,dn=new WeakMap,ia=new WeakMap,Us=new WeakMap,Ms=new WeakMap,Vn=new WeakMap,Hn=new WeakMap,hn=new WeakMap,Fs=new WeakMap,Oe=new WeakSet,Vi=function(t){Ee(this,Oe,ku).call(this);let s=C(this,Re).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(xt)),s},wu=function(){Ee(this,Oe,Su).call(this);const t=yn(this.options.staleTime,C(this,Re));if(Qn||C(this,vt).isStale||!mu(t))return;const a=Fm(C(this,vt).dataUpdatedAt,t)+1;ne(this,Vn,$n.setTimeout(()=>{C(this,vt).isStale||this.updateResult()},a))},bu=function(){var t;return(t=typeof this.options.refetchInterval=="function"?this.options.refetchInterval(C(this,Re)):this.options.refetchInterval)!=null?t:!1},_u=function(t){Ee(this,Oe,Nu).call(this),ne(this,hn,t),!(Qn||Kt(this.options.enabled,C(this,Re))===!1||!mu(C(this,hn))||C(this,hn)===0)&&ne(this,Hn,$n.setInterval(()=>{(this.options.refetchIntervalInBackground||rd.isFocused())&&Ee(this,Oe,Vi).call(this)},C(this,hn)))},ju=function(){Ee(this,Oe,wu).call(this),Ee(this,Oe,_u).call(this,Ee(this,Oe,bu).call(this))},Su=function(){C(this,Vn)&&($n.clearTimeout(C(this,Vn)),ne(this,Vn,void 0))},Nu=function(){C(this,Hn)&&($n.clearInterval(C(this,Hn)),ne(this,Hn,void 0))},ku=function(){const t=C(this,Ct).getQueryCache().build(C(this,Ct),this.options);if(t===C(this,Re))return;const s=C(this,Re);ne(this,Re,t),ne(this,sa,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},Qm=function(t){tt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(C(this,vt))}),C(this,Ct).getQueryCache().notify({query:C(this,Re),type:"observerResultsUpdated"})})},mm);function Sx(n,t){return Kt(t.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&t.retryOnMount===!1)}function Cp(n,t){return Sx(n,t)||n.state.data!==void 0&&Eu(n,t,t.refetchOnMount)}function Eu(n,t,s){if(Kt(t.enabled,n)!==!1&&yn(t.staleTime,n)!=="static"){const a=typeof s=="function"?s(n):s;return a==="always"||a!==!1&&nd(n,t)}return!1}function Rp(n,t,s,a){return(n!==t||Kt(a.enabled,n)===!1)&&(!s.suspense||n.state.status!=="error")&&nd(n,s)}function nd(n,t){return Kt(t.enabled,n)!==!1&&n.isStaleByTime(yn(t.staleTime,n))}function Nx(n,t){return!qo(n.getCurrentResult(),t)}function Pp(n){return{onFetch:(t,s)=>{var y,x,w,b,S;const a=t.options,l=(w=(x=(y=t.fetchOptions)==null?void 0:y.meta)==null?void 0:x.fetchMore)==null?void 0:w.direction,u=((b=t.state.data)==null?void 0:b.pages)||[],d=((S=t.state.data)==null?void 0:S.pageParams)||[];let f={pages:[],pageParams:[]},p=0;const g=async()=>{var T;let _=!1;const j=$=>{gx($,()=>t.signal,()=>_=!0)},N=Bm(t.options,t.fetchOptions),A=async($,K,J)=>{if(_)return Promise.reject();if(K==null&&$.pages.length)return Promise.resolve($);const se=(()=>{const he={client:t.client,queryKey:t.queryKey,pageParam:K,direction:J?"backward":"forward",meta:t.options.meta};return j(he),he})(),ce=await N(se),{maxPages:U}=t.options,te=J?mx:px;return{pages:te($.pages,ce,U),pageParams:te($.pageParams,K,U)}};if(l&&u.length){const $=l==="backward",K=$?kx:Tp,J={pages:u,pageParams:d},Z=K(a,J);f=await A(J,Z,$)}else{const $=n!=null?n:u.length;do{const K=p===0?(T=d[0])!=null?T:a.initialPageParam:Tp(a,f);if(p>0&&K==null)break;f=await A(f,K),p++}while(p<$)}return f};t.options.persister?t.fetchFn=()=>{var _,j;return(j=(_=t.options).persister)==null?void 0:j.call(_,g,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=g}}}function Tp(n,{pages:t,pageParams:s}){const a=t.length-1;return t.length>0?n.getNextPageParam(t[a],t,s[a],s):void 0}function kx(n,{pages:t,pageParams:s}){var a;return t.length>0?(a=n.getPreviousPageParam)==null?void 0:a.call(n,t[0],t,s[0],s):void 0}var aa,mr,pt,Kn,gr,sn,gm,Ex=(gm=class extends Km{constructor(t){super();ye(this,gr);ye(this,aa);ye(this,mr);ye(this,pt);ye(this,Kn);ne(this,aa,t.client),this.mutationId=t.mutationId,ne(this,pt,t.mutationCache),ne(this,mr,[]),this.state=t.state||Gm(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){C(this,mr).includes(t)||(C(this,mr).push(t),this.clearGcTimeout(),C(this,pt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ne(this,mr,C(this,mr).filter(s=>s!==t)),this.scheduleGc(),C(this,pt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){C(this,mr).length||(this.state.status==="pending"?this.scheduleGc():C(this,pt).remove(this))}continue(){var t,s;return(s=(t=C(this,Kn))==null?void 0:t.continue())!=null?s:this.execute(this.state.variables)}async execute(t){var d,f,p,g,y,x,w,b,S,_,j,N,A,T,$,K,J,Z,se;const s=()=>{Ee(this,gr,sn).call(this,{type:"continue"})},a={client:C(this,aa),meta:this.options.meta,mutationKey:this.options.mutationKey};ne(this,Kn,Hm({fn:()=>this.options.mutationFn?this.options.mutationFn(t,a):Promise.reject(new Error("No mutationFn found")),onFail:(ce,U)=>{Ee(this,gr,sn).call(this,{type:"failed",failureCount:ce,error:U})},onPause:()=>{Ee(this,gr,sn).call(this,{type:"pause"})},onContinue:s,retry:(d=this.options.retry)!=null?d:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>C(this,pt).canRun(this)}));const l=this.state.status==="pending",u=!C(this,Kn).canStart();try{if(l)s();else{Ee(this,gr,sn).call(this,{type:"pending",variables:t,isPaused:u}),C(this,pt).config.onMutate&&await C(this,pt).config.onMutate(t,this,a);const U=await((p=(f=this.options).onMutate)==null?void 0:p.call(f,t,a));U!==this.state.context&&Ee(this,gr,sn).call(this,{type:"pending",context:U,variables:t,isPaused:u})}const ce=await C(this,Kn).start();return await((y=(g=C(this,pt).config).onSuccess)==null?void 0:y.call(g,ce,t,this.state.context,this,a)),await((w=(x=this.options).onSuccess)==null?void 0:w.call(x,ce,t,this.state.context,a)),await((S=(b=C(this,pt).config).onSettled)==null?void 0:S.call(b,ce,null,this.state.variables,this.state.context,this,a)),await((j=(_=this.options).onSettled)==null?void 0:j.call(_,ce,null,t,this.state.context,a)),Ee(this,gr,sn).call(this,{type:"success",data:ce}),ce}catch(ce){try{await((A=(N=C(this,pt).config).onError)==null?void 0:A.call(N,ce,t,this.state.context,this,a))}catch(U){Promise.reject(U)}try{await(($=(T=this.options).onError)==null?void 0:$.call(T,ce,t,this.state.context,a))}catch(U){Promise.reject(U)}try{await((J=(K=C(this,pt).config).onSettled)==null?void 0:J.call(K,void 0,ce,this.state.variables,this.state.context,this,a))}catch(U){Promise.reject(U)}try{await((se=(Z=this.options).onSettled)==null?void 0:se.call(Z,void 0,ce,t,this.state.context,a))}catch(U){Promise.reject(U)}throw Ee(this,gr,sn).call(this,{type:"error",error:ce}),ce}finally{C(this,pt).runNext(this)}}},aa=new WeakMap,mr=new WeakMap,pt=new WeakMap,Kn=new WeakMap,gr=new WeakSet,sn=function(t){const s=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),tt.batch(()=>{C(this,mr).forEach(a=>{a.onMutationUpdate(t)}),C(this,pt).notify({mutation:this,type:"updated",action:t})})},gm);function Gm(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Tr,or,oa,ym,Cx=(ym=class extends Zs{constructor(t={}){super();ye(this,Tr);ye(this,or);ye(this,oa);this.config=t,ne(this,Tr,new Set),ne(this,or,new Map),ne(this,oa,0)}build(t,s,a){const l=new Ex({client:t,mutationCache:this,mutationId:++So(this,oa)._,options:t.defaultMutationOptions(s),state:a});return this.add(l),l}add(t){C(this,Tr).add(t);const s=Eo(t);if(typeof s=="string"){const a=C(this,or).get(s);a?a.push(t):C(this,or).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(C(this,Tr).delete(t)){const s=Eo(t);if(typeof s=="string"){const a=C(this,or).get(s);if(a)if(a.length>1){const l=a.indexOf(t);l!==-1&&a.splice(l,1)}else a[0]===t&&C(this,or).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=Eo(t);if(typeof s=="string"){const a=C(this,or).get(s),l=a==null?void 0:a.find(u=>u.state.status==="pending");return!l||l===t}else return!0}runNext(t){var a,l;const s=Eo(t);if(typeof s=="string"){const u=(a=C(this,or).get(s))==null?void 0:a.find(d=>d!==t&&d.state.isPaused);return(l=u==null?void 0:u.continue())!=null?l:Promise.resolve()}else return Promise.resolve()}clear(){tt.batch(()=>{C(this,Tr).forEach(t=>{this.notify({type:"removed",mutation:t})}),C(this,Tr).clear(),C(this,or).clear()})}getAll(){return Array.from(C(this,Tr))}find(t){const s={exact:!0,...t};return this.getAll().find(a=>jp(s,a))}findAll(t={}){return this.getAll().filter(s=>jp(t,s))}notify(t){tt.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return tt.batch(()=>Promise.all(t.map(s=>s.continue().catch(xt))))}},Tr=new WeakMap,or=new WeakMap,oa=new WeakMap,ym);function Eo(n){var t;return(t=n.options.scope)==null?void 0:t.id}var Or,fn,Rt,Ar,$r,Do,Cu,vm,Rx=(vm=class extends Zs{constructor(s,a){super();ye(this,$r);ye(this,Or);ye(this,fn);ye(this,Rt);ye(this,Ar);ne(this,Or,s),this.setOptions(a),this.bindMethods(),Ee(this,$r,Do).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var l;const a=this.options;this.options=C(this,Or).defaultMutationOptions(s),qo(this.options,a)||C(this,Or).getMutationCache().notify({type:"observerOptionsUpdated",mutation:C(this,Rt),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Gn(a.mutationKey)!==Gn(this.options.mutationKey)?this.reset():((l=C(this,Rt))==null?void 0:l.state.status)==="pending"&&C(this,Rt).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=C(this,Rt))==null||s.removeObserver(this)}onMutationUpdate(s){Ee(this,$r,Do).call(this),Ee(this,$r,Cu).call(this,s)}getCurrentResult(){return C(this,fn)}reset(){var s;(s=C(this,Rt))==null||s.removeObserver(this),ne(this,Rt,void 0),Ee(this,$r,Do).call(this),Ee(this,$r,Cu).call(this)}mutate(s,a){var l;return ne(this,Ar,a),(l=C(this,Rt))==null||l.removeObserver(this),ne(this,Rt,C(this,Or).getMutationCache().build(C(this,Or),this.options)),C(this,Rt).addObserver(this),C(this,Rt).execute(s)}},Or=new WeakMap,fn=new WeakMap,Rt=new WeakMap,Ar=new WeakMap,$r=new WeakSet,Do=function(){var a,l;const s=(l=(a=C(this,Rt))==null?void 0:a.state)!=null?l:Gm();ne(this,fn,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},Cu=function(s){tt.batch(()=>{var a,l,u,d,f,p,g,y;if(C(this,Ar)&&this.hasListeners()){const x=C(this,fn).variables,w=C(this,fn).context,b={client:C(this,Or),meta:this.options.meta,mutationKey:this.options.mutationKey};if((s==null?void 0:s.type)==="success"){try{(l=(a=C(this,Ar)).onSuccess)==null||l.call(a,s.data,x,w,b)}catch(S){Promise.reject(S)}try{(d=(u=C(this,Ar)).onSettled)==null||d.call(u,s.data,null,x,w,b)}catch(S){Promise.reject(S)}}else if((s==null?void 0:s.type)==="error"){try{(p=(f=C(this,Ar)).onError)==null||p.call(f,s.error,x,w,b)}catch(S){Promise.reject(S)}try{(y=(g=C(this,Ar)).onSettled)==null||y.call(g,void 0,s.error,x,w,b)}catch(S){Promise.reject(S)}}}this.listeners.forEach(x=>{x(C(this,fn))})})},vm),yr,xm,Px=(xm=class extends Zs{constructor(t={}){super();ye(this,yr);this.config=t,ne(this,yr,new Map)}build(t,s,a){var f;const l=s.queryKey,u=(f=s.queryHash)!=null?f:Zu(l,s);let d=this.get(u);return d||(d=new _x({client:t,queryKey:l,queryHash:u,options:t.defaultQueryOptions(s),state:a,defaultOptions:t.getQueryDefaults(l)}),this.add(d)),d}add(t){C(this,yr).has(t.queryHash)||(C(this,yr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=C(this,yr).get(t.queryHash);s&&(t.destroy(),s===t&&C(this,yr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){tt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return C(this,yr).get(t)}getAll(){return[...C(this,yr).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(a=>_p(s,a))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(a=>_p(t,a)):s}notify(t){tt.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){tt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){tt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},yr=new WeakMap,xm),Ve,pn,mn,qs,Bs,gn,Vs,Hs,wm,Tx=(wm=class{constructor(n={}){ye(this,Ve);ye(this,pn);ye(this,mn);ye(this,qs);ye(this,Bs);ye(this,gn);ye(this,Vs);ye(this,Hs);ne(this,Ve,n.queryCache||new Px),ne(this,pn,n.mutationCache||new Cx),ne(this,mn,n.defaultOptions||{}),ne(this,qs,new Map),ne(this,Bs,new Map),ne(this,gn,0)}mount(){So(this,gn)._++,C(this,gn)===1&&(ne(this,Vs,rd.subscribe(async n=>{n&&(await this.resumePausedMutations(),C(this,Ve).onFocus())})),ne(this,Hs,Bo.subscribe(async n=>{n&&(await this.resumePausedMutations(),C(this,Ve).onOnline())})))}unmount(){var n,t;So(this,gn)._--,C(this,gn)===0&&((n=C(this,Vs))==null||n.call(this),ne(this,Vs,void 0),(t=C(this,Hs))==null||t.call(this),ne(this,Hs,void 0))}isFetching(n){return C(this,Ve).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return C(this,pn).findAll({...n,status:"pending"}).length}getQueryData(n){var s;const t=this.defaultQueryOptions({queryKey:n});return(s=C(this,Ve).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(n){const t=this.defaultQueryOptions(n),s=C(this,Ve).build(this,t),a=s.state.data;return a===void 0?this.fetchQuery(n):(n.revalidateIfStale&&s.isStaleByTime(yn(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(n){return C(this,Ve).findAll(n).map(({queryKey:t,state:s})=>{const a=s.data;return[t,a]})}setQueryData(n,t,s){const a=this.defaultQueryOptions({queryKey:n}),l=C(this,Ve).get(a.queryHash),u=l==null?void 0:l.state.data,d=dx(t,u);if(d!==void 0)return C(this,Ve).build(this,a).setData(d,{...s,manual:!0})}setQueriesData(n,t,s){return tt.batch(()=>C(this,Ve).findAll(n).map(({queryKey:a})=>[a,this.setQueryData(a,t,s)]))}getQueryState(n){var s;const t=this.defaultQueryOptions({queryKey:n});return(s=C(this,Ve).get(t.queryHash))==null?void 0:s.state}removeQueries(n){const t=C(this,Ve);tt.batch(()=>{t.findAll(n).forEach(s=>{t.remove(s)})})}resetQueries(n,t){const s=C(this,Ve);return tt.batch(()=>(s.findAll(n).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...n},t)))}cancelQueries(n,t={}){const s={revert:!0,...t},a=tt.batch(()=>C(this,Ve).findAll(n).map(l=>l.cancel(s)));return Promise.all(a).then(xt).catch(xt)}invalidateQueries(n,t={}){return tt.batch(()=>{var s,a;return C(this,Ve).findAll(n).forEach(l=>{l.invalidate()}),(n==null?void 0:n.refetchType)==="none"?Promise.resolve():this.refetchQueries({...n,type:(a=(s=n==null?void 0:n.refetchType)!=null?s:n==null?void 0:n.type)!=null?a:"active"},t)})}refetchQueries(n,t={}){var l;const s={...t,cancelRefetch:(l=t.cancelRefetch)!=null?l:!0},a=tt.batch(()=>C(this,Ve).findAll(n).filter(u=>!u.isDisabled()&&!u.isStatic()).map(u=>{let d=u.fetch(void 0,s);return s.throwOnError||(d=d.catch(xt)),u.state.fetchStatus==="paused"?Promise.resolve():d}));return Promise.all(a).then(xt)}fetchQuery(n){const t=this.defaultQueryOptions(n);t.retry===void 0&&(t.retry=!1);const s=C(this,Ve).build(this,t);return s.isStaleByTime(yn(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(xt).catch(xt)}fetchInfiniteQuery(n){return n.behavior=Pp(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(xt).catch(xt)}ensureInfiniteQueryData(n){return n.behavior=Pp(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Bo.isOnline()?C(this,pn).resumePausedMutations():Promise.resolve()}getQueryCache(){return C(this,Ve)}getMutationCache(){return C(this,pn)}getDefaultOptions(){return C(this,mn)}setDefaultOptions(n){ne(this,mn,n)}setQueryDefaults(n,t){C(this,qs).set(Gn(n),{queryKey:n,defaultOptions:t})}getQueryDefaults(n){const t=[...C(this,qs).values()],s={};return t.forEach(a=>{Gi(n,a.queryKey)&&Object.assign(s,a.defaultOptions)}),s}setMutationDefaults(n,t){C(this,Bs).set(Gn(n),{mutationKey:n,defaultOptions:t})}getMutationDefaults(n){const t=[...C(this,Bs).values()],s={};return t.forEach(a=>{Gi(n,a.mutationKey)&&Object.assign(s,a.defaultOptions)}),s}defaultQueryOptions(n){if(n._defaulted)return n;const t={...C(this,mn).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return t.queryHash||(t.queryHash=Zu(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ed&&(t.enabled=!1),t}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...C(this,mn).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){C(this,Ve).clear(),C(this,pn).clear()}},Ve=new WeakMap,pn=new WeakMap,mn=new WeakMap,qs=new WeakMap,Bs=new WeakMap,gn=new WeakMap,Vs=new WeakMap,Hs=new WeakMap,wm),Jm=E.createContext(void 0),Tt=n=>{const t=E.useContext(Jm);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Ox=({client:n,children:t})=>(E.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),i.jsx(Jm.Provider,{value:n,children:t})),Ym=E.createContext(!1),Ax=()=>E.useContext(Ym);Ym.Provider;function Ix(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var Lx=E.createContext(Ix()),$x=()=>E.useContext(Lx),Dx=(n,t,s)=>{const a=s!=null&&s.state.error&&typeof n.throwOnError=="function"?td(n.throwOnError,[s.state.error,s]):n.throwOnError;(n.suspense||n.experimental_prefetchInRender||a)&&(t.isReset()||(n.retryOnMount=!1))},zx=n=>{E.useEffect(()=>{n.clearReset()},[n])},Ux=({result:n,errorResetBoundary:t,throwOnError:s,query:a,suspense:l})=>n.isError&&!t.isReset()&&!n.isFetching&&a&&(l&&n.data===void 0||td(s,[n.error,a])),Mx=n=>{if(n.suspense){const s=l=>l==="static"?l:Math.max(l!=null?l:1e3,1e3),a=n.staleTime;n.staleTime=typeof a=="function"?(...l)=>s(a(...l)):s(a),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},Fx=(n,t)=>n.isLoading&&n.isFetching&&!t,qx=(n,t)=>(n==null?void 0:n.suspense)&&t.isPending,Op=(n,t,s)=>t.fetchOptimistic(n).catch(()=>{s.clearReset()});function Bx(n,t,s){var w,b,S,_;const a=Ax(),l=$x(),u=Tt(),d=u.defaultQueryOptions(n);(b=(w=u.getDefaultOptions().queries)==null?void 0:w._experimental_beforeQuery)==null||b.call(w,d);const f=u.getQueryCache().get(d.queryHash);d._optimisticResults=a?"isRestoring":"optimistic",Mx(d),Dx(d,l,f),zx(l);const p=!u.getQueryCache().get(d.queryHash),[g]=E.useState(()=>new t(u,d)),y=g.getOptimisticResult(d),x=!a&&n.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(j=>{const N=x?g.subscribe(tt.batchCalls(j)):xt;return g.updateResult(),N},[g,x]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),E.useEffect(()=>{g.setOptions(d)},[d,g]),qx(d,y))throw Op(d,g,l);if(Ux({result:y,errorResetBoundary:l,throwOnError:d.throwOnError,query:f,suspense:d.suspense}))throw y.error;if((_=(S=u.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||_.call(S,d,y),d.experimental_prefetchInRender&&!Qn&&Fx(y,a)){const j=p?Op(d,g,l):f==null?void 0:f.promise;j==null||j.catch(xt).finally(()=>{g.updateResult()})}return d.notifyOnChangeProps?y:g.trackResult(y)}function Ke(n,t){return Bx(n,jx)}function Pt(n,t){const s=Tt(),[a]=E.useState(()=>new Rx(s,n));E.useEffect(()=>{a.setOptions(n)},[a,n]);const l=E.useSyncExternalStore(E.useCallback(d=>a.subscribe(tt.batchCalls(d)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),u=E.useCallback((d,f)=>{a.mutate(d,f).catch(xt)},[a]);if(l.error&&td(a.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:u,mutateAsync:l.mutate}}function Jo(n,t){var s={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&t.indexOf(a)<0&&(s[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(n);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(s[a[l]]=n[a[l]]);return s}function Vx(n,t,s,a){function l(u){return u instanceof s?u:new s(function(d){d(u)})}return new(s||(s=Promise))(function(u,d){function f(y){try{g(a.next(y))}catch(x){d(x)}}function p(y){try{g(a.throw(y))}catch(x){d(x)}}function g(y){y.done?u(y.value):l(y.value).then(f,p)}g((a=a.apply(n,t||[])).next())})}const Hx=n=>n?(...t)=>n(...t):(...t)=>fetch(...t);class sd extends Error{constructor(t,s="FunctionsError",a){super(t),this.name=s,this.context=a}}class Kx extends sd{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ap extends sd{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ip extends sd{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ru;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Ru||(Ru={}));class Wx{constructor(t,{headers:s={},customFetch:a,region:l=Ru.Any}={}){this.url=t,this.headers=s,this.region=l,this.fetch=Hx(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Vx(this,arguments,void 0,function*(s,a={}){var l;let u,d;try{const{headers:f,method:p,body:g,signal:y,timeout:x}=a;let w={},{region:b}=a;b||(b=this.region);const S=new URL(`${this.url}/${s}`);b&&b!=="any"&&(w["x-region"]=b,S.searchParams.set("forceFunctionRegion",b));let _;g&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&g instanceof Blob||g instanceof ArrayBuffer?(w["Content-Type"]="application/octet-stream",_=g):typeof g=="string"?(w["Content-Type"]="text/plain",_=g):typeof FormData<"u"&&g instanceof FormData?_=g:(w["Content-Type"]="application/json",_=JSON.stringify(g)):g&&typeof g!="string"&&!(typeof Blob<"u"&&g instanceof Blob)&&!(g instanceof ArrayBuffer)&&!(typeof FormData<"u"&&g instanceof FormData)?_=JSON.stringify(g):_=g;let j=y;x&&(d=new AbortController,u=setTimeout(()=>d.abort(),x),y?(j=d.signal,y.addEventListener("abort",()=>d.abort())):j=d.signal);const N=yield this.fetch(S.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},w),this.headers),f),body:_,signal:j}).catch(K=>{throw new Kx(K)}),A=N.headers.get("x-relay-error");if(A&&A==="true")throw new Ap(N);if(!N.ok)throw new Ip(N);let T=((l=N.headers.get("Content-Type"))!==null&&l!==void 0?l:"text/plain").split(";")[0].trim(),$;return T==="application/json"?$=yield N.json():T==="application/octet-stream"||T==="application/pdf"?$=yield N.blob():T==="text/event-stream"?$=N:T==="multipart/form-data"?$=yield N.formData():$=yield N.text(),{data:$,error:null,response:N}}catch(f){return{data:null,error:f,response:f instanceof Ip||f instanceof Ap?f.context:void 0}}finally{u&&clearTimeout(u)}})}}var Qx=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},Gx=class{constructor(n){var t,s;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(t=n.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=n.signal,this.isMaybeSingle=(s=n.isMaybeSingle)!==null&&s!==void 0?s:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,t){return this.headers=new Headers(this.headers),this.headers.set(n,t),this}then(n,t){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{let d=null,f=null,p=null,g=u.status,y=u.statusText;if(u.ok){var x,w;if(s.method!=="HEAD"){var b;const N=await u.text();N===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((b=s.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?f=N:f=JSON.parse(N))}const _=(x=s.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),j=(w=u.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");_&&j&&j.length>1&&(p=parseInt(j[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,g=406,y="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{var S;const _=await u.text();try{d=JSON.parse(_),Array.isArray(d)&&u.status===404&&(f=[],d=null,g=200,y="OK")}catch{u.status===404&&_===""?(g=204,y="No Content"):d={message:_}}if(d&&s.isMaybeSingle&&(!(d==null||(S=d.details)===null||S===void 0)&&S.includes("0 rows"))&&(d=null,g=200,y="OK"),d&&s.shouldThrowOnError)throw new Qx(d)}return{error:d,data:f,count:p,status:g,statusText:y}});return this.shouldThrowOnError||(l=l.catch(u=>{var d;let f="";const p=u==null?void 0:u.cause;if(p){var g,y,x,w;const S=(g=p==null?void 0:p.message)!==null&&g!==void 0?g:"",_=(y=p==null?void 0:p.code)!==null&&y!==void 0?y:"";f=`${(x=u==null?void 0:u.name)!==null&&x!==void 0?x:"FetchError"}: ${u==null?void 0:u.message}`,f+=`

Caused by: ${(w=p==null?void 0:p.name)!==null&&w!==void 0?w:"Error"}: ${S}`,_&&(f+=` (${_})`),p!=null&&p.stack&&(f+=`
${p.stack}`)}else{var b;f=(b=u==null?void 0:u.stack)!==null&&b!==void 0?b:""}return{error:{message:`${(d=u==null?void 0:u.name)!==null&&d!==void 0?d:"FetchError"}: ${u==null?void 0:u.message}`,details:f,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(n,t)}returns(){return this}overrideTypes(){return this}},Jx=class extends Gx{select(n){let t=!1;const s=(n!=null?n:"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:t=!0,nullsFirst:s,foreignTable:a,referencedTable:l=a}={}){const u=l?`${l}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:t,referencedTable:s=t}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,t,{foreignTable:s,referencedTable:a=s}={}){const l=typeof a>"u"?"offset":`${a}.offset`,u=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(u,`${t-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:t=!1,settings:s=!1,buffers:a=!1,wal:l=!1,format:u="text"}={}){var d;const f=[n?"analyze":null,t?"verbose":null,s?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),p=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${p}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const Lp=new RegExp("[,()]");var Es=class extends Jx{eq(n,t){return this.url.searchParams.append(n,`eq.${t}`),this}neq(n,t){return this.url.searchParams.append(n,`neq.${t}`),this}gt(n,t){return this.url.searchParams.append(n,`gt.${t}`),this}gte(n,t){return this.url.searchParams.append(n,`gte.${t}`),this}lt(n,t){return this.url.searchParams.append(n,`lt.${t}`),this}lte(n,t){return this.url.searchParams.append(n,`lte.${t}`),this}like(n,t){return this.url.searchParams.append(n,`like.${t}`),this}likeAllOf(n,t){return this.url.searchParams.append(n,`like(all).{${t.join(",")}}`),this}likeAnyOf(n,t){return this.url.searchParams.append(n,`like(any).{${t.join(",")}}`),this}ilike(n,t){return this.url.searchParams.append(n,`ilike.${t}`),this}ilikeAllOf(n,t){return this.url.searchParams.append(n,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(n,t){return this.url.searchParams.append(n,`ilike(any).{${t.join(",")}}`),this}regexMatch(n,t){return this.url.searchParams.append(n,`match.${t}`),this}regexIMatch(n,t){return this.url.searchParams.append(n,`imatch.${t}`),this}is(n,t){return this.url.searchParams.append(n,`is.${t}`),this}isDistinct(n,t){return this.url.searchParams.append(n,`isdistinct.${t}`),this}in(n,t){const s=Array.from(new Set(t)).map(a=>typeof a=="string"&&Lp.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${s})`),this}notIn(n,t){const s=Array.from(new Set(t)).map(a=>typeof a=="string"&&Lp.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`not.in.(${s})`),this}contains(n,t){return typeof t=="string"?this.url.searchParams.append(n,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(n,`cs.{${t.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(t)}`),this}containedBy(n,t){return typeof t=="string"?this.url.searchParams.append(n,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(n,`cd.{${t.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(t)}`),this}rangeGt(n,t){return this.url.searchParams.append(n,`sr.${t}`),this}rangeGte(n,t){return this.url.searchParams.append(n,`nxl.${t}`),this}rangeLt(n,t){return this.url.searchParams.append(n,`sl.${t}`),this}rangeLte(n,t){return this.url.searchParams.append(n,`nxr.${t}`),this}rangeAdjacent(n,t){return this.url.searchParams.append(n,`adj.${t}`),this}overlaps(n,t){return typeof t=="string"?this.url.searchParams.append(n,`ov.${t}`):this.url.searchParams.append(n,`ov.{${t.join(",")}}`),this}textSearch(n,t,{config:s,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const u=s===void 0?"":`(${s})`;return this.url.searchParams.append(n,`${l}fts${u}.${t}`),this}match(n){return Object.entries(n).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(n,t,s){return this.url.searchParams.append(n,`not.${t}.${s}`),this}or(n,{foreignTable:t,referencedTable:s=t}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,t,s){return this.url.searchParams.append(n,`${t}.${s}`),this}},Yx=class{constructor(n,{headers:t={},schema:s,fetch:a}){this.url=n,this.headers=new Headers(t),this.schema=s,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,t){const{head:s=!1,count:a}=t!=null?t:{},l=s?"HEAD":"GET";let u=!1;const d=(n!=null?n:"*").split("").map(g=>/\s/.test(g)&&!u?"":(g==='"'&&(u=!u),g)).join(""),{url:f,headers:p}=this.cloneRequestState();return f.searchParams.set("select",d),a&&p.append("Prefer",`count=${a}`),new Es({method:l,url:f,headers:p,schema:this.schema,fetch:this.fetch})}insert(n,{count:t,defaultToNull:s=!0}={}){var a;const l="POST",{url:u,headers:d}=this.cloneRequestState();if(t&&d.append("Prefer",`count=${t}`),s||d.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);u.searchParams.set("columns",p.join(","))}}return new Es({method:l,url:u,headers:d,schema:this.schema,body:n,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(n,{onConflict:t,ignoreDuplicates:s=!1,count:a,defaultToNull:l=!0}={}){var u;const d="POST",{url:f,headers:p}=this.cloneRequestState();if(p.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&f.searchParams.set("on_conflict",t),a&&p.append("Prefer",`count=${a}`),l||p.append("Prefer","missing=default"),Array.isArray(n)){const g=n.reduce((y,x)=>y.concat(Object.keys(x)),[]);if(g.length>0){const y=[...new Set(g)].map(x=>`"${x}"`);f.searchParams.set("columns",y.join(","))}}return new Es({method:d,url:f,headers:p,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:t}={}){var s;const a="PATCH",{url:l,headers:u}=this.cloneRequestState();return t&&u.append("Prefer",`count=${t}`),new Es({method:a,url:l,headers:u,schema:this.schema,body:n,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:n}={}){var t;const s="DELETE",{url:a,headers:l}=this.cloneRequestState();return n&&l.append("Prefer",`count=${n}`),new Es({method:s,url:a,headers:l,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Xx=class Xm{constructor(t,{headers:s={},schema:a,fetch:l}={}){this.url=t,this.headers=new Headers(s),this.schemaName=a,this.fetch=l}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Yx(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Xm(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:a=!1,get:l=!1,count:u}={}){var d;let f;const p=new URL(`${this.url}/rpc/${t}`);let g;const y=b=>b!==null&&typeof b=="object"&&(!Array.isArray(b)||b.some(y)),x=a&&Object.values(s).some(y);x?(f="POST",g=s):a||l?(f=a?"HEAD":"GET",Object.entries(s).filter(([b,S])=>S!==void 0).map(([b,S])=>[b,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([b,S])=>{p.searchParams.append(b,S)})):(f="POST",g=s);const w=new Headers(this.headers);return x?w.set("Prefer",u?`count=${u},return=minimal`:"return=minimal"):u&&w.set("Prefer",`count=${u}`),new Es({method:f,url:p,headers:w,schema:this.schemaName,body:g,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}};class Zx{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const s=globalThis.process;if(s){const a=s.versions;if(a&&a.node){const l=a.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const a=this.getWebSocketConstructor();return new a(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const ew="2.93.3",tw=`realtime-js/${ew}`,rw="1.0.0",Zm="2.0.0",$p=Zm,Pu=1e4,nw=1e3,sw=100;var an;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(an||(an={}));var et;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(et||(et={}));var lr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(lr||(lr={}));var Tu;(function(n){n.websocket="websocket"})(Tu||(Tu={}));var In;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(In||(In={}));class iw{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t!=null?t:[]}encode(t,s){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return s(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var s;return this._isArrayBuffer((s=t.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var s,a;const l=(a=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,l)}_encodeJsonUserBroadcastPush(t){var s,a;const l=(a=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&a!==void 0?a:{},d=new TextEncoder().encode(JSON.stringify(l)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,d)}_encodeUserBroadcastPush(t,s,a){var l,u;const d=t.topic,f=(l=t.ref)!==null&&l!==void 0?l:"",p=(u=t.join_ref)!==null&&u!==void 0?u:"",g=t.payload.event,y=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(y).length===0?"":JSON.stringify(y);if(p.length>255)throw new Error(`joinRef length ${p.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`ref length ${f.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`topic length ${d.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`userEvent length ${g.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const w=this.USER_BROADCAST_PUSH_META_LENGTH+p.length+f.length+d.length+g.length+x.length,b=new ArrayBuffer(this.HEADER_LENGTH+w);let S=new DataView(b),_=0;S.setUint8(_++,this.KINDS.userBroadcastPush),S.setUint8(_++,p.length),S.setUint8(_++,f.length),S.setUint8(_++,d.length),S.setUint8(_++,g.length),S.setUint8(_++,x.length),S.setUint8(_++,s),Array.from(p,N=>S.setUint8(_++,N.charCodeAt(0))),Array.from(f,N=>S.setUint8(_++,N.charCodeAt(0))),Array.from(d,N=>S.setUint8(_++,N.charCodeAt(0))),Array.from(g,N=>S.setUint8(_++,N.charCodeAt(0))),Array.from(x,N=>S.setUint8(_++,N.charCodeAt(0)));var j=new Uint8Array(b.byteLength+a.byteLength);return j.set(new Uint8Array(b),0),j.set(new Uint8Array(a),b.byteLength),j.buffer}decode(t,s){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return s(a)}if(typeof t=="string"){const a=JSON.parse(t),[l,u,d,f,p]=a;return s({join_ref:l,ref:u,topic:d,event:f,payload:p})}return s({})}_binaryDecode(t){const s=new DataView(t),a=s.getUint8(0),l=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,s,l)}}_decodeUserBroadcast(t,s,a){const l=s.getUint8(1),u=s.getUint8(2),d=s.getUint8(3),f=s.getUint8(4);let p=this.HEADER_LENGTH+4;const g=a.decode(t.slice(p,p+l));p=p+l;const y=a.decode(t.slice(p,p+u));p=p+u;const x=a.decode(t.slice(p,p+d));p=p+d;const w=t.slice(p,t.byteLength),b=f===this.JSON_ENCODING?JSON.parse(a.decode(w)):w,S={type:this.BROADCAST_EVENT,event:y,payload:b};return d>0&&(S.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:g,event:this.BROADCAST_EVENT,payload:S}}_isArrayBuffer(t){var s;return t instanceof ArrayBuffer||((s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(t,s){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>s.includes(a)))}}class eg{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Le;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Le||(Le={}));const Dp=(n,t,s={})=>{var a;const l=(a=s.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((u,d)=>(u[d]=aw(d,n,t,l),u),{}):{}},aw=(n,t,s,a)=>{const l=t.find(f=>f.name===n),u=l==null?void 0:l.type,d=s[n];return u&&!a.includes(u)?tg(u,d):Ou(d)},tg=(n,t)=>{if(n.charAt(0)==="_"){const s=n.slice(1,n.length);return uw(t,s)}switch(n){case Le.bool:return ow(t);case Le.float4:case Le.float8:case Le.int2:case Le.int4:case Le.int8:case Le.numeric:case Le.oid:return lw(t);case Le.json:case Le.jsonb:return cw(t);case Le.timestamp:return dw(t);case Le.abstime:case Le.date:case Le.daterange:case Le.int4range:case Le.int8range:case Le.money:case Le.reltime:case Le.text:case Le.time:case Le.timestamptz:case Le.timetz:case Le.tsrange:case Le.tstzrange:return Ou(t);default:return Ou(t)}},Ou=n=>n,ow=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},lw=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},cw=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},uw=(n,t)=>{if(typeof n!="string")return n;const s=n.length-1,a=n[s];if(n[0]==="{"&&a==="}"){let u;const d=n.slice(1,s);try{u=JSON.parse("["+d+"]")}catch{u=d?d.split(","):[]}return u.map(f=>tg(t,f))}return n},dw=n=>typeof n=="string"?n.replace(" ","T"):n,rg=n=>{const t=new URL(n);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class iu{constructor(t,s,a={},l=Pu){this.channel=t,this.event=s,this.payload=a,this.timeout=l,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var a;return this._hasReceived(t)&&s((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var zp;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(zp||(zp={}));class Ki{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},l=>{const{onJoin:u,onLeave:d,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ki.syncState(this.state,l,u,d),this.pendingDiffs.forEach(p=>{this.state=Ki.syncDiff(this.state,p,u,d)}),this.pendingDiffs=[],f()}),this.channel._on(a.diff,{},l=>{const{onJoin:u,onLeave:d,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=Ki.syncDiff(this.state,l,u,d),f())}),this.onJoin((l,u,d)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:u,newPresences:d})}),this.onLeave((l,u,d)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:u,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,a,l){const u=this.cloneDeep(t),d=this.transformState(s),f={},p={};return this.map(u,(g,y)=>{d[g]||(p[g]=y)}),this.map(d,(g,y)=>{const x=u[g];if(x){const w=y.map(j=>j.presence_ref),b=x.map(j=>j.presence_ref),S=y.filter(j=>b.indexOf(j.presence_ref)<0),_=x.filter(j=>w.indexOf(j.presence_ref)<0);S.length>0&&(f[g]=S),_.length>0&&(p[g]=_)}else f[g]=y}),this.syncDiff(u,{joins:f,leaves:p},a,l)}static syncDiff(t,s,a,l){const{joins:u,leaves:d}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return a||(a=()=>{}),l||(l=()=>{}),this.map(u,(f,p)=>{var g;const y=(g=t[f])!==null&&g!==void 0?g:[];if(t[f]=this.cloneDeep(p),y.length>0){const x=t[f].map(b=>b.presence_ref),w=y.filter(b=>x.indexOf(b.presence_ref)<0);t[f].unshift(...w)}a(f,y,p)}),this.map(d,(f,p)=>{let g=t[f];if(!g)return;const y=p.map(x=>x.presence_ref);g=g.filter(x=>y.indexOf(x.presence_ref)<0),t[f]=g,l(f,g,p),g.length===0&&delete t[f]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(a=>s(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,a)=>{const l=t[a];return"metas"in l?s[a]=l.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):s[a]=l,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Up;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Up||(Up={}));var Wi;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Wi||(Wi={}));var Rr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Rr||(Rr={}));class Ps{constructor(t,s={config:{}},a){var l,u;if(this.topic=t,this.params=s,this.socket=a,this.bindings={},this.state=et.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new iu(this,lr.join,this.params,this.timeout),this.rejoinTimer=new eg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=et.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(d=>d.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=et.closed,this.socket._remove(this)}),this._onError(d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=et.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=et.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=et.errored,this.rejoinTimer.scheduleTimeout())}),this._on(lr.reply,{},(d,f)=>{this._trigger(this._replyEventName(f),d)}),this.presence=new Ki(this),this.broadcastEndpointURL=rg(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((u=(l=this.params.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,s=this.timeout){var a,l,u;if(this.socket.isConnected()||this.socket.connect(),this.state==et.closed){const{config:{broadcast:d,presence:f,private:p}}=this.params,g=(l=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(b=>b.filter))!==null&&l!==void 0?l:[],y=!!this.bindings[Wi.PRESENCE]&&this.bindings[Wi.PRESENCE].length>0||((u=this.params.config.presence)===null||u===void 0?void 0:u.enabled)===!0,x={},w={broadcast:d,presence:Object.assign(Object.assign({},f),{enabled:y}),postgres_changes:g,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>t==null?void 0:t(Rr.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(Rr.CLOSED)),this.updateJoinPayload(Object.assign({config:w},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var S;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t==null||t(Rr.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,j=(S=_==null?void 0:_.length)!==null&&S!==void 0?S:0,N=[];for(let A=0;A<j;A++){const T=_[A],{filter:{event:$,schema:K,table:J,filter:Z}}=T,se=b&&b[A];if(se&&se.event===$&&Ps.isFilterValueEqual(se.schema,K)&&Ps.isFilterValueEqual(se.table,J)&&Ps.isFilterValueEqual(se.filter,Z))N.push(Object.assign(Object.assign({},T),{id:se.id}));else{this.unsubscribe(),this.state=et.errored,t==null||t(Rr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,t&&t(Rr.SUBSCRIBED);return}}).receive("error",b=>{this.state=et.errored,t==null||t(Rr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Rr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,a){return this.state===et.joined&&t===Wi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,s,a)}async httpSend(t,s,a={}){var l;if(s==null)return Promise.reject("Payload is required for httpSend()");const u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:s,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(l=a.timeout)!==null&&l!==void 0?l:this.timeout);if(f.status===202)return{success:!0};let p=f.statusText;try{const g=await f.json();p=g.error||g.message||p}catch{}return Promise.reject(new Error(p))}async send(t,s={}){var a,l;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:u,payload:d}=t,f={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(f.Authorization=`Bearer ${this.socket.accessTokenValue}`);const p={method:"POST",headers:f,body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:d,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);return await((l=g.body)===null||l===void 0?void 0:l.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var d,f,p;const g=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((p=(f=(d=this.params)===null||d===void 0?void 0:d.config)===null||f===void 0?void 0:f.broadcast)===null||p===void 0)&&p.ack)&&u("ok"),g.receive("ok",()=>u("ok")),g.receive("error",()=>u("error")),g.receive("timeout",()=>u("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=et.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(lr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(l=>{a=new iu(this,lr.leave,{},t),a.receive("ok",()=>{s(),l("ok")}).receive("timeout",()=>{s(),l("timed out")}).receive("error",()=>{l("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=et.closed,this.bindings={}}async _fetchWithTimeout(t,s,a){const l=new AbortController,u=setTimeout(()=>l.abort(),a),d=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:l.signal}));return clearTimeout(u),d}_push(t,s,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let l=new iu(this,t,s,a);return this._canPush()?l.send():this._addToPushBuffer(l),l}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>sw){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,a){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,a){var l,u;const d=t.toLocaleLowerCase(),{close:f,error:p,leave:g,join:y}=lr;if(a&&[f,p,g,y].indexOf(d)>=0&&a!==this._joinRef())return;let w=this._onMessage(d,s,a);if(s&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(l=this.bindings.postgres_changes)===null||l===void 0||l.filter(b=>{var S,_,j;return((S=b.filter)===null||S===void 0?void 0:S.event)==="*"||((j=(_=b.filter)===null||_===void 0?void 0:_.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===d}).map(b=>b.callback(w,a)):(u=this.bindings[d])===null||u===void 0||u.filter(b=>{var S,_,j,N,A,T;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in b){const $=b.id,K=(S=b.filter)===null||S===void 0?void 0:S.event;return $&&((_=s.ids)===null||_===void 0?void 0:_.includes($))&&(K==="*"||(K==null?void 0:K.toLocaleLowerCase())===((j=s.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const $=(A=(N=b==null?void 0:b.filter)===null||N===void 0?void 0:N.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return $==="*"||$===((T=s==null?void 0:s.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===d}).map(b=>{if(typeof w=="object"&&"ids"in w){const S=w.data,{schema:_,table:j,commit_timestamp:N,type:A,errors:T}=S;w=Object.assign(Object.assign({},{schema:_,table:j,commit_timestamp:N,eventType:A,new:{},old:{},errors:T}),this._getPayloadRecords(S))}b.callback(w,a)})}_isClosed(){return this.state===et.closed}_isJoined(){return this.state===et.joined}_isJoining(){return this.state===et.joining}_isLeaving(){return this.state===et.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,a){const l=t.toLocaleLowerCase(),u={type:l,filter:s,callback:a};return this.bindings[l]?this.bindings[l].push(u):this.bindings[l]=[u],this}_off(t,s){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(l=>{var u;return!(((u=l.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===a&&Ps.isEqual(l.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const a in t)if(t[a]!==s[a])return!1;return!0}static isFilterValueEqual(t,s){const a=t!=null?t:void 0,l=s!=null?s:void 0;return a===l}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(lr.close,{},t)}_onError(t){this._on(lr.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=et.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=Dp(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=Dp(t.columns,t.old_record)),s}}const au=()=>{},Co={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},hw=[1e3,2e3,5e3,1e4],fw=1e4,pw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mw{constructor(t,s){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Pu,this.transport=null,this.heartbeatIntervalMs=Co.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=au,this.ref=0,this.reconnectTimer=null,this.vsn=$p,this.logger=au,this.conn=null,this.sendBuffer=[],this.serializer=new iw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=l=>l?(...u)=>l(...u):(...u)=>fetch(...u),!(!((a=s==null?void 0:s.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${Tu.websocket}`,this.httpEndpoint=rg(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Zx.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,s!=null?s:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,a){this.logger(t,s,a)}connectionState(){switch(this.conn&&this.conn.readyState){case an.connecting:return In.Connecting;case an.open:return In.Open;case an.closing:return In.Closing;default:return In.Closed}}isConnected(){return this.connectionState()===In.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const a=`realtime:${t}`,l=this.getChannels().find(u=>u.topic===a);if(l)return l;{const u=new Ps(`realtime:${t}`,s,this);return this.channels.push(u),u}}push(t){const{topic:s,event:a,payload:l,ref:u}=t,d=()=>{this.encode(t,f=>{var p;(p=this.conn)===null||p===void 0||p.send(f)})};this.log("push",`${s} ${a} (${u})`,l),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(nw,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Co.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply"&&s.ref&&s.ref===this.pendingHeartbeatRef){const g=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error",g)}catch(y){this.log("error","error in heartbeat callback",y)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:l,payload:u,ref:d}=s,f=d?`(${d})`:"",p=u.status||"";this.log("receive",`${p} ${a} ${l} ${f}`.trim(),u),this.channels.filter(g=>g._isMember(a)).forEach(g=>g._trigger(l,u,d)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===an.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===an.open||this.conn.readyState===an.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this._terminateWorker()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(s){this.log("error","error in heartbeat callback",s)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(lr.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const a=t.match(/\?/)?"&":"?",l=new URLSearchParams(s);return`${t}${a}${l}`}_workerObjectUrl(t){let s;if(t)s=t;else{const a=new Blob([pw],{type:"application/javascript"});s=URL.createObjectURL(a)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(t=null){let s,a=!1;if(t)s=t,a=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(l){this.log("error","Error fetching access token from callback",l),s=this.accessTokenValue}else s=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:tw};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(lr.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(s)}catch(l){this.log("error",`error in ${t} callback`,l)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new eg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Co.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var s,a,l,u,d,f,p,g,y,x,w,b;switch(this.transport=(s=t==null?void 0:t.transport)!==null&&s!==void 0?s:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Pu,this.heartbeatIntervalMs=(l=t==null?void 0:t.heartbeatIntervalMs)!==null&&l!==void 0?l:Co.HEARTBEAT_INTERVAL,this.worker=(u=t==null?void 0:t.worker)!==null&&u!==void 0?u:!1,this.accessToken=(d=t==null?void 0:t.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(f=t==null?void 0:t.heartbeatCallback)!==null&&f!==void 0?f:au,this.vsn=(p=t==null?void 0:t.vsn)!==null&&p!==void 0?p:$p,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=t==null?void 0:t.reconnectAfterMs)!==null&&g!==void 0?g:(S=>hw[S-1]||fw),this.vsn){case rw:this.encode=(y=t==null?void 0:t.encode)!==null&&y!==void 0?y:((S,_)=>_(JSON.stringify(S))),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:((S,_)=>_(JSON.parse(S)));break;case Zm:this.encode=(w=t==null?void 0:t.encode)!==null&&w!==void 0?w:this.serializer.encode.bind(this.serializer),this.decode=(b=t==null?void 0:t.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Ji=class extends Error{constructor(n,t){var s;super(n),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((s=t.icebergType)==null?void 0:s.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function gw(n,t,s){const a=new URL(t,n);if(s)for(const[l,u]of Object.entries(s))u!==void 0&&a.searchParams.set(l,u);return a.toString()}async function yw(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function vw(n){var s;const t=(s=n.fetchImpl)!=null?s:globalThis.fetch;return{async request({method:a,path:l,query:u,body:d,headers:f}){var S;const p=gw(n.baseUrl,l,u),g=await yw(n.auth),y=await t(p,{method:a,headers:{...d?{"Content-Type":"application/json"}:{},...g,...f},body:d?JSON.stringify(d):void 0}),x=await y.text(),w=(y.headers.get("content-type")||"").includes("application/json"),b=w&&x?JSON.parse(x):x;if(!y.ok){const _=w?b:void 0,j=_==null?void 0:_.error;throw new Ji((S=j==null?void 0:j.message)!=null?S:`Request failed with status ${y.status}`,{status:y.status,icebergType:j==null?void 0:j.type,icebergCode:j==null?void 0:j.code,details:_})}return{status:y.status,headers:y.headers,data:b}}}}function Ro(n){return n.join("")}var xw=class{constructor(n,t=""){this.client=n,this.prefix=t}async listNamespaces(n){const t=n?{parent:Ro(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(n,t){const s={namespace:n.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ro(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ro(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ro(n.namespace)}`}),!0}catch(t){if(t instanceof Ji&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(n,t){try{return await this.createNamespace(n,t)}catch(s){if(s instanceof Ji&&s.status===409)return;throw s}}};function bs(n){return n.join("")}var ww=class{constructor(n,t="",s){this.client=n,this.prefix=t,this.accessDelegation=s}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables`})).data.identifiers}async createTable(n,t){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables`,body:t,headers:s})).data.metadata}async updateTable(n,t){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables/${n.name}`,body:t});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(n,t){var s;await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((s=t==null?void 0:t.purge)!=null?s:!1)}})}async loadTable(n){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables/${n.name}`,headers:t})).data.metadata}async tableExists(n){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bs(n.namespace)}/tables/${n.name}`,headers:t}),!0}catch(s){if(s instanceof Ji&&s.status===404)return!1;throw s}}async createTableIfNotExists(n,t){try{return await this.createTable(n,t)}catch(s){if(s instanceof Ji&&s.status===409)return await this.loadTable({namespace:n.namespace,name:t.name});throw s}}},bw=class{constructor(n){var a;let t="v1";n.catalogName&&(t+=`/${n.catalogName}`);const s=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=vw({baseUrl:s,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(a=n.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new xw(this.client,t),this.tableOps=new ww(this.client,t,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,t){return this.namespaceOps.createNamespace(n,t)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,t){return this.tableOps.createTable(n,t)}async updateTable(n,t){return this.tableOps.updateTable(n,t)}async dropTable(n,t){await this.tableOps.dropTable(n,t)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,t){return this.namespaceOps.createNamespaceIfNotExists(n,t)}async createTableIfNotExists(n,t){return this.tableOps.createTableIfNotExists(n,t)}},Yo=class extends Error{constructor(n,t="storage",s,a){super(n),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=s,this.statusCode=a}};function Xo(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Po=class extends Yo{constructor(n,t,s,a="storage"){super(n,a,t,s),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ng=class extends Yo{constructor(n,t,s="storage"){super(n,s),this.name=s==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const _w=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),jw=n=>{if(typeof n!="object"||n===null)return!1;const t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Au=n=>{if(Array.isArray(n))return n.map(s=>Au(s));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([s,a])=>{const l=s.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));t[l]=Au(a)}),t},Sw=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function Yi(n){"@babel/helpers - typeof";return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi(n)}function Nw(n,t){if(Yi(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var a=s.call(n,t);if(Yi(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function kw(n){var t=Nw(n,"string");return Yi(t)=="symbol"?t:t+""}function Ew(n,t,s){return(t=kw(t))in n?Object.defineProperty(n,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[t]=s,n}function Mp(n,t){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),s.push.apply(s,a)}return s}function je(n){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?Mp(Object(s),!0).forEach(function(a){Ew(n,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):Mp(Object(s)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(s,a))})}return n}const Fp=n=>{var t;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(t=n.error)===null||t===void 0?void 0:t.message)||JSON.stringify(n)},Cw=async(n,t,s,a)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(s!=null&&s.noResolveJson)){const l=n,u=l.status||500;if(typeof l.json=="function")l.json().then(d=>{const f=(d==null?void 0:d.statusCode)||(d==null?void 0:d.code)||u+"";t(new Po(Fp(d),u,f,a))}).catch(()=>{if(a==="vectors"){const d=u+"";t(new Po(l.statusText||`HTTP ${u} error`,u,d,a))}else{const d=u+"";t(new Po(l.statusText||`HTTP ${u} error`,u,d,a))}});else{const d=u+"";t(new Po(l.statusText||`HTTP ${u} error`,u,d,a))}}else t(new ng(Fp(n),n,a))},Rw=(n,t,s,a)=>{const l={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"||n==="HEAD"||!a?je(je({},l),s):(jw(a)?(l.headers=je({"Content-Type":"application/json"},t==null?void 0:t.headers),l.body=JSON.stringify(a)):l.body=a,t!=null&&t.duplex&&(l.duplex=t.duplex),je(je({},l),s))};async function Bi(n,t,s,a,l,u,d){return new Promise((f,p)=>{n(s,Rw(t,a,l,u)).then(g=>{if(!g.ok)throw g;if(a!=null&&a.noResolveJson)return g;if(d==="vectors"){const y=g.headers.get("content-type");if(g.headers.get("content-length")==="0"||g.status===204)return{};if(!y||!y.includes("application/json"))return{}}return g.json()}).then(g=>f(g)).catch(g=>Cw(g,p,a,d))})}function sg(n="storage"){return{get:async(t,s,a,l)=>Bi(t,"GET",s,a,l,void 0,n),post:async(t,s,a,l,u)=>Bi(t,"POST",s,l,u,a,n),put:async(t,s,a,l,u)=>Bi(t,"PUT",s,l,u,a,n),head:async(t,s,a,l)=>Bi(t,"HEAD",s,je(je({},a),{},{noResolveJson:!0}),l,void 0,n),remove:async(t,s,a,l,u)=>Bi(t,"DELETE",s,l,u,a,n)}}const Pw=sg("storage"),{get:Xi,post:ir,put:Iu,head:Tw,remove:id}=Pw,Dt=sg("vectors");var ei=class{constructor(n,t={},s,a="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=t,this.fetch=_w(s),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var t=this;try{return{data:await n(),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Xo(s))return{data:null,error:s};throw s}}},Ow=class{constructor(n,t){this.downloadFn=n,this.shouldThrowOnError=t}then(n,t){return this.execute().then(n,t)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(t){if(n.shouldThrowOnError)throw t;if(Xo(t))return{data:null,error:t};throw t}}};let ig;ig=Symbol.toStringTag;var Aw=class{constructor(n,t){this.downloadFn=n,this.shouldThrowOnError=t,this[ig]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ow(this.downloadFn,this.shouldThrowOnError)}then(n,t){return this.getPromise().then(n,t)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(t){if(n.shouldThrowOnError)throw t;if(Xo(t))return{data:null,error:t};throw t}}};const Iw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Lw=class extends ei{constructor(n,t={},s,a){super(n,t,a,"storage"),this.bucketId=s}async uploadOrUpdate(n,t,s,a){var l=this;return l.handleOperation(async()=>{let u;const d=je(je({},qp),a);let f=je(je({},l.headers),n==="POST"&&{"x-upsert":String(d.upsert)});const p=d.metadata;typeof Blob<"u"&&s instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),p&&u.append("metadata",l.encodeMetadata(p)),u.append("",s)):typeof FormData<"u"&&s instanceof FormData?(u=s,u.has("cacheControl")||u.append("cacheControl",d.cacheControl),p&&!u.has("metadata")&&u.append("metadata",l.encodeMetadata(p))):(u=s,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType,p&&(f["x-metadata"]=l.toBase64(l.encodeMetadata(p))),(typeof ReadableStream<"u"&&u instanceof ReadableStream||u&&typeof u=="object"&&"pipe"in u&&typeof u.pipe=="function")&&!d.duplex&&(d.duplex="half")),a!=null&&a.headers&&(f=je(je({},f),a.headers));const g=l._removeEmptyFolders(t),y=l._getFinalPath(g),x=await(n=="PUT"?Iu:ir)(l.fetch,`${l.url}/object/${y}`,u,je({headers:f},d!=null&&d.duplex?{duplex:d.duplex}:{}));return{path:g,id:x.Id,fullPath:x.Key}})}async upload(n,t,s){return this.uploadOrUpdate("POST",n,t,s)}async uploadToSignedUrl(n,t,s,a){var l=this;const u=l._removeEmptyFolders(n),d=l._getFinalPath(u),f=new URL(l.url+`/object/upload/sign/${d}`);return f.searchParams.set("token",t),l.handleOperation(async()=>{let p;const g=je({upsert:qp.upsert},a),y=je(je({},l.headers),{"x-upsert":String(g.upsert)});return typeof Blob<"u"&&s instanceof Blob?(p=new FormData,p.append("cacheControl",g.cacheControl),p.append("",s)):typeof FormData<"u"&&s instanceof FormData?(p=s,p.append("cacheControl",g.cacheControl)):(p=s,y["cache-control"]=`max-age=${g.cacheControl}`,y["content-type"]=g.contentType),{path:u,fullPath:(await Iu(l.fetch,f.toString(),p,{headers:y})).Key}})}async createSignedUploadUrl(n,t){var s=this;return s.handleOperation(async()=>{let a=s._getFinalPath(n);const l=je({},s.headers);t!=null&&t.upsert&&(l["x-upsert"]="true");const u=await ir(s.fetch,`${s.url}/object/upload/sign/${a}`,{},{headers:l}),d=new URL(s.url+u.url),f=d.searchParams.get("token");if(!f)throw new Yo("No token returned by API");return{signedUrl:d.toString(),path:n,token:f}})}async update(n,t,s){return this.uploadOrUpdate("PUT",n,t,s)}async move(n,t,s){var a=this;return a.handleOperation(async()=>await ir(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:n,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:a.headers}))}async copy(n,t,s){var a=this;return a.handleOperation(async()=>({path:(await ir(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:n,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(n,t,s){var a=this;return a.handleOperation(async()=>{let l=a._getFinalPath(n),u=await ir(a.fetch,`${a.url}/object/sign/${l}`,je({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:a.headers});const d=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{signedUrl:encodeURI(`${a.url}${u.signedURL}${d}`)}})}async createSignedUrls(n,t,s){var a=this;return a.handleOperation(async()=>{const l=await ir(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:n},{headers:a.headers}),u=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return l.map(d=>je(je({},d),{},{signedUrl:d.signedURL?encodeURI(`${a.url}${d.signedURL}${u}`):null}))})}download(n,t){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),l=a?`?${a}`:"",u=this._getFinalPath(n),d=()=>Xi(this.fetch,`${this.url}/${s}/${u}${l}`,{headers:this.headers,noResolveJson:!0});return new Aw(d,this.shouldThrowOnError)}async info(n){var t=this;const s=t._getFinalPath(n);return t.handleOperation(async()=>Au(await Xi(t.fetch,`${t.url}/object/info/${s}`,{headers:t.headers})))}async exists(n){var t=this;const s=t._getFinalPath(n);try{return await Tw(t.fetch,`${t.url}/object/${s}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Xo(a)&&a instanceof ng){const l=a.originalError;if([400,404].includes(l==null?void 0:l.status))return{data:!1,error:a}}throw a}}getPublicUrl(n,t){const s=this._getFinalPath(n),a=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const u=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${s}${f}`)}}}async remove(n){var t=this;return t.handleOperation(async()=>await id(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:n},{headers:t.headers}))}async list(n,t,s){var a=this;return a.handleOperation(async()=>{const l=je(je(je({},Iw),t),{},{prefix:n||""});return await ir(a.fetch,`${a.url}/object/list/${a.bucketId}`,l,{headers:a.headers},s)})}async listV2(n,t){var s=this;return s.handleOperation(async()=>{const a=je({},n);return await ir(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,a,{headers:s.headers},t)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const t=[];return n.width&&t.push(`width=${n.width}`),n.height&&t.push(`height=${n.height}`),n.resize&&t.push(`resize=${n.resize}`),n.format&&t.push(`format=${n.format}`),n.quality&&t.push(`quality=${n.quality}`),t.join("&")}};const $w="2.93.3",da={"X-Client-Info":`storage-js/${$w}`};var Dw=class extends ei{constructor(n,t={},s,a){const l=new URL(n);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase."));const u=l.href.replace(/\/$/,""),d=je(je({},da),t);super(u,d,s,"storage")}async listBuckets(n){var t=this;return t.handleOperation(async()=>{const s=t.listBucketOptionsToQueryString(n);return await Xi(t.fetch,`${t.url}/bucket${s}`,{headers:t.headers})})}async getBucket(n){var t=this;return t.handleOperation(async()=>await Xi(t.fetch,`${t.url}/bucket/${n}`,{headers:t.headers}))}async createBucket(n,t={public:!1}){var s=this;return s.handleOperation(async()=>await ir(s.fetch,`${s.url}/bucket`,{id:n,name:n,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}))}async updateBucket(n,t){var s=this;return s.handleOperation(async()=>await Iu(s.fetch,`${s.url}/bucket/${n}`,{id:n,name:n,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}))}async emptyBucket(n){var t=this;return t.handleOperation(async()=>await ir(t.fetch,`${t.url}/bucket/${n}/empty`,{},{headers:t.headers}))}async deleteBucket(n){var t=this;return t.handleOperation(async()=>await id(t.fetch,`${t.url}/bucket/${n}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(n){const t={};return n&&("limit"in n&&(t.limit=String(n.limit)),"offset"in n&&(t.offset=String(n.offset)),n.search&&(t.search=n.search),n.sortColumn&&(t.sortColumn=n.sortColumn),n.sortOrder&&(t.sortOrder=n.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},zw=class extends ei{constructor(n,t={},s){const a=n.replace(/\/$/,""),l=je(je({},da),t);super(a,l,s,"storage")}async createBucket(n){var t=this;return t.handleOperation(async()=>await ir(t.fetch,`${t.url}/bucket`,{name:n},{headers:t.headers}))}async listBuckets(n){var t=this;return t.handleOperation(async()=>{const s=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&s.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&s.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&s.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&s.set("sortOrder",n.sortOrder),n!=null&&n.search&&s.set("search",n.search);const a=s.toString(),l=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return await Xi(t.fetch,l,{headers:t.headers})})}async deleteBucket(n){var t=this;return t.handleOperation(async()=>await id(t.fetch,`${t.url}/bucket/${n}`,{},{headers:t.headers}))}from(n){var t=this;if(!Sw(n))throw new Yo("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new bw({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(s,{get(l,u){const d=l[u];return typeof d!="function"?d:async(...f)=>{try{return{data:await d.apply(l,f),error:null}}catch(p){if(a)throw p;return{data:null,error:p}}}}})}},Uw=class extends ei{constructor(n,t={},s){const a=n.replace(/\/$/,""),l=je(je({},da),{},{"Content-Type":"application/json"},t);super(a,l,s,"vectors")}async createIndex(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/CreateIndex`,n,{headers:t.headers})||{})}async getIndex(n,t){var s=this;return s.handleOperation(async()=>await Dt.post(s.fetch,`${s.url}/GetIndex`,{vectorBucketName:n,indexName:t},{headers:s.headers}))}async listIndexes(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/ListIndexes`,n,{headers:t.headers}))}async deleteIndex(n,t){var s=this;return s.handleOperation(async()=>await Dt.post(s.fetch,`${s.url}/DeleteIndex`,{vectorBucketName:n,indexName:t},{headers:s.headers})||{})}},Mw=class extends ei{constructor(n,t={},s){const a=n.replace(/\/$/,""),l=je(je({},da),{},{"Content-Type":"application/json"},t);super(a,l,s,"vectors")}async putVectors(n){var t=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/PutVectors`,n,{headers:t.headers})||{})}async getVectors(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/GetVectors`,n,{headers:t.headers}))}async listVectors(n){var t=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/ListVectors`,n,{headers:t.headers}))}async queryVectors(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/QueryVectors`,n,{headers:t.headers}))}async deleteVectors(n){var t=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/DeleteVectors`,n,{headers:t.headers})||{})}},Fw=class extends ei{constructor(n,t={},s){const a=n.replace(/\/$/,""),l=je(je({},da),{},{"Content-Type":"application/json"},t);super(a,l,s,"vectors")}async createBucket(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:t.headers})||{})}async getBucket(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:n},{headers:t.headers}))}async listBuckets(n={}){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/ListVectorBuckets`,n,{headers:t.headers}))}async deleteBucket(n){var t=this;return t.handleOperation(async()=>await Dt.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:t.headers})||{})}},qw=class extends Fw{constructor(n,t={}){super(n,t.headers||{},t.fetch)}from(n){return new Bw(this.url,this.headers,n,this.fetch)}async createBucket(n){var t=()=>super.createBucket,s=this;return t().call(s,n)}async getBucket(n){var t=()=>super.getBucket,s=this;return t().call(s,n)}async listBuckets(n={}){var t=()=>super.listBuckets,s=this;return t().call(s,n)}async deleteBucket(n){var t=()=>super.deleteBucket,s=this;return t().call(s,n)}},Bw=class extends Uw{constructor(n,t,s,a){super(n,t,a),this.vectorBucketName=s}async createIndex(n){var t=()=>super.createIndex,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName}))}async listIndexes(n={}){var t=()=>super.listIndexes,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName}))}async getIndex(n){var t=()=>super.getIndex,s=this;return t().call(s,s.vectorBucketName,n)}async deleteIndex(n){var t=()=>super.deleteIndex,s=this;return t().call(s,s.vectorBucketName,n)}index(n){return new Vw(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},Vw=class extends Mw{constructor(n,t,s,a,l){super(n,t,l),this.vectorBucketName=s,this.indexName=a}async putVectors(n){var t=()=>super.putVectors,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async getVectors(n){var t=()=>super.getVectors,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async listVectors(n={}){var t=()=>super.listVectors,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async queryVectors(n){var t=()=>super.queryVectors,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async deleteVectors(n){var t=()=>super.deleteVectors,s=this;return t().call(s,je(je({},n),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}},Hw=class extends Dw{constructor(n,t={},s,a){super(n,t,s,a)}from(n){return new Lw(this.url,this.headers,n,this.fetch)}get vectors(){return new qw(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new zw(this.url+"/iceberg",this.headers,this.fetch)}};const ag="2.93.3",Cs=30*1e3,Lu=3,ou=Lu*Cs,Kw="http://localhost:9999",Ww="supabase.auth.token",Qw={"X-Client-Info":`gotrue-js/${ag}`},$u="X-Supabase-Api-Version",og={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Gw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jw=600*1e3;class Zi extends Error{constructor(t,s,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=a}}function pe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Yw extends Zi{constructor(t,s,a){super(t,s,a),this.name="AuthApiError",this.status=s,this.code=a}}function Xw(n){return pe(n)&&n.name==="AuthApiError"}class Ln extends Zi{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class zr extends Zi{constructor(t,s,a,l){super(t,a,l),this.name=s,this.status=a}}class $t extends zr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function lu(n){return pe(n)&&n.name==="AuthSessionMissingError"}class _s extends zr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class To extends zr{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Oo extends zr{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zw(n){return pe(n)&&n.name==="AuthImplicitGrantRedirectError"}class Bp extends zr{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eb extends zr{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Du extends zr{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function cu(n){return pe(n)&&n.name==="AuthRetryableFetchError"}class Vp extends zr{constructor(t,s,a){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=a}}class zu extends zr{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Vo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hp=` 	
\r=`.split(""),tb=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<Hp.length;t+=1)n[Hp[t].charCodeAt(0)]=-2;for(let t=0;t<Vo.length;t+=1)n[Vo[t].charCodeAt(0)]=t;return n})();function Kp(n,t,s){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Vo[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Vo[a]),t.queuedBits-=6}}function lg(n,t,s){const a=tb[n];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Wp(n){const t=[],s=d=>{t.push(String.fromCodePoint(d))},a={utf8seq:0,codepoint:0},l={queue:0,queuedBits:0},u=d=>{sb(d,a,s)};for(let d=0;d<n.length;d+=1)lg(n.charCodeAt(d),l,u);return t.join("")}function rb(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function nb(n,t){for(let s=0;s<n.length;s+=1){let a=n.charCodeAt(s);if(a>55295&&a<=56319){const l=(a-55296)*1024&65535;a=(n.charCodeAt(s+1)-56320&65535|l)+65536,s+=1}rb(a,t)}}function sb(n,t,s){if(t.utf8seq===0){if(n<=127){s(n);return}for(let a=1;a<6;a+=1)if((n>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function Ts(n){const t=[],s={queue:0,queuedBits:0},a=l=>{t.push(l)};for(let l=0;l<n.length;l+=1)lg(n.charCodeAt(l),s,a);return new Uint8Array(t)}function ib(n){const t=[];return nb(n,s=>t.push(s)),new Uint8Array(t)}function Dn(n){const t=[],s={queue:0,queuedBits:0},a=l=>{t.push(l)};return n.forEach(l=>Kp(l,s,a)),Kp(null,s,a),t.join("")}function ab(n){return Math.round(Date.now()/1e3)+n}function ob(){return Symbol("auth-callback")}const ct=()=>typeof window<"u"&&typeof document<"u",Tn={tested:!1,writable:!1},cg=()=>{if(!ct())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tn.tested)return Tn.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Tn.tested=!0,Tn.writable=!0}catch{Tn.tested=!0,Tn.writable=!1}return Tn.writable};function lb(n){const t={},s=new URL(n);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((l,u)=>{t[u]=l})}catch{}return s.searchParams.forEach((a,l)=>{t[l]=a}),t}const ug=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),cb=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Rs=async(n,t,s)=>{await n.setItem(t,JSON.stringify(s))},On=async(n,t)=>{const s=await n.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},lt=async(n,t)=>{await n.removeItem(t)};class Zo{constructor(){this.promise=new Zo.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}Zo.promiseConstructor=Promise;function Ao(n){const t=n.split(".");if(t.length!==3)throw new zu("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Gw.test(t[a]))throw new zu("JWT not in base64url format");return{header:JSON.parse(Wp(t[0])),payload:JSON.parse(Wp(t[1])),signature:Ts(t[2]),raw:{header:t[0],payload:t[1]}}}async function ub(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function db(n,t){return new Promise((a,l)=>{(async()=>{for(let u=0;u<1/0;u++)try{const d=await n(u);if(!t(u,null,d)){a(d);return}}catch(d){if(!t(u,d)){l(d);return}}})()})}function hb(n){return("0"+n.toString(16)).substr(-2)}function fb(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=s.length;let l="";for(let u=0;u<56;u++)l+=s.charAt(Math.floor(Math.random()*a));return l}return crypto.getRandomValues(t),Array.from(t,hb).join("")}async function pb(n){const s=new TextEncoder().encode(n),a=await crypto.subtle.digest("SHA-256",s),l=new Uint8Array(a);return Array.from(l).map(u=>String.fromCharCode(u)).join("")}async function mb(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const s=await pb(n);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function js(n,t,s=!1){const a=fb();let l=a;s&&(l+="/PASSWORD_RECOVERY"),await Rs(n,`${t}-code-verifier`,l);const u=await mb(a);return[u,a===u?"plain":"s256"]}const gb=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yb(n){const t=n.headers.get($u);if(!t||!t.match(gb))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function vb(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function xb(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const wb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ss(n){if(!wb.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function uu(){const n={};return new Proxy(n,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function bb(n,t){return new Proxy(n,{get:(s,a,l)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const u=a.toString();if(u==="Symbol(Symbol.toPrimitive)"||u==="Symbol(Symbol.toStringTag)"||u==="Symbol(util.inspect.custom)"||u==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,a,l)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(s,a,l)}})}function Qp(n){return JSON.parse(JSON.stringify(n))}const An=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_b=[502,503,504];async function Gp(n){var t;if(!cb(n))throw new Du(An(n),0);if(_b.includes(n.status))throw new Du(An(n),n.status);let s;try{s=await n.json()}catch(u){throw new Ln(An(u),u)}let a;const l=yb(n);if(l&&l.getTime()>=og["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?a=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(a=s.error_code),a){if(a==="weak_password")throw new Vp(An(s),n.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new $t}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((u,d)=>u&&typeof d=="string",!0))throw new Vp(An(s),n.status,s.weak_password.reasons);throw new Yw(An(s),n.status||500,a)}const jb=(n,t,s,a)=>{const l={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?l:(l.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),l.body=JSON.stringify(a),Object.assign(Object.assign({},l),s))};async function _e(n,t,s,a){var l;const u=Object.assign({},a==null?void 0:a.headers);u[$u]||(u[$u]=og["2024-01-01"].name),a!=null&&a.jwt&&(u.Authorization=`Bearer ${a.jwt}`);const d=(l=a==null?void 0:a.query)!==null&&l!==void 0?l:{};a!=null&&a.redirectTo&&(d.redirect_to=a.redirectTo);const f=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",p=await Sb(n,t,s+f,{headers:u,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(p):{data:Object.assign({},p),error:null}}async function Sb(n,t,s,a,l,u){const d=jb(t,a,l,u);let f;try{f=await n(s,Object.assign({},d))}catch(p){throw console.error(p),new Du(An(p),0)}if(f.ok||await Gp(f),a!=null&&a.noResolveJson)return f;try{return await f.json()}catch(p){await Gp(p)}}function sr(n){var t;let s=null;Eb(n)&&(s=Object.assign({},n),n.expires_at||(s.expires_at=ab(n.expires_in)));const a=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:s,user:a},error:null}}function Jp(n){const t=sr(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0)&&(t.data.weak_password=n.weak_password),t}function on(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function Nb(n){return{data:n,error:null}}function kb(n){const{action_link:t,email_otp:s,hashed_token:a,redirect_to:l,verification_type:u}=n,d=Jo(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:t,email_otp:s,hashed_token:a,redirect_to:l,verification_type:u},p=Object.assign({},d);return{data:{properties:f,user:p},error:null}}function Yp(n){return n}function Eb(n){return n.access_token&&n.refresh_token&&n.expires_in}const du=["global","local","others"];class Cb{constructor({url:t="",headers:s={},fetch:a}){this.url=t,this.headers=s,this.fetch=ug(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,s=du[0]){if(du.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${du.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(pe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,s={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:on})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:s}=t,a=Jo(t,["options"]),l=Object.assign(Object.assign({},a),s);return"newEmail"in a&&(l.new_email=a==null?void 0:a.newEmail,delete l.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:l,headers:this.headers,xform:kb,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(pe(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:on})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,a,l,u,d,f,p;try{const g={nextPage:null,lastPage:0,total:0},y=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:"",per_page:(u=(l=t==null?void 0:t.perPage)===null||l===void 0?void 0:l.toString())!==null&&u!==void 0?u:""},xform:Yp});if(y.error)throw y.error;const x=await y.json(),w=(d=y.headers.get("x-total-count"))!==null&&d!==void 0?d:0,b=(p=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(S.split(";")[1].split("=")[1]);g[`${j}Page`]=_}),g.total=parseInt(w)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(pe(g))return{data:{users:[]},error:g};throw g}}async getUserById(t){Ss(t);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:on})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){Ss(t);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:on})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,s=!1){Ss(t);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:on})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Ss(t.userId);try{const{data:s,error:a}=await _e(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:s,error:a}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _deleteFactor(t){Ss(t.userId),Ss(t.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _listOAuthClients(t){var s,a,l,u,d,f,p;try{const g={nextPage:null,lastPage:0,total:0},y=await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:"",per_page:(u=(l=t==null?void 0:t.perPage)===null||l===void 0?void 0:l.toString())!==null&&u!==void 0?u:""},xform:Yp});if(y.error)throw y.error;const x=await y.json(),w=(d=y.headers.get("x-total-count"))!==null&&d!==void 0?d:0,b=(p=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(S.split(";")[1].split("=")[1]);g[`${j}Page`]=_}),g.total=parseInt(w)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(pe(g))return{data:{clients:[]},error:g};throw g}}async _createOAuthClient(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _getOAuthClient(t){try{return await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _updateOAuthClient(t,s){try{return await _e(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:s,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(pe(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await _e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}}function Xp(n={}){return{getItem:t=>n[t]||null,setItem:(t,s)=>{n[t]=s},removeItem:t=>{delete n[t]}}}const Ns={debug:!!(globalThis&&cg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dg extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Rb extends dg{}async function Pb(n,t,s){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async l=>{if(l){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,l.name);try{return await s()}finally{Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,l.name)}}else{if(t===0)throw Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Rb(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Ns.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function Tb(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function hg(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function Ob(n){return parseInt(n,16)}function Ab(n){const t=new TextEncoder().encode(n);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function Ib(n){var t;const{chainId:s,domain:a,expirationTime:l,issuedAt:u=new Date,nonce:d,notBefore:f,requestId:p,resources:g,scheme:y,uri:x,version:w}=n;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(d&&d.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${d}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(w!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${w}`);if(!((t=n.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const b=hg(n.address),S=y?`${y}://${a}`:a,_=n.statement?`${n.statement}
`:"",j=`${S} wants you to sign in with your Ethereum account:
${b}

${_}`;let N=`URI: ${x}
Version: ${w}
Chain ID: ${s}${d?`
Nonce: ${d}`:""}
Issued At: ${u.toISOString()}`;if(l&&(N+=`
Expiration Time: ${l.toISOString()}`),f&&(N+=`
Not Before: ${f.toISOString()}`),p&&(N+=`
Request ID: ${p}`),g){let A=`
Resources:`;for(const T of g){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);A+=`
- ${T}`}N+=A}return`${j}
${N}`}class Je extends Error{constructor({message:t,code:s,cause:a,name:l}){var u;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(u=l!=null?l:a instanceof Error?a.name:void 0)!==null&&u!==void 0?u:"Unknown Error",this.code=s}}class Ho extends Je{constructor(t,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:t}),this.name="WebAuthnUnknownError",this.originalError=s}}function Lb({error:n,options:t}){var s,a,l;const{publicKey:u}=t;if(!u)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Je({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((s=u.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Je({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(t.mediation==="conditional"&&((a=u.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Je({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((l=u.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Je({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Je({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Je({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return u.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new Je({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Je({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const d=window.location.hostname;if(fg(d)){if(u.rp.id!==d)return new Je({message:`The RP ID "${u.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(u.user.id.byteLength<1||u.user.id.byteLength>64)return new Je({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function $b({error:n,options:t}){const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Je({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Je({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(fg(a)){if(s.rpId!==a)return new Je({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class Db{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const zb=new Db;function Ub(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:t,user:s,excludeCredentials:a}=n,l=Jo(n,["challenge","user","excludeCredentials"]),u=Ts(t).buffer,d=Object.assign(Object.assign({},s),{id:Ts(s.id).buffer}),f=Object.assign(Object.assign({},l),{challenge:u,user:d});if(a&&a.length>0){f.excludeCredentials=new Array(a.length);for(let p=0;p<a.length;p++){const g=a[p];f.excludeCredentials[p]=Object.assign(Object.assign({},g),{id:Ts(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return f}function Mb(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:t,allowCredentials:s}=n,a=Jo(n,["challenge","allowCredentials"]),l=Ts(t).buffer,u=Object.assign(Object.assign({},a),{challenge:l});if(s&&s.length>0){u.allowCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];u.allowCredentials[d]=Object.assign(Object.assign({},f),{id:Ts(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function Fb(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const s=n;return{id:n.id,rawId:n.id,response:{attestationObject:Dn(new Uint8Array(n.response.attestationObject)),clientDataJSON:Dn(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function qb(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const s=n,a=n.getClientExtensionResults(),l=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Dn(new Uint8Array(l.authenticatorData)),clientDataJSON:Dn(new Uint8Array(l.clientDataJSON)),signature:Dn(new Uint8Array(l.signature)),userHandle:l.userHandle?Dn(new Uint8Array(l.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fg(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Zp(){var n,t;return!!(ct()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Bb(n){try{const t=await navigator.credentials.create(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ho("Browser returned unexpected credential type",t)}:{data:null,error:new Ho("Empty credential response",t)}}catch(t){return{data:null,error:Lb({error:t,options:n})}}}async function Vb(n){try{const t=await navigator.credentials.get(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ho("Browser returned unexpected credential type",t)}:{data:null,error:new Ho("Empty credential response",t)}}catch(t){return{data:null,error:$b({error:t,options:n})}}}const Hb={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Kb={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ko(...n){const t=l=>l!==null&&typeof l=="object"&&!Array.isArray(l),s=l=>l instanceof ArrayBuffer||ArrayBuffer.isView(l),a={};for(const l of n)if(l)for(const u in l){const d=l[u];if(d!==void 0)if(Array.isArray(d))a[u]=d;else if(s(d))a[u]=d;else if(t(d)){const f=a[u];t(f)?a[u]=Ko(f,d):a[u]=Ko(d)}else a[u]=d}return a}function Wb(n,t){return Ko(Hb,n,t||{})}function Qb(n,t){return Ko(Kb,n,t||{})}class Gb{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:s,friendlyName:a,signal:l},u){var d;try{const{data:f,error:p}=await this.client.mfa.challenge({factorId:t,webauthn:s});if(!f)return{data:null,error:p};const g=l!=null?l:zb.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:y}=f.webauthn.credential_options.publicKey;if(!y.name){const x=a;if(x)y.name=`${y.id}:${x}`;else{const b=(await this.client.getUser()).data.user,S=((d=b==null?void 0:b.user_metadata)===null||d===void 0?void 0:d.name)||(b==null?void 0:b.email)||(b==null?void 0:b.id)||"User";y.name=`${y.id}:${S}`}}y.displayName||(y.displayName=y.name)}switch(f.webauthn.type){case"create":{const y=Wb(f.webauthn.credential_options.publicKey,u==null?void 0:u.create),{data:x,error:w}=await Bb({publicKey:y,signal:g});return x?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:x}},error:null}:{data:null,error:w}}case"request":{const y=Qb(f.webauthn.credential_options.publicKey,u==null?void 0:u.request),{data:x,error:w}=await Vb(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:y,signal:g}));return x?{data:{factorId:t,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:x}},error:null}:{data:null,error:w}}}}catch(f){return pe(f)?{data:null,error:f}:{data:null,error:new Ln("Unexpected error in challenge",f)}}}async _verify({challengeId:t,factorId:s,webauthn:a}){return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:l}={}},u){if(!s)return{data:null,error:new Zi("rpId is required for WebAuthn authentication")};try{if(!Zp())return{data:null,error:new Ln("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this.challenge({factorId:t,webauthn:{rpId:s,rpOrigins:a},signal:l},{request:u});if(!d)return{data:null,error:f};const{webauthn:p}=d;return this._verify({factorId:t,challengeId:d.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:a,credential_response:p.credential_response}})}catch(d){return pe(d)?{data:null,error:d}:{data:null,error:new Ln("Unexpected error in authenticate",d)}}}async _register({friendlyName:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:l}={}},u){if(!s)return{data:null,error:new Zi("rpId is required for WebAuthn registration")};try{if(!Zp())return{data:null,error:new Ln("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this._enroll({friendlyName:t});if(!d)return await this.client.mfa.listFactors().then(y=>{var x;return(x=y.data)===null||x===void 0?void 0:x.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===t&&w.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y==null?void 0:y.id}):void 0),{data:null,error:f};const{data:p,error:g}=await this._challenge({factorId:d.id,friendlyName:d.friendly_name,webauthn:{rpId:s,rpOrigins:a},signal:l},{create:u});return p?this._verify({factorId:d.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:a,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:g}}catch(d){return pe(d)?{data:null,error:d}:{data:null,error:new Ln("Unexpected error in register",d)}}}}Tb();const Jb={url:Kw,storageKey:Ww,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function em(n,t,s){return await s()}const ks={};class ea{get jwks(){var t,s;return(s=(t=ks[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){ks[this.storageKey]=Object.assign(Object.assign({},ks[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=ks[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ks[this.storageKey]=Object.assign(Object.assign({},ks[this.storageKey]),{cachedAt:t})}constructor(t){var s,a,l;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const u=Object.assign(Object.assign({},Jb),t);if(this.storageKey=u.storageKey,this.instanceID=(s=ea.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ea.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!u.debug,typeof u.debug=="function"&&(this.logger=u.debug),this.instanceID>0&&ct()){const d=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(d),this.logDebugMessages&&console.trace(d)}if(this.persistSession=u.persistSession,this.autoRefreshToken=u.autoRefreshToken,this.admin=new Cb({url:u.url,headers:u.headers,fetch:u.fetch}),this.url=u.url,this.headers=u.headers,this.fetch=ug(u.fetch),this.lock=u.lock||em,this.detectSessionInUrl=u.detectSessionInUrl,this.flowType=u.flowType,this.hasCustomAuthorizationHeader=u.hasCustomAuthorizationHeader,this.throwOnError=u.throwOnError,this.lockAcquireTimeout=u.lockAcquireTimeout,u.lock?this.lock=u.lock:this.persistSession&&ct()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=Pb:this.lock=em,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Gb(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(u.storage?this.storage=u.storage:cg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xp(this.memoryStorage)),u.userStorage&&(this.userStorage=u.userStorage)):(this.memoryStorage={},this.storage=Xp(this.memoryStorage)),ct()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(d){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",d)}(l=this.broadcastChannel)===null||l===void 0||l.addEventListener("message",async d=>{this._debug("received broadcast notification from other tab or client",d);try{await this._notifyAllSubscribers(d.data.event,d.data.session,!1)}catch(f){this._debug("#broadcastChannel","error",f)}})}this.initialize().catch(d=>{this._debug("#initialize()","error",d)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${ag}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let s={},a="none";if(ct()&&(s=lb(window.location.href),this._isImplicitGrantCallback(s)?a="implicit":await this._isPKCECallback(s)&&(a="pkce")),ct()&&this.detectSessionInUrl&&a!=="none"){const{data:l,error:u}=await this._getSessionFromURL(s,a);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),Zw(u)){const p=(t=u.details)===null||t===void 0?void 0:t.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:u}}return{error:u}}const{session:d,redirectType:f}=l;return this._debug("#_initialize()","detected session in URL",d,"redirect type",f),await this._saveSession(d),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return pe(s)?this._returnResult({error:s}):this._returnResult({error:new Ln("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,a,l;try{const u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(l=t==null?void 0:t.options)===null||l===void 0?void 0:l.captchaToken}},xform:sr}),{data:d,error:f}=u;if(f||!d)return this._returnResult({data:{user:null,session:null},error:f});const p=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(u){if(pe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signUp(t){var s,a,l;try{let u;if("email"in t){const{email:y,password:x,options:w}=t;let b=null,S=null;this.flowType==="pkce"&&([b,S]=await js(this.storage,this.storageKey)),u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w==null?void 0:w.emailRedirectTo,body:{email:y,password:x,data:(s=w==null?void 0:w.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken},code_challenge:b,code_challenge_method:S},xform:sr})}else if("phone"in t){const{phone:y,password:x,options:w}=t;u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:x,data:(a=w==null?void 0:w.data)!==null&&a!==void 0?a:{},channel:(l=w==null?void 0:w.channel)!==null&&l!==void 0?l:"sms",gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken}},xform:sr})}else throw new To("You must provide either an email or phone number and a password");const{data:d,error:f}=u;if(f||!d)return await lt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:f});const p=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(u){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithPassword(t){try{let s;if("email"in t){const{email:u,password:d,options:f}=t;s=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Jp})}else if("phone"in t){const{phone:u,password:d,options:f}=t;s=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Jp})}else throw new To("You must provide either an email or phone number and a password");const{data:a,error:l}=s;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a||!a.session||!a.user){const u=new _s;return this._returnResult({data:{user:null,session:null},error:u})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:l})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(t){var s,a,l,u;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:(u=t.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;switch(s){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(t){var s,a,l,u,d,f,p,g,y,x,w;let b,S;if("message"in t)b=t.message,S=t.signature;else{const{chain:_,wallet:j,statement:N,options:A}=t;let T;if(ct())if(typeof j=="object")T=j;else{const ce=window;if("ethereum"in ce&&typeof ce.ethereum=="object"&&"request"in ce.ethereum&&typeof ce.ethereum.request=="function")T=ce.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=j}const $=new URL((s=A==null?void 0:A.url)!==null&&s!==void 0?s:window.location.href),K=await T.request({method:"eth_requestAccounts"}).then(ce=>ce).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!K||K.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const J=hg(K[0]);let Z=(a=A==null?void 0:A.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!Z){const ce=await T.request({method:"eth_chainId"});Z=Ob(ce)}const se={domain:$.host,address:J,statement:N,uri:$.href,version:"1",chainId:Z,nonce:(l=A==null?void 0:A.signInWithEthereum)===null||l===void 0?void 0:l.nonce,issuedAt:(d=(u=A==null?void 0:A.signInWithEthereum)===null||u===void 0?void 0:u.issuedAt)!==null&&d!==void 0?d:new Date,expirationTime:(f=A==null?void 0:A.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(p=A==null?void 0:A.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(g=A==null?void 0:A.signInWithEthereum)===null||g===void 0?void 0:g.requestId,resources:(y=A==null?void 0:A.signInWithEthereum)===null||y===void 0?void 0:y.resources};b=Ib(se),S=await T.request({method:"personal_sign",params:[Ab(b),J]})}try{const{data:_,error:j}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:S},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(w=t.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:sr});if(j)throw j;if(!_||!_.session||!_.user){const N=new _s;return this._returnResult({data:{user:null,session:null},error:N})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:j})}catch(_){if(pe(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(t){var s,a,l,u,d,f,p,g,y,x,w,b;let S,_;if("message"in t)S=t.message,_=t.signature;else{const{chain:j,wallet:N,statement:A,options:T}=t;let $;if(ct())if(typeof N=="object")$=N;else{const J=window;if("solana"in J&&typeof J.solana=="object"&&("signIn"in J.solana&&typeof J.solana.signIn=="function"||"signMessage"in J.solana&&typeof J.solana.signMessage=="function"))$=J.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");$=N}const K=new URL((s=T==null?void 0:T.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in $&&$.signIn){const J=await $.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),A?{statement:A}:null));let Z;if(Array.isArray(J)&&J[0]&&typeof J[0]=="object")Z=J[0];else if(J&&typeof J=="object"&&"signedMessage"in J&&"signature"in J)Z=J;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Z&&"signature"in Z&&(typeof Z.signedMessage=="string"||Z.signedMessage instanceof Uint8Array)&&Z.signature instanceof Uint8Array)S=typeof Z.signedMessage=="string"?Z.signedMessage:new TextDecoder().decode(Z.signedMessage),_=Z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in $)||typeof $.signMessage!="function"||!("publicKey"in $)||typeof $!="object"||!$.publicKey||!("toBase58"in $.publicKey)||typeof $.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${K.host} wants you to sign in with your Solana account:`,$.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(l=(a=T==null?void 0:T.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date().toISOString()}`,...!((u=T==null?void 0:T.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((d=T==null?void 0:T.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((f=T==null?void 0:T.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((p=T==null?void 0:T.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((g=T==null?void 0:T.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((x=(y=T==null?void 0:T.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||x===void 0)&&x.length?["Resources",...T.signInWithSolana.resources.map(Z=>`- ${Z}`)]:[]].join(`
`);const J=await $.signMessage(new TextEncoder().encode(S),"utf8");if(!J||!(J instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=J}}try{const{data:j,error:N}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Dn(_)},!((w=t.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:sr});if(N)throw N;if(!j||!j.session||!j.user){const A=new _s;return this._returnResult({data:{user:null,session:null},error:A})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:N})}catch(j){if(pe(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(t){const s=await On(this.storage,`${this.storageKey}-code-verifier`),[a,l]=(s!=null?s:"").split("/");try{if(!a&&this.flowType==="pkce")throw new eb;const{data:u,error:d}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:sr});if(await lt(this.storage,`${this.storageKey}-code-verifier`),d)throw d;if(!u||!u.session||!u.user){const f=new _s;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:Object.assign(Object.assign({},u),{redirectType:l!=null?l:null}),error:d})}catch(u){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(u))return this._returnResult({data:{user:null,session:null,redirectType:null},error:u});throw u}}async signInWithIdToken(t){try{const{options:s,provider:a,token:l,access_token:u,nonce:d}=t,f=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:l,access_token:u,nonce:d,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:sr}),{data:p,error:g}=f;if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!p||!p.session||!p.user){const y=new _s;return this._returnResult({data:{user:null,session:null},error:y})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:g})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(t){var s,a,l,u,d;try{if("email"in t){const{email:f,options:p}=t;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await js(this.storage,this.storageKey));const{error:x}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},create_user:(a=p==null?void 0:p.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:y},redirectTo:p==null?void 0:p.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:f,options:p}=t,{data:g,error:y}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(l=p==null?void 0:p.data)!==null&&l!==void 0?l:{},create_user:(u=p==null?void 0:p.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(d=p==null?void 0:p.channel)!==null&&d!==void 0?d:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:g==null?void 0:g.message_id},error:y})}throw new To("You must provide either an email or phone number.")}catch(f){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(t){var s,a;try{let l,u;"options"in t&&(l=(s=t.options)===null||s===void 0?void 0:s.redirectTo,u=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:d,error:f}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:u}}),redirectTo:l,xform:sr});if(f)throw f;if(!d)throw new Error("An error occurred on token verification.");const p=d.session,g=d.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:g,session:p},error:null})}catch(l){if(pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithSSO(t){var s,a,l,u,d;try{let f=null,p=null;this.flowType==="pkce"&&([f,p]=await js(this.storage,this.storageKey));const g=await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&a!==void 0?a:void 0}),!((l=t==null?void 0:t.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:p}),headers:this.headers,xform:Nb});return!((u=g.data)===null||u===void 0)&&u.url&&ct()&&!(!((d=t.options)===null||d===void 0)&&d.skipBrowserRedirect)&&window.location.assign(g.data.url),this._returnResult(g)}catch(f){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;if(a)throw a;if(!s)throw new $t;const{error:l}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:l})})}catch(t){if(pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:a,type:l,options:u}=t,{error:d}=await _e(this.fetch,"POST",s,{headers:this.headers,body:{email:a,type:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}else if("phone"in t){const{phone:a,type:l,options:u}=t,{data:d,error:f}=await _e(this.fetch,"POST",s,{headers:this.headers,body:{phone:a,type:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f})}throw new To("You must provide either an email or phone number and a type")}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await a,await s()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=s();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await On(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<ou:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const d=await On(this.userStorage,this.storageKey+"-user");d!=null&&d.user?t.user=d.user:t.user=uu()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const d={value:this.suppressGetSessionWarning};t.user=bb(t.user,d),d.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:l,error:u}=await this._callRefreshToken(t.refresh_token);return u?this._returnResult({data:{session:null},error:u}):this._returnResult({data:{session:l},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const s=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(t){try{return t?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:on}):await this._useSession(async s=>{var a,l,u;const{data:d,error:f}=s;if(f)throw f;return!(!((a=d.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new $t}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0,xform:on})})}catch(s){if(pe(s))return lu(s)&&(await this._removeSession(),await lt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async a=>{const{data:l,error:u}=a;if(u)throw u;if(!l.session)throw new $t;const d=l.session;let f=null,p=null;this.flowType==="pkce"&&t.email!=null&&([f,p]=await js(this.storage,this.storageKey));const{data:g,error:y}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:f,code_challenge_method:p}),jwt:d.access_token,xform:on});if(y)throw y;return d.user=g.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),this._returnResult({data:{user:d.user},error:null})})}catch(a){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new $t;const s=Date.now()/1e3;let a=s,l=!0,u=null;const{payload:d}=Ao(t.access_token);if(d.exp&&(a=d.exp,l=a<=s),l){const{data:f,error:p}=await this._callRefreshToken(t.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!f)return{data:{user:null,session:null},error:null};u=f}else{const{data:f,error:p}=await this._getUser(t.access_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});u={access_token:t.access_token,refresh_token:t.refresh_token,user:f.user,token_type:"bearer",expires_in:a-s,expires_at:a},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return this._returnResult({data:{user:u.user,session:u},error:null})}catch(s){if(pe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var a;if(!t){const{data:d,error:f}=s;if(f)throw f;t=(a=d.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new $t;const{data:l,error:u}=await this._callRefreshToken(t.refresh_token);return u?this._returnResult({data:{user:null,session:null},error:u}):l?this._returnResult({data:{user:l.user,session:l},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(t,s){try{if(!ct())throw new Oo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Oo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Bp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Oo("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Bp("No code detected.");const{data:A,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:l,access_token:u,refresh_token:d,expires_in:f,expires_at:p,token_type:g}=t;if(!u||!f||!d||!g)throw new Oo("No session defined in URL");const y=Math.round(Date.now()/1e3),x=parseInt(f);let w=y+x;p&&(w=parseInt(p));const b=w-y;b*1e3<=Cs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const S=w-x;y-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,w,y):y-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,w,y);const{data:_,error:j}=await this._getUser(u);if(j)throw j;const N={provider_token:a,provider_refresh_token:l,access_token:u,expires_in:x,expires_at:w,refresh_token:d,token_type:g,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:t.type},error:null})}catch(a){if(pe(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await On(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var a;const{data:l,error:u}=s;if(u&&!lu(u))return this._returnResult({error:u});const d=(a=l.session)===null||a===void 0?void 0:a.access_token;if(d){const{error:f}=await this.admin.signOut(d,t);if(f&&!(Xw(f)&&(f.status===404||f.status===401||f.status===403)||lu(f)))return this._returnResult({error:f})}return t!=="others"&&(await this._removeSession(),await lt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const s=ob(),a={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async s=>{var a,l;try{const{data:{session:u},error:d}=s;if(d)throw d;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",t,"session",u)}catch(u){await((l=this.stateChangeEmitters.get(t))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",u),console.error(u)}})}async resetPasswordForEmail(t,s={}){let a=null,l=null;this.flowType==="pkce"&&([a,l]=await js(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:l,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(u){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(u))return this._returnResult({data:null,error:u});throw u}}async getUserIdentities(){var t;try{const{data:s,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var s;try{const{data:a,error:l}=await this._useSession(async u=>{var d,f,p,g,y;const{data:x,error:w}=u;if(w)throw w;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(f=t.options)===null||f===void 0?void 0:f.scopes,queryParams:(p=t.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",b,{headers:this.headers,jwt:(y=(g=x.session)===null||g===void 0?void 0:g.access_token)!==null&&y!==void 0?y:void 0})});if(l)throw l;return ct()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(pe(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async s=>{var a;try{const{error:l,data:{session:u}}=s;if(l)throw l;const{options:d,provider:f,token:p,access_token:g,nonce:y}=t,x=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=u==null?void 0:u.access_token)!==null&&a!==void 0?a:void 0,body:{provider:f,id_token:p,access_token:g,nonce:y,link_identity:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:sr}),{data:w,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!w||!w.session||!w.user?this._returnResult({data:{user:null,session:null},error:new _s}):(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("USER_UPDATED",w.session)),this._returnResult({data:w,error:b}))}catch(l){if(await lt(this.storage,`${this.storageKey}-code-verifier`),pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}})}async unlinkIdentity(t){try{return await this._useSession(async s=>{var a,l;const{data:u,error:d}=s;if(d)throw d;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(l=(a=u.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const a=Date.now();return await db(async l=>(l>0&&await ub(200*Math.pow(2,l-1)),this._debug(s,"refreshing attempt",l),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:sr})),(l,u)=>{const d=200*Math.pow(2,l);return u&&cu(u)&&Date.now()+d-a<Cs})}catch(a){if(this._debug(s,"error",a),pe(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",a),ct()&&!s.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,s;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const l=await On(this.storage,this.storageKey);if(l&&this.userStorage){let d=await On(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:l.user},await Rs(this.userStorage,this.storageKey+"-user",d)),l.user=(t=d==null?void 0:d.user)!==null&&t!==void 0?t:uu()}else if(l&&!l.user&&!l.user){const d=await On(this.storage,this.storageKey+"-user");d&&(d!=null&&d.user)?(l.user=d.user,await lt(this.storage,this.storageKey+"-user"),await Rs(this.storage,this.storageKey,l)):l.user=uu()}if(this._debug(a,"session from storage",l),!this._isValidSession(l)){this._debug(a,"session is not valid"),l!==null&&await this._removeSession();return}const u=((s=l.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<ou;if(this._debug(a,`session has${u?"":" not"} expired with margin of ${ou}s`),u){if(this.autoRefreshToken&&l.refresh_token){const{error:d}=await this._callRefreshToken(l.refresh_token);d&&(console.error(d),cu(d)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:f}=await this._getUser(l.access_token);!f&&(d!=null&&d.user)?(l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(a,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(a,"error",l),console.error(l);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var s,a;if(!t)throw new $t;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new Zo;const{data:u,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!u.session)throw new $t;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const f={data:u.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(u){if(this._debug(l,"error",u),pe(u)){const d={data:null,error:u};return cu(u)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(d),d}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(u),u}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(t,s,a=!0){const l=`#_notifyAllSubscribers(${t})`;this._debug(l,"begin",s,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:s});const u=[],d=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(t,s)}catch(p){u.push(p)}});if(await Promise.all(d),u.length>0){for(let f=0;f<u.length;f+=1)console.error(u[f]);throw u[0]}}finally{this._debug(l,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await lt(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},t),a=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&s.user&&await Rs(this.userStorage,this.storageKey+"-user",{user:s.user});const l=Object.assign({},s);delete l.user;const u=Qp(l);await Rs(this.storage,this.storageKey,u)}else{const l=Qp(s);await Rs(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await lt(this.storage,this.storageKey),await lt(this.storage,this.storageKey+"-code-verifier"),await lt(this.storage,this.storageKey+"-user"),this.userStorage&&await lt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ct()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Cs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const s=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const s=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,s&&clearTimeout(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:a}}=s;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((a.expires_at*1e3-t)/Cs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${Cs}ms, refresh threshold is ${Lu} ticks`),l<=Lu&&await this._callRefreshToken(a.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof dg)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ct()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,a){const l=[`provider=${encodeURIComponent(s)}`];if(a!=null&&a.redirectTo&&l.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&l.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[u,d]=await js(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(d)}`});l.push(f.toString())}if(a!=null&&a.queryParams){const u=new URLSearchParams(a.queryParams);l.push(u.toString())}return a!=null&&a.skipBrowserRedirect&&l.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${l.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var a;const{data:l,error:u}=s;return u?this._returnResult({data:null,error:u}):await _e(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(t){try{return await this._useSession(async s=>{var a,l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:p,error:g}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(a=u==null?void 0:u.session)===null||a===void 0?void 0:a.access_token});return g?this._returnResult({data:null,error:g}):(t.factorType==="totp"&&p.type==="totp"&&(!((l=p==null?void 0:p.totp)===null||l===void 0)&&l.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var a;const{data:l,error:u}=s;if(u)return this._returnResult({data:null,error:u});const d=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Fb(t.webauthn.credential_response):qb(t.webauthn.credential_response)})}:{code:t.code}),{data:f,error:p}=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:d,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:p}))})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var a;const{data:l,error:u}=s;if(u)return this._returnResult({data:null,error:u});const d=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});if(d.error)return d;const{data:f}=d;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:Ub(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:Mb(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(t){const{data:s,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){var t;const{data:{user:s},error:a}=await this.getUser();if(a)return{data:null,error:a};const l={all:[],phone:[],totp:[],webauthn:[]};for(const u of(t=s==null?void 0:s.factors)!==null&&t!==void 0?t:[])l.all.push(u),u.status==="verified"&&l[u.factor_type].push(u);return{data:l,error:null}}async _getAuthenticatorAssuranceLevel(t){var s,a,l,u;if(t)try{const{payload:b}=Ao(t);let S=null;b.aal&&(S=b.aal);let _=S;const{data:{user:j},error:N}=await this.getUser(t);if(N)return this._returnResult({data:null,error:N});((a=(s=j==null?void 0:j.factors)===null||s===void 0?void 0:s.filter($=>$.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(_="aal2");const T=b.amr||[];return{data:{currentLevel:S,nextLevel:_,currentAuthenticationMethods:T},error:null}}catch(b){if(pe(b))return this._returnResult({data:null,error:b});throw b}const{data:{session:d},error:f}=await this.getSession();if(f)return this._returnResult({data:null,error:f});if(!d)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:p}=Ao(d.access_token);let g=null;p.aal&&(g=p.aal);let y=g;((u=(l=d.user.factors)===null||l===void 0?void 0:l.filter(b=>b.status==="verified"))!==null&&u!==void 0?u:[]).length>0&&(y="aal2");const w=p.amr||[];return{data:{currentLevel:g,nextLevel:y,currentAuthenticationMethods:w},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;return l?this._returnResult({data:null,error:l}):a?await _e(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new $t})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(t,s){try{return await this._useSession(async a=>{const{data:{session:l},error:u}=a;if(u)return this._returnResult({data:null,error:u});if(!l)return this._returnResult({data:null,error:new $t});const d=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&ct()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(d.data.redirect_url),d})}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,s){try{return await this._useSession(async a=>{const{data:{session:l},error:u}=a;if(u)return this._returnResult({data:null,error:u});if(!l)return this._returnResult({data:null,error:new $t});const d=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&ct()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(d.data.redirect_url),d})}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;return a?this._returnResult({data:null,error:a}):s?await _e(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new $t})})}catch(t){if(pe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;return l?this._returnResult({data:null,error:l}):a?(await _e(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new $t})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(t,s={keys:[]}){let a=s.keys.find(f=>f.kid===t);if(a)return a;const l=Date.now();if(a=this.jwks.keys.find(f=>f.kid===t),a&&this.jwks_cached_at+Jw>l)return a;const{data:u,error:d}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=l,a=u.keys.find(f=>f.kid===t),!a)?null:a}async getClaims(t,s={}){try{let a=t;if(!a){const{data:b,error:S}=await this.getSession();if(S||!b.session)return this._returnResult({data:null,error:S});a=b.session.access_token}const{header:l,payload:u,signature:d,raw:{header:f,payload:p}}=Ao(a);s!=null&&s.allowExpired||vb(u.exp);const g=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!g){const{error:b}=await this.getUser(a);if(b)throw b;return{data:{claims:u,header:l,signature:d},error:null}}const y=xb(l.alg),x=await crypto.subtle.importKey("jwk",g,y,!0,["verify"]);if(!await crypto.subtle.verify(y,x,d,ib(`${f}.${p}`)))throw new zu("Invalid JWT signature");return{data:{claims:u,header:l,signature:d},error:null}}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}}ea.nextInstanceID={};const Yb=ea,Xb="2.93.3";let Hi="";typeof Deno<"u"?Hi="deno":typeof document<"u"?Hi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hi="react-native":Hi="node";const Zb={"X-Client-Info":`supabase-js-${Hi}/${Xb}`},e_={headers:Zb},t_={schema:"public"},r_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},n_={};function ta(n){"@babel/helpers - typeof";return ta=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ta(n)}function s_(n,t){if(ta(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var a=s.call(n,t);if(ta(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function i_(n){var t=s_(n,"string");return ta(t)=="symbol"?t:t+""}function a_(n,t,s){return(t=i_(t))in n?Object.defineProperty(n,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[t]=s,n}function tm(n,t){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),s.push.apply(s,a)}return s}function He(n){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?tm(Object(s),!0).forEach(function(a){a_(n,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):tm(Object(s)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(s,a))})}return n}const o_=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),l_=()=>Headers,c_=(n,t,s)=>{const a=o_(s),l=l_();return async(u,d)=>{var f;const p=(f=await t())!==null&&f!==void 0?f:n;let g=new l(d==null?void 0:d.headers);return g.has("apikey")||g.set("apikey",n),g.has("Authorization")||g.set("Authorization",`Bearer ${p}`),a(u,He(He({},d),{},{headers:g}))}};function u_(n){return n.endsWith("/")?n:n+"/"}function d_(n,t){var s,a;const{db:l,auth:u,realtime:d,global:f}=n,{db:p,auth:g,realtime:y,global:x}=t,w={db:He(He({},p),l),auth:He(He({},g),u),realtime:He(He({},y),d),storage:{},global:He(He(He({},x),f),{},{headers:He(He({},(s=x==null?void 0:x.headers)!==null&&s!==void 0?s:{}),(a=f==null?void 0:f.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return n.accessToken?w.accessToken=n.accessToken:delete w.accessToken,w}function h_(n){const t=n==null?void 0:n.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(u_(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var f_=class extends Yb{constructor(n){super(n)}},p_=class{constructor(n,t,s){var a,l;this.supabaseUrl=n,this.supabaseKey=t;const u=h_(n);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:t_,realtime:n_,auth:He(He({},r_),{},{storageKey:d}),global:e_},p=d_(s!=null?s:{},f);if(this.storageKey=(a=p.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken)this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(y,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var g;this.auth=this._initSupabaseAuthClient((g=p.auth)!==null&&g!==void 0?g:{},this.headers,p.global.fetch)}this.fetch=c_(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(He({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(y=>this.realtime.setAuth(y)).catch(y=>console.warn("Failed to set initial Realtime auth token:",y)),this.rest=new Xx(new URL("rest/v1",u).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new Hw(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new Wx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,t={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,t,s)}channel(n,t={config:{}}){return this.realtime.channel(n,t)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,t,s;if(n.accessToken)return await n.accessToken();const{data:a}=await n.auth.getSession();return(t=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&t!==void 0?t:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:t,detectSessionInUrl:s,storage:a,userStorage:l,storageKey:u,flowType:d,lock:f,debug:p,throwOnError:g},y,x){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new f_({url:this.authUrl.href,headers:He(He({},w),y),storageKey:u,autoRefreshToken:n,persistSession:t,detectSessionInUrl:s,storage:a,userStorage:l,flowType:d,lock:f,debug:p,throwOnError:g,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new mw(this.realtimeUrl.href,He(He({},n),{},{params:He(He({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(n,t,s){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const m_=(n,t,s)=>new p_(n,t,s);function g_(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const t=n.version;if(t==null)return!1;const s=t.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}g_()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();const y_="https://fdvvtriqhyfwzckkixkw.supabase.co",v_="sb_publishable_RW7ioU08Gsdq3v7y_qM_XQ_iKIwglJc",x_=()=>m_(y_,v_,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1}}),ue=x_(),pg=E.createContext(void 0);function w_({children:n}){const[t,s]=E.useState(null),[a,l]=E.useState(null),[u,d]=E.useState(null),[f,p]=E.useState(!0),g=E.useRef(null),y=E.useRef(null),x=E.useRef(!1),w=N=>{g.current=N,d(N)},b=async(N,A=1e4,T=3)=>{if(g.current&&g.current.id===N)return g.current;console.log(`Auth: Fetching profile for ${N} (timeout: ${A}ms, retries: ${T})...`);try{const $=new Promise((se,ce)=>setTimeout(()=>ce(new Error("Profile fetch timeout")),A)),K=ue.from("profiles").select("*").eq("id",N).maybeSingle(),{data:J,error:Z}=await Promise.race([K,$]);if(Z)throw console.error("Auth: Error fetching profile:",Z),Z;return console.log("Auth: Profile fetched successfully"),J}catch($){return console.error("Auth: fetchProfile caught error:",$),T>0?(console.log("Auth: Retrying profile fetch in 1s..."),await new Promise(K=>setTimeout(K,1e3)),b(N,A,T-1)):(console.error("Auth: All profile fetch retries failed."),null)}};E.useEffect(()=>{let N=!0;const A=setTimeout(()=>{N&&f&&(console.warn("Auth: Safety timer triggered (20s). Forcing load completion."),p(!1))},2e4),{data:{subscription:T}}=ue.auth.onAuthStateChange(async($,K)=>{var te;const J=$;if(!N)return;y.current=K;const Z=x.current,se=!!g.current;(Z||J==="INITIAL_SESSION")&&(K==null?void 0:K.user)&&!se&&p(!0);const U=(te=K==null?void 0:K.user)!=null?te:null;if(l(K),s(U),U){const he=Z?1e4:5e3,q=Z?3:1;console.log(`Auth: Handling event ${J}. Manual Login: ${Z}. Strategy: ${he}ms timeout.`);const re=await b(U.id,he,q);if(N){if(w(re),x.current=!1,!re&&Z){console.error("Auth: CRITICAL - Manual login successful but Profile fetch failed."),console.error("Auth: Enforcing Logout to ensure clean state."),_();return}!re&&!Z&&console.warn("Auth: Auto-restore profile fetch failed. Session kept but profile is null.")}}else N&&w(null);N&&p(!1)});return()=>{N=!1,clearTimeout(A),T.unsubscribe()}},[]);const S=async(N,A)=>{x.current=!0;const{error:T}=await ue.auth.signInWithPassword({email:N,password:A});return T&&(x.current=!1),{error:T}},_=async()=>{s(null),l(null),d(null);try{await ue.auth.signOut()}catch(N){console.error("Auth: Error signing out (background):",N)}},j={user:t,session:a,profile:u,loading:f,signIn:S,signOut:_,isAdmin:(u==null?void 0:u.role)==="admin"};return i.jsx(pg.Provider,{value:j,children:n})}function vr(){const n=E.useContext(pg);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mg=(...n)=>n.filter((t,s,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===s).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var __={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=E.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:l="",children:u,iconNode:d,...f},p)=>E.createElement("svg",{ref:p,...__,width:t,height:t,stroke:n,strokeWidth:a?Number(s)*24/Number(t):s,className:mg("lucide",l),...f},[...d.map(([g,y])=>E.createElement(g,y)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=(n,t)=>{const s=E.forwardRef(({className:a,...l},u)=>E.createElement(j_,{ref:u,iconNode:t,className:mg(`lucide-${b_(n)}`,a),...l}));return s.displayName=`${n}`,s};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=we("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=we("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=we("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=we("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=we("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=we("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=we("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=we("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=we("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=we("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=we("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=we("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=we("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=we("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=we("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=we("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=we("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=we("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=we("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=we("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=we("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=we("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=we("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=we("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=we("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=we("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=we("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=we("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=we("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=we("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=we("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=we("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=we("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=we("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=we("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=we("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=we("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=we("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=we("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=we("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=we("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=we("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=we("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=we("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=we("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=we("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=we("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=we("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=we("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=we("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=we("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=we("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function z_(){const{signOut:n,profile:t,isAdmin:s}=vr(),a=Jt(),l=cr(),[u,d]=E.useState(!1),[f]=E.useState(!1),p=async()=>{await n(),a("/login")},g=()=>d(!u),x=[{to:"/",icon:i.jsx(T_,{size:20}),label:"Dashboard"},{to:"/sales",icon:i.jsx(Ws,{size:20}),label:"Ventas"},{to:"/shipping",icon:i.jsx(Lr,{size:20}),label:"Envos"},{to:"/products",icon:i.jsx(Wt,{size:20}),label:"Inventario"},{to:"/customers",icon:i.jsx(Wo,{size:20}),label:"Clientes"},{to:"/suppliers",icon:i.jsx(Wo,{size:20}),label:"Proveedores",adminOnly:!0},{to:"/purchases",icon:i.jsx(Qs,{size:20}),label:"Compras",adminOnly:!0},{to:"/cash",icon:i.jsx(Ks,{size:20}),label:"Caja Diaria",adminOnly:!0},{to:"/reports",icon:i.jsx(S_,{size:20}),label:"Reportes",adminOnly:!0},{to:"/users",icon:i.jsx(sm,{size:20}),label:"Usuarios",adminOnly:!0}].filter(w=>!w.adminOnly||s);return i.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden font-sans",children:[u&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 lg:hidden backdrop-blur-sm",onClick:()=>d(!1)}),i.jsxs("aside",{className:`
          fixed lg:static inset-y-0 left-0 z-30
          bg-white border-r border-gray-200 shadow-xl lg:shadow-none
          transition-all duration-300 ease-in-out flex flex-col
          ${u?"translate-x-0 w-64":"-translate-x-full lg:translate-x-0"}
          ${f?"lg:w-20":"lg:w-64"}
        `,children:[i.jsxs("div",{className:`h-20 flex items-center ${f?"justify-center":"px-6 gap-3"} border-b border-gray-100 bg-brand-peach/20`,children:[i.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm flex-shrink-0 p-1",children:i.jsx("img",{src:"/logos/logo-bw.jpg",alt:"Logo",className:"w-full h-full object-contain rounded-full"})}),!f&&i.jsxs("div",{children:[i.jsx("h1",{className:"font-serif font-bold text-lg text-primary-700 leading-tight",children:"Sophi Shoes"}),i.jsx("p",{className:"text-xs text-secondary-600 font-medium tracking-wide",children:"POS System"})]})]}),i.jsx("nav",{className:"flex-1 overflow-y-auto py-6 px-3 space-y-1",children:x.map(w=>i.jsxs(zm,{to:w.to,onClick:()=>d(!1),className:({isActive:b})=>`
                flex items-center gap-3 px-3 py-3 rounded-xl transition-all duration-200 group
                ${b?"bg-primary-50 text-primary-700 shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-primary-600"}
                ${f?"justify-center":""}
              `,title:f?w.label:"",children:[i.jsx("span",{className:`transition-transform duration-200 ${f?"":"group-hover:scale-110"}`,children:w.icon}),!f&&i.jsx("span",{className:"font-medium",children:w.label}),!f&&l.pathname===w.to&&i.jsx(vg,{size:16,className:"ml-auto opacity-50"})]},w.to))}),i.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50/50",children:i.jsxs("div",{className:`flex items-center gap-3 ${f?"justify-center flex-col":""}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-secondary-100 text-secondary-600 flex items-center justify-center flex-shrink-0",children:i.jsx(sm,{size:24})}),!f&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-semibold text-gray-800 truncate",children:(t==null?void 0:t.full_name)||"Usuario"}),i.jsx("p",{className:"text-xs text-gray-500 capitalize truncate",children:(t==null?void 0:t.role)||"Vendedor"})]}),i.jsx("button",{onClick:p,className:`p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors ${f?"mt-2":""}`,title:"Cerrar Sesin",children:i.jsx(L_,{size:20})})]})})]}),i.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-brand-peach/5",children:[i.jsx("header",{className:"lg:hidden h-16 bg-white border-b border-gray-200 flex items-center justify-between px-4 sticky top-0 z-10 shadow-sm",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:g,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:i.jsx($_,{size:24})}),i.jsx("h1",{className:"font-serif font-bold text-lg text-primary-700",children:"Sophi Shoes"})]})}),i.jsx("div",{className:"h-4 lg:block hidden"}),i.jsx("main",{className:"flex-1 overflow-auto p-4 lg:p-8",children:i.jsx("div",{className:"max-w-7xl mx-auto animate-fade-in",children:i.jsx(kv,{})})})]})]})}function U_(){const[n,t]=E.useState(""),[s,a]=E.useState(""),[l,u]=E.useState(null),[d,f]=E.useState(!1),{signIn:p}=vr(),g=Jt(),y=async x=>{x.preventDefault(),f(!0),u(null);try{const{error:w}=await p(n,s);if(w)throw w;g("/")}catch(w){u(w instanceof Error?w.message:"Error al iniciar sesin")}finally{f(!1)}};return i.jsx("div",{className:"min-h-screen bg-brand-peach flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl overflow-hidden border border-white/50",children:[i.jsxs("div",{className:"bg-brand-peach/50 p-8 text-center relative overflow-hidden ring-1 ring-primary-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-secondary-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg p-2",children:i.jsx("img",{src:"/logos/logo-peach.jpg",alt:"Sophi Shoes",className:"w-full h-full object-contain rounded-full"})}),i.jsx("h1",{className:"text-3xl font-serif font-bold text-primary-600",children:"Sophi Shoes"}),i.jsx("p",{className:"text-primary-800 mt-2 font-medium",children:"Sistema de Gestin"})]})]}),i.jsxs("div",{className:"p-8",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6 text-center",children:"Bienvenido de nuevo"}),i.jsxs("form",{onSubmit:y,className:"space-y-4",children:[l&&i.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-600 text-sm animate-pulse",children:[i.jsx(N_,{size:18}),l]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Correo Electrnico"}),i.jsx("input",{type:"email",value:n,onChange:x=>t(x.target.value),className:"form-input bg-gray-50 focus:bg-white",placeholder:"usuario@ejemplo.com",required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Contrasea"}),i.jsx("input",{type:"password",value:s,onChange:x=>a(x.target.value),className:"form-input bg-gray-50 focus:bg-white",placeholder:"",required:!0})]}),i.jsx("button",{type:"submit",disabled:d,className:"w-full btn-primary py-3 flex items-center justify-center gap-2 shadow-lg shadow-primary-500/30 hover:shadow-primary-600/40",children:d?i.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsxs(i.Fragment,{children:[i.jsx(I_,{size:20}),"Ingresar"]})})]}),i.jsxs("div",{className:"mt-8 text-center text-xs text-gray-400",children:[" ",new Date().getFullYear()," Sophi Shoes"]})]})]})})}function M_(){const{profile:n,isAdmin:t}=vr(),s=[{to:"/sales/new",icon:i.jsx(Ws,{size:24}),label:"Nueva Venta",description:"Registrar venta rpida",color:"bg-green-500",visible:!0},{to:"/products",icon:i.jsx(Wt,{size:24}),label:"Productos",description:"Ver inventario",color:"bg-blue-500",visible:!0},{to:"/purchases/new",icon:i.jsx(Qs,{size:24}),label:"Nueva Compra",description:"Registrar entrada",color:"bg-purple-500",visible:t},{to:"/suppliers",icon:i.jsx(Wo,{size:24}),label:"Proveedores",description:"Gestionar proveedores",color:"bg-orange-500",visible:t},{to:"/cash",icon:i.jsx(Ks,{size:24}),label:"Caja Diaria",description:"Ver resumen del da",color:"bg-emerald-500",visible:!0},{to:"/sales",icon:i.jsx(qu,{size:24}),label:"Historial",description:"Ver todas las ventas",color:"bg-indigo-500",visible:!0}].filter(a=>a.visible);return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"card bg-gradient-to-r from-primary-600 to-primary-800 text-white border-none shadow-lg shadow-primary-900/20",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold",children:["Hola, ",(n==null?void 0:n.full_name)||"Usuario","! "]}),i.jsx("p",{className:"text-primary-100 mt-1",children:"Bienvenido al sistema de inventario de Sophi Shoes"})]}),i.jsx("div",{className:"hidden sm:block",children:i.jsx("span",{className:"text-5xl",children:""})})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Tu rol:"}),i.jsx("span",{className:`badge ${t?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:t?" Administrador":" Vendedor"})]}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Acciones Rpidas"}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(a=>i.jsx(wt,{to:a.to,className:"card hover:shadow-lg transition-all duration-200 group",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-12 h-12 ${a.color} rounded-xl flex items-center justify-center text-white group-hover:scale-110 transition-transform`,children:a.icon}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-800",children:a.label}),i.jsx("p",{className:"text-sm text-gray-500",children:a.description})]})]})},a.to))})]}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Resumen del Da"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Ventas Hoy"}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"$0"})]}),i.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:i.jsx(Ks,{className:"text-green-600",size:20})})]})}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Transacciones"}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"0"})]}),i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(Ws,{className:"text-blue-600",size:20})})]})}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Productos"}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"0"})]}),i.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:i.jsx(Wt,{className:"text-purple-600",size:20})})]})}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Stock Bajo"}),i.jsx("p",{className:"text-2xl font-bold text-gray-800",children:"0"})]}),i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:i.jsx(ra,{className:"text-red-600",size:20})})]})})]})]})]})}function F_(){const[n,t]=E.useState(""),s=Tt(),{data:a=[],isLoading:l}=Ke({queryKey:["suppliers"],queryFn:async()=>{const{data:f,error:p}=await ue.from("suppliers").select("*").order("name");if(p)throw p;return f}}),u=Pt({mutationFn:async({id:f,isActive:p})=>{const{error:g}=await ue.from("suppliers").update({is_active:p,updated_at:new Date().toISOString()}).eq("id",f);if(g)throw g},onSuccess:()=>{s.invalidateQueries({queryKey:["suppliers"]})}}),d=a.filter(f=>{var p;return f.name.toLowerCase().includes(n.toLowerCase())||((p=f.contact_name)==null?void 0:p.toLowerCase().includes(n.toLowerCase()))});return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Proveedores"}),i.jsx("p",{className:"text-gray-500",children:"Gestiona los fabricantes y proveedores de calzado"})]}),i.jsxs(wt,{to:"/suppliers/new",className:"btn-primary flex items-center gap-2 w-fit",children:[i.jsx(mt,{size:20}),"Nuevo Proveedor"]})]}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"relative",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar por nombre o contacto...",value:n,onChange:f=>t(f.target.value),className:"form-input pl-10"})]})}),l?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando proveedores..."})]}):d.length===0?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx(Mu,{className:"mx-auto text-gray-300",size:48}),i.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-800",children:"No hay proveedores"}),i.jsx("p",{className:"text-gray-500 mt-1",children:n?"No se encontraron proveedores con ese criterio":"Comienza agregando tu primer proveedor"}),!n&&i.jsxs(wt,{to:"/suppliers/new",className:"btn-primary mt-4 inline-flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Agregar Proveedor"]})]}):i.jsx("div",{className:"grid gap-4",children:d.map(f=>i.jsx("div",{className:`card hover:shadow-md transition-shadow ${f.is_active?"":"opacity-60"}`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(Mu,{className:"text-primary-600",size:24})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold text-gray-800",children:f.name}),!f.is_active&&i.jsx("span",{className:"badge-warning",children:"Inactivo"})]}),f.contact_name&&i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Contacto: ",f.contact_name]}),i.jsxs("div",{className:"flex flex-wrap gap-4 mt-2 text-sm text-gray-500",children:[f.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ld,{size:14}),f.phone]}),f.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(od,{size:14}),f.email]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 sm:flex-shrink-0",children:[i.jsx("button",{onClick:()=>u.mutate({id:f.id,isActive:!f.is_active}),className:`btn text-sm ${f.is_active?"btn-secondary":"btn-success"}`,children:f.is_active?"Desactivar":"Activar"}),i.jsxs(wt,{to:`/suppliers/${f.id}`,className:"btn-primary flex items-center gap-2",children:[i.jsx(ud,{size:16}),"Editar"]})]})]})},f.id))})]})}function im(){const{id:n}=ca(),t=Jt(),s=Tt(),a=!!n,[l,u]=E.useState({name:"",contact_name:"",phone:"",email:"",address:"",notes:"",is_active:!0}),[d,f]=E.useState(null),{data:p,isLoading:g}=Ke({queryKey:["supplier",n],queryFn:async()=>{if(!n)return null;const{data:b,error:S}=await ue.from("suppliers").select("*").eq("id",n).single();if(S)throw S;return b},enabled:a});E.useEffect(()=>{p&&u({name:p.name,contact_name:p.contact_name||"",phone:p.phone||"",email:p.email||"",address:p.address||"",notes:p.notes||"",is_active:p.is_active})},[p]);const y=Pt({mutationFn:async b=>{if(a&&n){const{error:S}=await ue.from("suppliers").update({...b,updated_at:new Date().toISOString()}).eq("id",n);if(S)throw S}else{const{error:S}=await ue.from("suppliers").insert(b);if(S)throw S}},onSuccess:()=>{s.invalidateQueries({queryKey:["suppliers"]}),t("/suppliers")},onError:b=>{f(b.message)}}),x=b=>{if(b.preventDefault(),f(null),!l.name.trim()){f("El nombre es requerido");return}y.mutate(l)},w=b=>{const{name:S,value:_,type:j}=b.target;u(N=>({...N,[S]:j==="checkbox"?b.target.checked:_}))};return a&&g?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando proveedor..."})]}):i.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t("/suppliers"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ti,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Proveedor":"Nuevo Proveedor"}),i.jsx("p",{className:"text-gray-500",children:a?"Modifica los datos del proveedor":"Agrega un nuevo proveedor al sistema"})]})]}),i.jsxs("form",{onSubmit:x,className:"card space-y-6",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-2xl flex items-center justify-center",children:i.jsx(Mu,{className:"text-primary-600",size:40})})}),d&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:d}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Nombre del Proveedor *"}),i.jsx("input",{id:"name",name:"name",type:"text",value:l.name,onChange:w,className:"form-input",placeholder:"Ej: Calzado Colombia S.A.S",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_name",className:"form-label",children:"Nombre del Contacto"}),i.jsx("input",{id:"contact_name",name:"contact_name",type:"text",value:l.contact_name||"",onChange:w,className:"form-input",placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",className:"form-label",children:"Telfono"}),i.jsx("input",{id:"phone",name:"phone",type:"tel",value:l.phone||"",onChange:w,className:"form-input",placeholder:"Ej: +57 300 123 4567"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",className:"form-label",children:"Correo Electrnico"}),i.jsx("input",{id:"email",name:"email",type:"email",value:l.email||"",onChange:w,className:"form-input",placeholder:"Ej: contacto@proveedor.com"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",className:"form-label",children:"Direccin"}),i.jsx("input",{id:"address",name:"address",type:"text",value:l.address||"",onChange:w,className:"form-input",placeholder:"Ej: Calle 123 #45-67, Bogot"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"notes",className:"form-label",children:"Notas"}),i.jsx("textarea",{id:"notes",name:"notes",value:l.notes||"",onChange:w,className:"form-input min-h-[100px]",placeholder:"Informacin adicional sobre el proveedor..."})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{id:"is_active",name:"is_active",type:"checkbox",checked:l.is_active,onChange:w,className:"w-5 h-5 rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),i.jsx("label",{htmlFor:"is_active",className:"text-sm text-gray-700",children:"Proveedor activo"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>t("/suppliers"),className:"btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:y.isPending,className:"btn-primary flex items-center gap-2",children:y.isPending?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner w-4 h-4 border-white/30 border-t-white"}),"Guardando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ha,{size:20}),a?"Actualizar":"Guardar"]})})]})]})]})}function As(n,t,s){if(!n||!n.length)return;const a=Object.keys(n[0]),l=[a.join(","),...n.map(f=>a.map(p=>{const g=f[p]===null||f[p]===void 0?"":f[p],y=String(g).replace(/"/g,'""');return y.includes(",")||y.includes('"')||y.includes(`
`)?`"${y}"`:y}).join(","))].join(`
`),u=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a");if(d.download!==void 0){const f=URL.createObjectURL(u);d.setAttribute("href",f),d.setAttribute("download",`${t}_${new Date().toISOString().split("T")[0]}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)}}function q_(n){const t={};return n.forEach(s=>{const a=s.color||"Sin Color";t[a]||(t[a]={color:a,sizes:[],totalStock:0,image_url:s.image_url,skus:[]}),t[a].sizes.includes(s.size)||t[a].sizes.push(s.size),t[a].totalStock+=s.stock||0,s.sku&&!t[a].skus.includes(s.sku)&&t[a].skus.push(s.sku),s.image_url&&!t[a].image_url&&(t[a].image_url=s.image_url)}),Object.values(t).map(s=>({...s,sizes:s.sizes.sort((a,l)=>{const u=parseInt(a),d=parseInt(l);return!isNaN(u)&&!isNaN(d)?u-d:a.localeCompare(l)})}))}function B_(){const{isAdmin:n}=vr(),[t,s]=E.useState(""),[a,l]=E.useState(null),{data:u=[],isLoading:d}=Ke({queryKey:["products"],queryFn:async()=>{const{data:y,error:x}=await ue.from("products").select(`
          *,
          supplier:suppliers(id, name),
          variants:product_variants(*)
        `).order("name");if(x)throw x;return y}}),f=u.filter(y=>{var x;return y.name.toLowerCase().includes(t.toLowerCase())||((x=y.category)==null?void 0:x.toLowerCase().includes(t.toLowerCase()))}),p=y=>{var x;return((x=y.variants)==null?void 0:x.reduce((w,b)=>w+b.stock,0))||0},g=y=>(y.variants||[]).some(x=>x.stock<=(x.min_stock||5));return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Productos"}),i.jsx("p",{className:"text-gray-500",children:"Gestiona el catlogo de calzado e inventario"})]}),i.jsxs("div",{className:"flex items-center gap-2 w-fit",children:[n&&i.jsxs("button",{onClick:()=>{const y=u.flatMap(x=>(x.variants||[]).map(w=>{var b;return{Producto:x.name,Categora:x.category||"",Talla:w.size,Color:w.color,SKU:w.sku||"",Costo:w.cost,Precio:w.price,Stock:w.stock,"Stock Mn":w.min_stock||0,Proveedor:((b=x.supplier)==null?void 0:b.name)||"",Estado:x.is_active?"Activo":"Inactivo"}}));As(y,"inventario_sophi_shoes")},className:"btn-secondary flex items-center gap-2",children:[i.jsx(Os,{size:20}),"Exportar"]}),n&&i.jsxs(wt,{to:"/products/new",className:"btn-primary flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Nuevo Producto"]})]})]}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"relative",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar por nombre o categora...",value:t,onChange:y=>s(y.target.value),className:"form-input pl-10"})]})}),d?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando productos..."})]}):f.length===0?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx(Wt,{className:"mx-auto text-gray-300",size:48}),i.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-800",children:"No hay productos"}),i.jsx("p",{className:"text-gray-500 mt-1",children:t?"No se encontraron productos con ese criterio":"Comienza agregando tu primer producto"}),!t&&n&&i.jsxs(wt,{to:"/products/new",className:"btn-primary mt-4 inline-flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Agregar Producto"]})]}):i.jsx("div",{className:"space-y-4",children:f.map(y=>{var x;return i.jsxs("div",{className:`card transition-shadow ${y.is_active?"":"opacity-60"}`,children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[y.image_url?i.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden flex-shrink-0 border border-gray-100 shadow-sm",children:i.jsx("img",{src:y.image_url,alt:y.name,className:"w-full h-full object-cover"})}):i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(Wt,{className:"text-blue-600",size:28})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold text-gray-800",children:y.name}),!y.is_active&&i.jsx("span",{className:"badge-warning",children:"Inactivo"}),g(y)&&i.jsxs("span",{className:"badge-error flex items-center gap-1",children:[i.jsx(ra,{size:12}),"Stock Bajo"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[y.category&&i.jsx("span",{className:"badge-info",children:y.category}),y.supplier&&i.jsxs("span",{className:"text-sm text-gray-500",children:["Proveedor: ",y.supplier.name]})]}),i.jsxs("div",{className:"flex gap-4 mt-2 text-sm",children:[i.jsxs("span",{className:"text-gray-600",children:[i.jsx("strong",{children:((x=y.variants)==null?void 0:x.length)||0})," variantes"]}),i.jsxs("span",{className:`font-medium ${p(y)>0?"text-green-600":"text-red-600"}`,children:["Stock: ",p(y)]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>l(a===y.id?null:y.id),className:"btn-secondary flex items-center gap-2",children:a===y.id?i.jsxs(i.Fragment,{children:[i.jsx(tl,{size:16}),"Ocultar"]}):i.jsxs(i.Fragment,{children:[i.jsx(el,{size:16}),"Ver Variantes"]})}),n&&i.jsxs(wt,{to:`/products/${y.id}`,className:"btn-primary flex items-center gap-2",children:[i.jsx(ud,{size:16}),"Editar"]})]})]}),a===y.id&&y.variants&&y.variants.length>0&&i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Variantes"}),i.jsx("div",{className:"table-container",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"w-12",children:"Foto"}),i.jsx("th",{children:"Color"}),i.jsx("th",{children:"Tallas"}),i.jsx("th",{className:"text-right",children:"Stock Total"}),i.jsx("th",{className:"text-right",children:"Precio"})]})}),i.jsx("tbody",{children:q_(y.variants).map((w,b)=>{var S,_;return i.jsxs("tr",{children:[i.jsx("td",{children:w.image_url?i.jsx("img",{src:w.image_url,alt:"",className:"w-10 h-10 rounded object-cover border"}):i.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center",children:i.jsx(yg,{size:16,className:"text-gray-400"})})}),i.jsx("td",{className:"font-semibold text-gray-800",children:w.color}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-wrap gap-1",children:w.sizes.map(j=>i.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-xs border border-gray-200",children:j},j))})}),i.jsx("td",{className:"text-right",children:i.jsx("span",{className:`font-bold ${w.totalStock>0?"text-green-600":"text-red-600"}`,children:w.totalStock})}),i.jsxs("td",{className:"text-right font-medium",children:["$",(((_=(S=y.variants)==null?void 0:S[0])==null?void 0:_.price)||0).toLocaleString()]})]},b)})})]})})]}),a===y.id&&(!y.variants||y.variants.length===0)&&i.jsx("div",{className:"mt-4 pt-4 border-t text-center py-4",children:i.jsx("p",{className:"text-gray-500 text-sm",children:"Este producto no tiene variantes registradas"})})]},y.id)})})]})}async function V_(n,t=1024,s=.7){return new Promise((a,l)=>{const u=new FileReader;u.readAsDataURL(n),u.onload=d=>{var p;const f=new Image;f.src=(p=d.target)==null?void 0:p.result,f.onload=()=>{const g=document.createElement("canvas");let y=f.width,x=f.height;y>x?y>t&&(x*=t/y,y=t):x>t&&(y*=t/x,x=t),g.width=y,g.height=x;const w=g.getContext("2d");w==null||w.drawImage(f,0,0,y,x),g.toBlob(b=>{b?a(b):l(new Error("Canvas to Blob failed"))},"image/jpeg",s)}},u.onerror=d=>l(d)})}async function H_(n,t,s){try{console.log(`Storage: Resizing and uploading ${s.name}...`);const a=await V_(s),l=`${Math.random().toString(36).substring(2)}_${Date.now()}.jpg`,u=`${t}/${l}`,{error:d}=await ue.storage.from(n).upload(u,a,{contentType:"image/jpeg",upsert:!0});if(d)throw console.error("Storage: Upload error detail:",d),d;const{data:{publicUrl:f}}=ue.storage.from(n).getPublicUrl(u);return f}catch(a){return console.error("Error uploading image:",a),window.alert(`Error al subir imagen: ${a.message||"Error desconocido"}. Asegrate de que el bucket "products" sea pblico en tu panel de Supabase.`),null}}function am({value:n,onChange:t,bucket:s="products",path:a="images",label:l="Imagen"}){const[u,d]=E.useState(!1),f=async g=>{var y;try{const x=(y=g.target.files)==null?void 0:y[0];if(!x)return;d(!0);const w=await H_(s,a,x);w&&t(w)}catch(x){console.error("Error in handleFileChange:",x)}finally{d(!1)}},p=async()=>{t(null)};return i.jsxs("div",{className:"space-y-2",children:[l&&i.jsx("label",{className:"text-xs font-medium text-gray-500",children:l}),i.jsx("div",{className:"relative group w-full aspect-square bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 overflow-hidden flex items-center justify-center",children:n?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:n,alt:"Preview",className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),i.jsx("button",{type:"button",onClick:p,className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(Wn,{size:14})})]}):i.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-2 p-4 text-center",children:[u?i.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:i.jsx(yg,{className:"text-gray-400",size:20})}),i.jsx("span",{className:"text-xs text-gray-400",children:"Clic para subir foto"})]}),i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:f,disabled:u})]})})]})}function om(){const{id:n}=ca(),t=Jt(),s=Tt(),a=!!n,[l,u]=E.useState({name:"",description:"",category:"",sku:"",supplier_id:null,is_active:!0,image_url:null}),[d,f]=E.useState([]),[p,g]=E.useState(null),[y,x]=E.useState(0),[w,b]=E.useState(0),S=y>0?((w-y)/y*100).toFixed(1):"0",[_,j]=E.useState(""),{data:N=[]}=Ke({queryKey:["suppliers-active"],queryFn:async()=>{const{data:q}=await ue.from("suppliers").select("id, name").eq("is_active",!0).order("name");return q}}),{data:A=[]}=Ke({queryKey:["categories"],queryFn:async()=>{const{data:q,error:re}=await ue.from("categories").select("id, name").order("name");return re?(console.error("Error fetching categories:",re),[]):q!=null?q:[]}}),{data:T,isLoading:$}=Ke({queryKey:["product",n],queryFn:async()=>{if(!n)return null;const{data:q,error:re}=await ue.from("products").select("*, variants:product_variants(*)").eq("id",n).single();if(re)throw re;return q},enabled:a});E.useEffect(()=>{T&&(u({name:T.name,description:T.description||"",category:T.category||"",sku:T.sku||"",supplier_id:T.supplier_id,is_active:T.is_active,image_url:T.image_url||null}),T.variants&&T.variants.length>0&&(x(T.variants[0].cost||0),b(T.variants[0].price||0),f(T.variants.map(q=>({id:q.id,size:q.size,color:q.color,sku:q.sku||"",stock:q.stock,min_stock:q.min_stock,image_url:q.image_url||null})))))},[T]);const K=(q,re)=>{const ee=q.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),me=Math.floor(1e3+Math.random()*9e3).toString();return`${ee}-${me}`},J=Pt({mutationFn:async()=>{let q=n;if(a&&n){const re={...l,updated_at:new Date().toISOString()};re.sku||(re.sku=K(l.name));const{error:ee}=await ue.from("products").update(re).eq("id",n);if(ee)throw ee}else{const re={...l};re.sku||(re.sku=K(l.name));const{data:ee,error:me}=await ue.from("products").insert(re).select("id").single();if(me)throw me;q=ee.id}if(q){const re=d.filter(ee=>ee.id).map(ee=>ee.id);if(a&&(T!=null&&T.variants)){const ee=T.variants.filter(me=>!re.includes(me.id));for(const me of ee)await ue.from("product_variants").delete().eq("id",me.id)}for(const ee of d){let me=ee.sku;me||(me=`${l.sku||"PROD"}-${ee.size}-${ee.color.toUpperCase().substring(0,3)}`);const B={product_id:q,size:ee.size,color:ee.color,sku:me,cost:y,price:w,stock:ee.stock,min_stock:ee.min_stock,image_url:ee.image_url||null};ee.id?await ue.from("product_variants").update({...B,updated_at:new Date().toISOString()}).eq("id",ee.id):await ue.from("product_variants").insert(B)}}},onSuccess:()=>{s.invalidateQueries({queryKey:["products"]}),t("/products")},onError:q=>{g(q.message)}}),Z=q=>{if(q.preventDefault(),g(null),!l.name.trim()){g("El nombre del producto es requerido");return}J.mutate()},se=q=>{const{name:re,value:ee,type:me}=q.target;u(B=>({...B,[re]:me==="checkbox"?q.target.checked:ee||null}))},ce=()=>{f(q=>{let re="35";if(q.length>0){const ee=q[q.length-1].size,me=parseInt(ee);isNaN(me)||(re=(me+1).toString())}return[...q,{size:re,color:"",sku:"",stock:0,min_stock:0,image_url:null}]})},U=()=>{const q=l.category==="Caballero",re=35,ee=q?43:40,me=_.split(",").map(z=>z.trim()).filter(z=>z!=="");me.length===0&&me.push("");const B=[];for(const z of me)for(let W=re;W<=ee;W++)B.push({size:W.toString(),color:z,sku:"",stock:0,min_stock:0,image_url:null});f(B)},te=(q,re,ee)=>{f(me=>{var z;const B=me[q];if(!B)return me;if(re==="color"&&typeof ee=="string"){const W=ee.trim(),Q=(z=me.find(P=>P.color.toLowerCase()===W.toLowerCase()&&P.image_url))==null?void 0:z.image_url;return me.map((P,M)=>M===q?{...P,color:ee,image_url:Q||P.image_url}:P)}return re==="image_url"&&B.color?me.map(W=>W.color.toLowerCase()===B.color.toLowerCase()?{...W,image_url:ee}:W):me.map((W,Q)=>Q===q?{...W,[re]:ee}:W)})},he=q=>{f(re=>re.filter((ee,me)=>me!==q))};return a&&$?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando producto..."})]}):i.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t("/products"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ti,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Producto":"Nuevo Producto"}),i.jsx("p",{className:"text-gray-500",children:a?"Modifica los datos del producto":"Agrega un nuevo producto al catlogo"})]})]}),i.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[i.jsxs("div",{className:"card space-y-6",children:[i.jsxs("div",{className:"flex justify-center gap-8",children:[i.jsx("div",{className:"flex-1 max-w-[200px]",children:i.jsx(am,{value:l.image_url,onChange:q=>u(re=>({...re,image_url:q})),path:"products",label:"Foto del Producto"})}),i.jsxs("div",{className:"flex flex-col justify-center",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mb-2",children:i.jsx(Wt,{className:"text-blue-600",size:32})}),i.jsx("p",{className:"text-xs text-gray-400 max-w-[150px]",children:"Esta ser la foto principal del catlogo."})]})]}),p&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:p}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"form-group sm:col-span-2",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Nombre del Producto *"}),i.jsx("input",{id:"name",name:"name",type:"text",value:l.name,onChange:se,className:"form-input",placeholder:"Ej: Bota Elegante Cuero",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"sku",className:"form-label",children:"SKU (Opcional)"}),i.jsx("input",{id:"sku",name:"sku",type:"text",value:l.sku||"",onChange:se,className:"form-input",placeholder:"Auto-generado"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"category",className:"form-label",children:"Categora"}),i.jsxs("select",{id:"category",name:"category",value:l.category||"",onChange:se,className:"form-select",children:[i.jsx("option",{value:"",children:"Seleccionar categora..."}),A.map(q=>i.jsx("option",{value:q.name,children:q.name},q.id))]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"supplier_id",className:"form-label",children:"Proveedor"}),i.jsxs("select",{id:"supplier_id",name:"supplier_id",value:l.supplier_id||"",onChange:se,className:"form-select",children:[i.jsx("option",{value:"",children:"Seleccionar proveedor..."}),N.map(q=>i.jsx("option",{value:q.id,children:q.name},q.id))]})]})]}),i.jsxs("div",{className:"p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200",children:[i.jsx("h3",{className:"text-sm font-semibold text-emerald-800 mb-3",children:" Precios (aplica a todas las variantes)"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Costo $"}),i.jsx("input",{type:"number",value:y,onChange:q=>x(Number(q.target.value)),className:"form-input",min:"0",step:"1000",placeholder:"0"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Precio Venta $"}),i.jsx("input",{type:"number",value:w,onChange:q=>b(Number(q.target.value)),className:"form-input",min:"0",step:"1000",placeholder:"0"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Margen de Ganancia"}),i.jsxs("div",{className:`form-input bg-gray-100 flex items-center justify-center font-bold text-lg ${Number(S)>=30?"text-emerald-600":Number(S)>=15?"text-amber-600":"text-red-600"}`,children:[S,"%"]})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Descripcin"}),i.jsx("textarea",{id:"description",name:"description",value:l.description||"",onChange:se,className:"form-input min-h-[80px]",placeholder:"Descripcin del producto..."})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{id:"is_active",name:"is_active",type:"checkbox",checked:l.is_active,onChange:se,className:"w-5 h-5 rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),i.jsx("label",{htmlFor:"is_active",className:"text-sm text-gray-700",children:"Producto activo"})]})]}),i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Variantes"}),i.jsx("p",{className:"text-xs text-gray-400",children:"Tallas y colores disponibles"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[!a&&d.length===0&&i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:" Colores (separados por coma)"}),i.jsx("input",{type:"text",value:_,onChange:q=>j(q.target.value),className:"form-input text-sm py-1.5",placeholder:"Ej: Negro, Miel, Blanco"})]}),i.jsxs("div",{className:"flex gap-2",children:[!a&&d.length===0&&i.jsxs("button",{type:"button",onClick:U,className:"btn-secondary text-xs py-2 px-4 flex items-center gap-1 border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 shadow-sm",children:[i.jsx(mt,{size:14}),"Generar Todo (35-",l.category==="Caballero"?"43":"40",")"]}),i.jsxs("button",{type:"button",onClick:ce,className:"btn-secondary flex items-center gap-2 py-2 px-4",children:[i.jsx(mt,{size:16}),"Agregar Talla"]})]})]})]}),d.length===0?i.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-200 rounded-xl",children:[i.jsx(Wt,{className:"mx-auto text-gray-300",size:40}),i.jsx("p",{className:"text-gray-500 mt-2",children:"No hay variantes"}),i.jsxs("button",{type:"button",onClick:ce,className:"btn-primary mt-4",children:[i.jsx(mt,{size:16,className:"inline mr-1"}),"Agregar Primera Variante"]})]}):i.jsx("div",{className:"space-y-4",children:d.map((q,re)=>i.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl border",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Variante ",re+1]}),i.jsx("button",{type:"button",onClick:()=>he(re),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:i.jsx(rl,{size:18})})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-5 gap-4",children:[i.jsx("div",{className:"sm:col-span-1",children:i.jsx(am,{value:q.image_url,onChange:ee=>te(re,"image_url",ee),path:"variants",label:"Foto"})}),i.jsxs("div",{className:"sm:col-span-4 grid grid-cols-2 sm:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500",children:"Talla *"}),i.jsx("input",{type:"text",value:q.size,onChange:ee=>te(re,"size",ee.target.value),className:"form-input text-sm",placeholder:"37",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500",children:"Color *"}),i.jsx("input",{type:"text",value:q.color,onChange:ee=>te(re,"color",ee.target.value),className:"form-input text-sm",placeholder:"Negro",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500",children:"SKU"}),i.jsx("input",{type:"text",value:q.sku,onChange:ee=>te(re,"sku",ee.target.value),className:"form-input text-sm",placeholder:"ABC-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-500",children:"Stock Mn."}),i.jsx("input",{type:"number",value:q.min_stock,onChange:ee=>te(re,"min_stock",Number(ee.target.value)),className:"form-input text-sm",min:"0"})]}),i.jsxs("div",{className:"col-span-2 sm:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-500",children:"Stock Actual"}),i.jsx("input",{type:"number",value:q.stock,onChange:ee=>te(re,"stock",Number(ee.target.value)),className:"form-input text-sm",min:"0",disabled:a,title:a?"El stock se modifica mediante compras y ventas":""}),a&&i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Stock se modifica con compras/ventas"})]})]})]})]},re))})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>t("/products"),className:"btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:J.isPending,className:"btn-primary flex items-center gap-2",children:J.isPending?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner w-4 h-4 border-white/30 border-t-white"}),"Guardando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ha,{size:20}),a?"Actualizar":"Guardar"]})})]})]})]})}function K_(){const[n,t]=E.useState(""),[s,a]=E.useState(null),{data:l=[],isLoading:u}=Ke({queryKey:["purchases"],queryFn:async()=>{const{data:p,error:g}=await ue.from("purchases").select(`
          *,
          supplier:suppliers(id, name),
          items:purchase_items(
            *,
            product_variant:product_variants(
              id, size, color, sku,
              product:products(id, name)
            )
          )
        `).order("purchase_date",{ascending:!1});if(g)throw g;return p}}),d=l.filter(p=>{var g,y,x;return((g=p.invoice_number)==null?void 0:g.toLowerCase().includes(n.toLowerCase()))||((x=(y=p.supplier)==null?void 0:y.name)==null?void 0:x.toLowerCase().includes(n.toLowerCase()))}),f=p=>new Date(p).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"});return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Compras"}),i.jsx("p",{className:"text-gray-500",children:"Registro de facturas y entrada de inventario"})]}),i.jsxs(wt,{to:"/purchases/new",className:"btn-primary flex items-center gap-2 w-fit",children:[i.jsx(mt,{size:20}),"Nueva Compra"]})]}),i.jsx("div",{className:"card",children:i.jsxs("div",{className:"relative",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar por factura o proveedor...",value:n,onChange:p=>t(p.target.value),className:"form-input pl-10"})]})}),u?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando compras..."})]}):d.length===0?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx(Qs,{className:"mx-auto text-gray-300",size:48}),i.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-800",children:"No hay compras"}),i.jsx("p",{className:"text-gray-500 mt-1",children:n?"No se encontraron compras con ese criterio":"Comienza registrando tu primera compra"}),!n&&i.jsxs(wt,{to:"/purchases/new",className:"btn-primary mt-4 inline-flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Registrar Compra"]})]}):i.jsx("div",{className:"space-y-4",children:d.map(p=>{var g;return i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(Qs,{className:"text-purple-600",size:24})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("h3",{className:"font-semibold text-gray-800",children:p.invoice_number||"Sin nmero"}),i.jsx("span",{className:`badge ${p.status==="pagada"?"badge-success":"badge-warning"}`,children:p.status==="pagada"?"Pagada":"Pendiente"})]}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[((g=p.supplier)==null?void 0:g.name)||"Sin proveedor"," "," ",f(p.purchase_date)]}),i.jsxs("p",{className:"text-lg font-bold text-gray-800 mt-1",children:["$",p.total_amount.toLocaleString()]})]})]}),i.jsx("button",{onClick:()=>a(s===p.id?null:p.id),className:"btn-secondary flex items-center gap-2",children:s===p.id?i.jsxs(i.Fragment,{children:[i.jsx(tl,{size:16}),"Ocultar Detalle"]}):i.jsxs(i.Fragment,{children:[i.jsx(el,{size:16}),"Ver Detalle"]})})]}),s===p.id&&p.items&&i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Items comprados"}),i.jsx("div",{className:"table-container",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Variante"}),i.jsx("th",{className:"text-right",children:"Cantidad"}),i.jsx("th",{className:"text-right",children:"Costo Unit."}),i.jsx("th",{className:"text-right",children:"Subtotal"})]})}),i.jsx("tbody",{children:p.items.map(y=>{var x,w,b,S;return i.jsxs("tr",{children:[i.jsx("td",{className:"font-medium",children:((w=(x=y.product_variant)==null?void 0:x.product)==null?void 0:w.name)||"Producto"}),i.jsxs("td",{children:[(b=y.product_variant)==null?void 0:b.size," - ",(S=y.product_variant)==null?void 0:S.color]}),i.jsx("td",{className:"text-right",children:y.quantity}),i.jsxs("td",{className:"text-right",children:["$",y.unit_cost.toLocaleString()]}),i.jsxs("td",{className:"text-right font-medium",children:["$",y.subtotal.toLocaleString()]})]},y.id)})}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"border-t-2",children:[i.jsx("td",{colSpan:4,className:"text-right font-semibold",children:"Total:"}),i.jsxs("td",{className:"text-right font-bold text-lg",children:["$",p.total_amount.toLocaleString()]})]})})]})}),p.notes&&i.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[i.jsx("strong",{children:"Notas:"})," ",p.notes]})]})]},p.id)})})]})}function W_(){const n=Jt(),t=Tt(),{user:s}=vr(),[a,l]=E.useState(""),[u,d]=E.useState(""),[f,p]=E.useState(new Date().toISOString().split("T")[0]),[g,y]=E.useState("pendiente"),[x,w]=E.useState(""),[b,S]=E.useState([]),[_,j]=E.useState(""),[N,A]=E.useState(null),[T,$]=E.useState({}),[K,J]=E.useState(null),{data:Z=[]}=Ke({queryKey:["suppliers-active"],queryFn:async()=>{const{data:B}=await ue.from("suppliers").select("id, name").eq("is_active",!0).order("name");return B}}),{data:se=[]}=Ke({queryKey:["product-variants-for-purchase"],queryFn:async()=>{const{data:B}=await ue.from("product_variants").select(`
          id, size, color, sku, cost, price, stock,
          product:products(id, name, is_active)
        `).order("product_id");return(B||[]).filter(z=>{var W;return(W=z.product)==null?void 0:W.is_active})}}),ce=Object.values(se.filter(B=>{var z,W;return!b.some(Q=>Q.product_variant_id===B.id)&&(((z=B.product)==null?void 0:z.name.toLowerCase().includes(_.toLowerCase()))||B.color.toLowerCase().includes(_.toLowerCase())||((W=B.sku)==null?void 0:W.toLowerCase().includes(_.toLowerCase())))}).reduce((B,z)=>{var Q;const W=`${z.product.id}-${z.color}`;return B[W]||(B[W]={id:W,productName:z.product.name,color:z.color,image_url:z.image_url||((Q=z.product)==null?void 0:Q.image_url),variants:[]}),B[W].variants.push(z),B},{})),U=b.reduce((B,z)=>B+z.quantity*z.unit_cost,0),te=()=>{const B=[];Object.entries(T).forEach(([z,W])=>{if(W>0){const Q=se.find(P=>P.id===z);Q&&B.push({product_variant_id:Q.id,quantity:W,unit_cost:Q.cost,variant:Q})}}),B.length>0&&(S(z=>[...z,...B]),j(""),A(null),$({}))},he=(B,z,W)=>{S(Q=>Q.map((P,M)=>M===B?{...P,[z]:W}:P))},q=B=>{S(z=>z.filter((W,Q)=>Q!==B))},re=Object.values(b.reduce((B,z,W)=>{var P,M,Ne,ke,F,X,oe;const Q=`${((M=(P=z.variant)==null?void 0:P.product)==null?void 0:M.id)||((Ne=z.variant)==null?void 0:Ne.product_id)}-${(ke=z.variant)==null?void 0:ke.color}`;return B[Q]||(B[Q]={id:Q,productName:(X=(F=z.variant)==null?void 0:F.product)==null?void 0:X.name,color:(oe=z.variant)==null?void 0:oe.color,items:[]}),B[Q].items.push({...z,idx:W}),B},{})),ee=Pt({mutationFn:async()=>{if(b.length===0)throw new Error("Agrega al menos un producto");const{data:B,error:z}=await ue.from("purchases").insert({supplier_id:a||null,invoice_number:u||null,purchase_date:f,total_amount:U,status:g,notes:x||null,created_by:s==null?void 0:s.id}).select("id").single();if(z)throw z;const W=b.map(P=>({purchase_id:B.id,product_variant_id:P.product_variant_id,quantity:P.quantity,unit_cost:P.unit_cost,subtotal:P.quantity*P.unit_cost})),{error:Q}=await ue.from("purchase_items").insert(W);if(Q)throw Q;for(const P of b){const{data:M}=await ue.from("product_variants").select("stock").eq("id",P.product_variant_id).single();M&&(await ue.from("product_variants").update({stock:M.stock+P.quantity,updated_at:new Date().toISOString()}).eq("id",P.product_variant_id),await ue.from("inventory_movements").insert({product_variant_id:P.product_variant_id,movement_type:"compra",quantity:P.quantity,reference_id:B.id,reference_type:"purchase",created_by:s==null?void 0:s.id}))}},onSuccess:()=>{t.invalidateQueries({queryKey:["purchases"]}),t.invalidateQueries({queryKey:["products"]}),n("/purchases")},onError:B=>{J(B.message)}}),me=B=>{B.preventDefault(),J(null),ee.mutate()};return i.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n("/purchases"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ti,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Nueva Compra"}),i.jsx("p",{className:"text-gray-500",children:"Registra una factura de compra y actualiza el inventario"})]})]}),i.jsxs("form",{onSubmit:me,className:"space-y-6",children:[i.jsxs("div",{className:"card space-y-4",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center",children:i.jsx(Qs,{className:"text-purple-600",size:32})})}),K&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:K}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Proveedor"}),i.jsxs("select",{value:a,onChange:B=>l(B.target.value),className:"form-select",children:[i.jsx("option",{value:"",children:"Seleccionar proveedor..."}),Z.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Nmero de Factura"}),i.jsx("input",{type:"text",value:u,onChange:B=>d(B.target.value),className:"form-input",placeholder:"FAC-001"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Fecha de Compra"}),i.jsx("input",{type:"date",value:f,onChange:B=>p(B.target.value),className:"form-input"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Estado de Pago"}),i.jsxs("select",{value:g,onChange:B=>y(B.target.value),className:"form-select",children:[i.jsx("option",{value:"pendiente",children:"Pendiente"}),i.jsx("option",{value:"pagada",children:"Pagada"})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Notas"}),i.jsx("textarea",{value:x,onChange:B=>w(B.target.value),className:"form-input min-h-[60px]",placeholder:"Notas adicionales..."})]})]}),i.jsxs("div",{className:"card",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Productos a Comprar"}),i.jsxs("div",{className:"relative mb-4",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar producto para agregar...",value:_,onChange:B=>j(B.target.value),className:"form-input pl-10"})]}),_&&ce.length>0&&i.jsx("div",{className:"mb-4 max-h-60 overflow-y-auto border rounded-xl divide-y",children:ce.slice(0,10).map(B=>i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"flex justify-between items-center cursor-pointer hover:text-primary-600 transition-colors",onClick:()=>{if((N==null?void 0:N.id)===B.id)A(null),$({});else{A(B);const z={};B.variants.forEach(W=>z[W.id]=""),$(z)}},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded flex items-center justify-center border font-bold text-xs",children:B.color[0]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-bold text-gray-800",children:B.productName}),i.jsx("p",{className:"text-xs text-secondary-600 font-medium uppercase tracking-wider",children:B.color})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-[10px] bg-gray-100 px-2 py-0.5 rounded-full text-gray-500 font-bold",children:[B.variants.length," Tallas"]}),i.jsx(mt,{size:20,className:`text-primary-600 transition-transform ${(N==null?void 0:N.id)===B.id?"rotate-45":""}`})]})]}),(N==null?void 0:N.id)===B.id&&i.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl border border-gray-100 animate-fade-in",children:[i.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase mb-3 px-1",children:"Indicar cantidades por talla:"}),i.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2 mb-4",children:B.variants.sort((z,W)=>parseInt(z.size)-parseInt(W.size)).map(z=>i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-[10px] font-bold text-center text-gray-500",children:z.size}),i.jsx("input",{type:"number",placeholder:"0",className:"form-input p-1 text-center text-sm font-bold h-9",value:T[z.id]||"",onChange:W=>{const Q=W.target.value===""?"":parseInt(W.target.value);$(P=>({...P,[z.id]:Q}))}})]},z.id))}),i.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-200",children:i.jsxs("button",{type:"button",onClick:te,disabled:!Object.values(T).some(z=>z>0),className:"btn-primary py-2 px-4 text-xs flex items-center gap-2",children:[i.jsx(mt,{size:16}),"Agregar Seleccionados"]})})]})]},B.id))}),b.length===0?i.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-200 rounded-xl",children:[i.jsx(Qs,{className:"mx-auto text-gray-300",size:40}),i.jsx("p",{className:"text-gray-500 mt-2",children:"Busca y agrega productos"})]}):i.jsx(i.Fragment,{children:i.jsx("div",{className:"table-container",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Variante"}),i.jsx("th",{className:"text-center",children:"Cantidad"}),i.jsx("th",{className:"text-right",children:"Costo Unit."}),i.jsx("th",{className:"text-right",children:"Subtotal"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:re.map(B=>i.jsxs(Hu.Fragment,{children:[i.jsx("tr",{className:"bg-gray-50/50",children:i.jsx("td",{colSpan:6,className:"py-2 px-4 border-b",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-bold text-gray-800 text-sm",children:B.productName}),i.jsx("span",{className:"text-[10px] bg-primary-100 text-primary-700 px-2 py-0.5 rounded font-bold uppercase tracking-wider",children:B.color})]})})}),B.items.sort((z,W)=>parseInt(z.variant.size)-parseInt(W.variant.size)).map(z=>{var W,Q;return i.jsxs("tr",{className:"hover:bg-gray-50/30 transition-colors",children:[i.jsxs("td",{className:"pl-8 text-gray-400 text-xs italic",children:["Talla ",(W=z.variant)==null?void 0:W.size]}),i.jsx("td",{className:"text-gray-500 text-xs",children:((Q=z.variant)==null?void 0:Q.sku)||"-"}),i.jsx("td",{children:i.jsx("input",{type:"number",value:z.quantity,onChange:P=>he(z.idx,"quantity",Number(P.target.value)),className:"form-input w-20 text-center mx-auto h-8 text-sm",min:"1"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex items-center gap-1 max-w-[120px] ml-auto",children:[i.jsx("span",{className:"text-gray-400 text-xs",children:"$"}),i.jsx("input",{type:"number",value:z.unit_cost,onChange:P=>he(z.idx,"unit_cost",Number(P.target.value)),className:"form-input w-full text-right h-8 text-sm",min:"0",step:"0.01"})]})}),i.jsxs("td",{className:"text-right font-medium text-sm text-gray-700",children:["$",(z.quantity*z.unit_cost).toLocaleString()]}),i.jsx("td",{className:"text-right",children:i.jsx("button",{type:"button",onClick:()=>q(z.idx),className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:i.jsx(rl,{size:16})})})]},z.idx)})]},B.id))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"border-t-2",children:[i.jsx("td",{colSpan:4,className:"text-right font-semibold text-lg",children:"Total:"}),i.jsxs("td",{className:"text-right font-bold text-xl text-primary-600",children:["$",U.toLocaleString()]}),i.jsx("td",{})]})})]})})})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>n("/purchases"),className:"btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:ee.isPending||b.length===0,className:"btn-primary flex items-center gap-2",children:ee.isPending?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner w-4 h-4 border-white/30 border-t-white"}),"Guardando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ha,{size:20}),"Registrar Compra"]})})]})]})]})}function Q_({sale:n,onClose:t}){var w,b;const s=Tt(),[a,l]=E.useState({}),[u,d]=E.useState(""),[f,p]=E.useState(!0);if(!n)return null;const g=(S,_,j)=>{const N=parseInt(j)||0;N<0||N>_||l(A=>({...A,[S]:N}))},y=((w=n.items)==null?void 0:w.reduce((S,_)=>{const j=a[_.id]||0;return S+_.unit_price*j},0))||0,x=Pt({mutationFn:async()=>{if(!n.items)return;const S=n.items.filter(N=>(a[N.id]||0)>0);if(S.length===0)throw new Error("Seleccione productos a devolver");const{data:_,error:j}=await ue.from("returns").insert({sale_id:n.id,reason:u,refund_amount:y,status:"completado"}).select().single();if(j)throw j;for(const N of S){const A=a[N.id];if(await ue.from("return_items").insert({return_id:_.id,product_variant_id:N.product_variant_id,quantity:A}),f){const{data:T}=await ue.from("product_variants").select("stock").eq("id",N.product_variant_id).single();T&&(await ue.from("product_variants").update({stock:T.stock+A}).eq("id",N.product_variant_id),await ue.from("inventory_movements").insert({product_variant_id:N.product_variant_id,movement_type:"devolucion",quantity:A,reference_id:_.id,reference_type:"return",notes:`Devolucin venta #${n.id.slice(0,8)}`}))}}},onSuccess:()=>{s.invalidateQueries({queryKey:["sales"]}),s.invalidateQueries({queryKey:["product-variants-for-sale"]}),t()}});return i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden animate-fade-in",children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[i.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[i.jsx(wg,{size:20,className:"text-orange-500"}),"Devolver Productos"]}),i.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-200 rounded-full",children:i.jsx(Wn,{size:20})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg border border-orange-100 flex gap-2 text-sm text-orange-800",children:[i.jsx(ra,{size:16,className:"shrink-0 mt-0.5"}),i.jsx("p",{children:"Seleccione las cantidades a devolver. Esta accin no se puede deshacer."})]}),i.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-lg",children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-500 text-xs uppercase sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 text-left",children:"Producto"}),i.jsx("th",{className:"p-2 text-right",children:"Comprado"}),i.jsx("th",{className:"p-2 text-right",children:"Devolver"})]})}),i.jsx("tbody",{className:"divide-y",children:(b=n.items)==null?void 0:b.map(S=>{var _,j,N,A;return i.jsxs("tr",{children:[i.jsxs("td",{className:"p-2",children:[i.jsx("p",{className:"font-medium",children:(j=(_=S.product_variant)==null?void 0:_.product)==null?void 0:j.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[(N=S.product_variant)==null?void 0:N.size," / ",(A=S.product_variant)==null?void 0:A.color]})]}),i.jsx("td",{className:"p-2 text-right text-gray-500",children:S.quantity}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",min:"0",max:S.quantity,className:"w-16 p-1 border rounded text-right",value:a[S.id]||"",onChange:T=>g(S.id,S.quantity,T.target.value),placeholder:"0"})})]},S.id)})})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de la devolucin"}),i.jsx("textarea",{className:"form-input text-sm",rows:2,value:u,onChange:S=>d(S.target.value),placeholder:"Ej: Talla incorrecta, producto defectuoso..."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"restock",checked:f,onChange:S=>p(S.target.checked),className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),i.jsx("label",{htmlFor:"restock",className:"text-sm text-gray-700",children:"Devolver al inventario (Restock)"})]})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total a Reembolsar"}),i.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["$",y.toLocaleString()]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-lg text-sm font-medium",children:"Cancelar"}),i.jsx("button",{onClick:()=>x.mutate(),disabled:x.isPending||y===0,className:"btn-primary bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:x.isPending?"Procesando...":i.jsxs(i.Fragment,{children:[i.jsx(ad,{size:16})," Confirmar Devolucin"]})})]})]})]})})}function G_(){const{isAdmin:n}=vr(),[t,s]=E.useState(""),[a,l]=E.useState(null),[u,d]=E.useState(new Date().toISOString().split("T")[0]),[f,p]=E.useState(null),{data:g=[],isLoading:y}=Ke({queryKey:["sales",u],queryFn:async()=>{const{data:b,error:S}=await ue.from("sales").select(`
          *,
          items:sale_items(
            *,
            product_variant:product_variants(
              product:products(name),
              size,
              color
            )
          ),
          customer:customers(full_name, phone)
        `).gte("sale_date",u).lte("sale_date",u).eq("shipping_type","local").order("created_at",{ascending:!1});if(S)throw S;return b}}),x=b=>new Date(b).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"}),w={efectivo:"Efectivo",tarjeta:"Tarjeta",transferencia:"Transferencia",mixto:"Mixto",dropi:"Dropi",contraentrega:"Contraentrega"};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Ventas"}),i.jsx("p",{className:"text-gray-500",children:"Historial de ventas realizadas"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>{const b=g.map(S=>{var _,j;return{Fecha:new Date(S.created_at).toLocaleString(),Total:S.total_amount,Mtodo:w[S.payment_method],Descuento:S.discount_amount,Cliente:((_=S.customer)==null?void 0:_.full_name)||"Consumidor Final",Items:((j=S.items)==null?void 0:j.length)||0,ID:S.id}});As(b,`ventas_${u}`)},className:"btn-secondary flex items-center gap-2",children:[i.jsx(Os,{size:20}),"Exportar"]}),i.jsxs(wt,{to:n?"/sales/new":"/shipping/new",className:"btn-success flex items-center gap-2 w-fit",children:[i.jsx(mt,{size:20}),"Nueva Venta"]})]})]}),i.jsxs("div",{className:"card flex flex-col sm:flex-row gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar...",value:t,onChange:b=>s(b.target.value),className:"form-input pl-10"})]})}),i.jsx("div",{className:"sm:w-48",children:i.jsx("input",{type:"date",value:u,onChange:b=>d(b.target.value),className:"form-input"})})]}),y?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx("div",{className:"spinner mx-auto"}),i.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando ventas..."})]}):g.length===0?i.jsxs("div",{className:"card text-center py-12",children:[i.jsx(Ws,{className:"mx-auto text-gray-300",size:48}),i.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-800",children:"No hay ventas"}),i.jsx("p",{className:"text-gray-500 mt-1",children:"No se encontraron ventas para esta fecha"}),i.jsxs(wt,{to:"/sales/new",className:"btn-success mt-4 inline-flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Registrar Venta"]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"card bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100",children:"Total del da"}),i.jsxs("p",{className:"text-3xl font-bold",children:["$",g.reduce((b,S)=>b+S.total_amount,0).toLocaleString()]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-green-100",children:[g.length," ventas"]})})]})}),g.map(b=>{var S;return i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(Ws,{className:"text-green-600",size:24})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs("h3",{className:"font-semibold text-gray-800",children:["$",b.total_amount.toLocaleString()]}),i.jsx("span",{className:"badge-info",children:w[b.payment_method]}),b.discount_amount>0&&i.jsxs("span",{className:"badge-warning",children:["-$",b.discount_amount.toLocaleString()]})]}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[x(b.created_at),"  ",((S=b.items)==null?void 0:S.length)||0," productos"]})]})]}),i.jsx("button",{onClick:()=>l(a===b.id?null:b.id),className:"btn-secondary flex items-center gap-2",children:a===b.id?i.jsxs(i.Fragment,{children:[i.jsx(tl,{size:16}),"Ocultar"]}):i.jsxs(i.Fragment,{children:[i.jsx(el,{size:16}),"Ver Detalle"]})})]}),a===b.id&&b.items&&i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h4",{className:"font-semibold text-gray-700",children:"Detalle de Productos"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>window.open(`/print/sale/${b.id}`,"_blank"),className:"text-blue-600 hover:bg-blue-50 px-3 py-1 rounded-lg text-sm font-medium flex items-center gap-2 border border-blue-200 transition-colors",children:[i.jsx(cd,{size:16}),"Imprimir"]}),i.jsxs("button",{onClick:()=>p(b),className:"text-orange-600 hover:bg-orange-50 px-3 py-1 rounded-lg text-sm font-medium flex items-center gap-2 border border-orange-200 transition-colors",children:[i.jsx(wg,{size:16}),"Iniciar Devolucin"]})]})]}),i.jsx("div",{className:"table-container",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Color"}),i.jsx("th",{children:"Tallas"}),i.jsx("th",{className:"text-right",children:"Cant. Total"}),i.jsx("th",{className:"text-right",children:"Precio Prom."}),i.jsx("th",{className:"text-right",children:"Subtotal"})]})}),i.jsx("tbody",{children:Object.values((b.items||[]).reduce((_,j)=>{var A,T,$,K,J;const N=((A=j.product_variant)==null?void 0:A.color)||"Sin Color";return _[N]||(_[N]={name:(($=(T=j.product_variant)==null?void 0:T.product)==null?void 0:$.name)||"Producto",color:N,sizes:[],totalQty:0,avgPrice:0,subtotal:0}),_[N].sizes.includes((K=j.product_variant)==null?void 0:K.size)||_[N].sizes.push((J=j.product_variant)==null?void 0:J.size),_[N].totalQty+=j.quantity,_[N].subtotal+=j.subtotal,_[N].avgPrice=_[N].subtotal/_[N].totalQty,_},{})).map((_,j)=>i.jsxs("tr",{children:[i.jsx("td",{className:"font-medium",children:_.name}),i.jsx("td",{children:_.color}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-wrap gap-1",children:_.sizes.sort().map(N=>i.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded text-xs border border-blue-100",children:N},N))})}),i.jsx("td",{className:"text-right font-bold",children:_.totalQty}),i.jsxs("td",{className:"text-right",children:["$",_.avgPrice.toLocaleString()]}),i.jsxs("td",{className:"text-right font-bold",children:["$",_.subtotal.toLocaleString()]})]},j))})]})}),b.notes&&i.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[i.jsx("strong",{children:"Notas:"})," ",b.notes]})]})]},b.id)})]}),f&&i.jsx(Q_,{sale:f,onClose:()=>p(null)})]})}function J_(){const[n,t]=E.useState(""),[s,a]=E.useState(null),l=Tt(),{data:u=[],isLoading:d}=Ke({queryKey:["shipments"],queryFn:async()=>{const{data:y,error:x}=await ue.from("sales").select(`
                    *,
                    items:sale_items(
                        *,
                        product_variant:product_variants(
                            product:products(name),
                            size,
                            color
                        )
                    ),
                    customer:customers(full_name, phone, address)
                `).neq("shipping_type","local").order("created_at",{ascending:!1});if(x)throw x;return y}}),f=Pt({mutationFn:async({id:y,status:x,tracking:w})=>{const{error:b}=await ue.from("sales").update({shipping_status:x,tracking_number:w,updated_at:new Date().toISOString()}).eq("id",y);if(b)throw b},onSuccess:()=>{l.invalidateQueries({queryKey:["shipments"]})}}),p=u.filter(y=>{var x,w,b;return((w=(x=y.customer)==null?void 0:x.full_name)==null?void 0:w.toLowerCase().includes(n.toLowerCase()))||((b=y.tracking_number)==null?void 0:b.toLowerCase().includes(n.toLowerCase()))||y.id.toLowerCase().includes(n.toLowerCase())}),g=y=>{switch(y){case"pendiente":return i.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx(E_,{size:12})," Pendiente"]});case"enviado":return i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx(Lr,{size:12})," Enviado"]});case"entregado":return i.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx(Fu,{size:12})," Entregado"]});case"devuelto":return i.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx(k_,{size:12})," Devuelto"]});default:return y}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Gestin de Envos"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Control de guas y estados para Dropi y Contraentrega"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[i.jsxs("div",{className:"relative w-full md:w-96",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar por cliente, gua o ID...",className:"form-input pl-10",value:n,onChange:y=>t(y.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>{const y=u.map(x=>{var w,b,S;return{Fecha:new Date(x.created_at).toLocaleDateString(),Cliente:((w=x.customer)==null?void 0:w.full_name)||"Consumidor Final",Telfono:((b=x.customer)==null?void 0:b.phone)||"",Direccin:((S=x.customer)==null?void 0:S.address)||"",Tipo:x.shipping_type,Estado:x.shipping_status,"No. Gua":x.tracking_number||"","Costo Envo":x.shipping_cost||0,"Total Venta":x.total_amount}});As(y,"envios_sophi_shoes")},className:"btn-secondary flex items-center gap-2",children:[i.jsx(Os,{size:20}),"Exportar"]}),i.jsxs(wt,{to:"/shipping/new",className:"btn-primary flex items-center gap-2",children:[i.jsx(mt,{size:20}),"Nuevo Envo"]})]})]}),i.jsx("div",{className:"card overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"F. Venta"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipo"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No. Gua"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estado"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),i.jsx("th",{className:"px-4 py-3"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-500",children:"Cargando envos..."})}):p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-500",children:"No se encontraron envos"})}):p.map(y=>{var x,w,b;return i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-4 text-sm text-gray-600",children:new Date(y.created_at).toLocaleDateString()}),i.jsxs("td",{className:"px-4 py-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:((x=y.customer)==null?void 0:x.full_name)||"Consumidor Final"}),i.jsx("div",{className:"text-xs text-gray-500",children:(w=y.customer)==null?void 0:w.phone})]}),i.jsx("td",{className:"px-4 py-4",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${y.shipping_type==="dropi"?"bg-purple-100 text-purple-700":"bg-orange-100 text-orange-700"}`,children:y.shipping_type})}),i.jsx("td",{className:"px-4 py-4",children:y.tracking_number?i.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded font-mono",children:y.tracking_number}):i.jsx("span",{className:"text-gray-400 text-xs italic",children:"Sin gua"})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:g(y.shipping_status)}),i.jsxs("td",{className:"px-4 py-4 text-right text-sm font-bold text-gray-900",children:["$",y.total_amount.toLocaleString()]}),i.jsx("td",{className:"px-4 py-4 text-right",children:i.jsx("button",{onClick:()=>a(s===y.id?null:y.id),className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:s===y.id?i.jsx(tl,{size:20}):i.jsx(el,{size:20})})})]},y.id),s===y.id&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Detalle de Productos"}),i.jsx("div",{className:"space-y-2",children:(b=y.items)==null?void 0:b.map(S=>{var _,j,N,A;return i.jsxs("div",{className:"flex justify-between text-xs bg-white p-2 rounded border",children:[i.jsxs("span",{children:[S.quantity,"x ",(j=(_=S.product_variant)==null?void 0:_.product)==null?void 0:j.name," (",(N=S.product_variant)==null?void 0:N.size," / ",(A=S.product_variant)==null?void 0:A.color,")"]}),i.jsxs("span",{className:"font-medium",children:["$",(S.unit_price*S.quantity).toLocaleString()]})]},S.id)})}),i.jsx("div",{className:"mt-4 flex gap-2",children:i.jsxs("button",{onClick:()=>window.open(`/print/sale/${y.id}`,"_blank"),className:"btn-secondary text-xs flex items-center gap-1",children:[i.jsx(cd,{size:14})," Imprimir Recibo"]})})]}),i.jsxs("div",{className:"bg-white p-4 rounded border",children:[i.jsx("h4",{className:"font-semibold text-sm text-gray-700 mb-4",children:"Actualizar Estado"}),i.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:["pendiente","enviado","entregado","devuelto"].map(S=>i.jsx("button",{onClick:()=>f.mutate({id:y.id,status:S}),disabled:f.isPending,className:`px-3 py-2 rounded text-xs font-medium capitalize border transition-all ${y.shipping_status===S?"bg-primary-50 border-primary-500 text-primary-700":"bg-white border-gray-200 hover:border-gray-300"}`,children:S},S))}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1 block",children:"Nmero de Gua"}),i.jsx("div",{className:"flex gap-2",children:i.jsx("input",{type:"text",className:"form-input text-xs h-9",placeholder:"Actualizar gua...",defaultValue:y.tracking_number,onBlur:S=>{S.target.value!==y.tracking_number&&f.mutate({id:y.id,status:y.shipping_status,tracking:S.target.value})}})})]})]})]})})})]})})})]})})})]})}function Y_({onSelect:n,selectedCustomer:t}){const[s,a]=E.useState(!1),[l,u]=E.useState(""),[d,f]=E.useState(!1),[p,g]=E.useState({full_name:"",phone:"",email:"",identification:"",document_type:"13"}),y=E.useRef(null),x=Tt(),{data:w=[]}=Ke({queryKey:["customers",l],queryFn:async()=>{if(!l||l.length<2)return[];const{data:_}=await ue.from("customers").select("*").or(`full_name.ilike.%${l}%,identification.ilike.%${l}%,phone.ilike.%${l}%`).limit(5);return _||[]},enabled:s&&l.length>=2}),b=Pt({mutationFn:async _=>{const{data:j,error:N}=await ue.from("customers").insert([_]).select().single();if(N)throw N;return j},onSuccess:_=>{n(_),a(!1),f(!1),g({full_name:"",phone:"",email:"",identification:"",document_type:"13"}),u(""),x.invalidateQueries({queryKey:["customers"]})}});E.useEffect(()=>{function _(j){y.current&&!y.current.contains(j.target)&&(a(!1),f(!1))}return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[y]);const S=_=>{if(_.preventDefault(),!p.full_name)return;const j={...p,identification:p.identification||`TEMP-${Date.now()}`,email:p.email||"temporal@sophi.com"};b.mutate(j)};return t?i.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600",children:i.jsx(Gs,{size:20})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-bold text-gray-800 text-sm",children:t.full_name}),i.jsx("p",{className:"text-xs text-gray-500",children:t.phone||t.email||"Sin contacto"})]})]}),i.jsx("button",{onClick:()=>n(null),className:"p-1 hover:bg-blue-200 rounded-full text-blue-600 transition-colors",title:"Quitar cliente",children:i.jsx(Wn,{size:18})})]}):i.jsx("div",{ref:y,className:"relative",children:s?i.jsx("div",{className:"absolute top-0 left-0 w-full min-w-[300px] bg-white rounded-lg shadow-xl border border-gray-200 z-50 overflow-hidden",children:d?i.jsxs("form",{onSubmit:S,className:"p-4 space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:"Nuevo Cliente"}),i.jsx("button",{type:"button",onClick:()=>f(!1),className:"text-gray-400",children:i.jsx(Wn,{size:16})})]}),i.jsx("input",{required:!0,placeholder:"Nombre Completo / Razn Social",className:"form-input text-sm",value:p.full_name,onChange:_=>g({...p,full_name:_.target.value})}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("select",{className:"form-input text-sm",value:p.document_type,onChange:_=>g({...p,document_type:_.target.value}),children:[i.jsx("option",{value:"13",children:"C.C."}),i.jsx("option",{value:"31",children:"NIT"}),i.jsx("option",{value:"41",children:"Pasaporte"})]}),i.jsx("input",{placeholder:"Identificacin (Opcional)",className:"form-input text-sm",value:p.identification,onChange:_=>g({...p,identification:_.target.value})})]}),i.jsx("input",{placeholder:"Telfono",className:"form-input text-sm",value:p.phone,onChange:_=>g({...p,phone:_.target.value})}),i.jsx("input",{type:"email",placeholder:"Email (Opcional - solo para factura)",className:"form-input text-sm",value:p.email,onChange:_=>g({...p,email:_.target.value})}),i.jsx("button",{type:"submit",disabled:b.isPending||!p.full_name,className:"w-full btn-primary py-2 text-sm flex justify-center items-center gap-2",children:b.isPending?"Guardando...":i.jsxs(i.Fragment,{children:[i.jsx(ad,{size:16})," Guardar y Seleccionar"]})}),i.jsx("p",{className:"text-[10px] text-gray-400 text-center",children:"* Para ventas locales solo se requiere el nombre. Identificacin y Email se generarn automticamente si se dejan vacos."})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"p-2 border-b border-gray-100 flex items-center gap-2",children:[i.jsx(xr,{size:18,className:"text-gray-400"}),i.jsx("input",{type:"text",autoFocus:!0,placeholder:"Buscar por nombre, cdula o NIT...",className:"flex-1 outline-none text-sm",value:l,onChange:_=>u(_.target.value)}),i.jsx("button",{onClick:()=>a(!1),children:i.jsx(Wn,{size:16,className:"text-gray-400"})})]}),i.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[w.map(_=>i.jsxs("button",{onClick:()=>{n(_),a(!1)},className:"w-full p-2 hover:bg-gray-50 flex items-center gap-3 text-left",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:i.jsx(Gs,{size:16})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-sm text-gray-800",children:_.full_name}),i.jsxs("p",{className:"text-[10px] text-gray-400",children:["ID: ",_.identification," ",_.phone&&` Tel: ${_.phone}`]})]})]},_.id)),l.length>0&&w.length===0&&i.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No se encontraron resultados"})]}),l.length>2&&i.jsxs("button",{onClick:()=>{g(_=>({..._,full_name:l})),f(!0)},className:"w-full p-3 bg-blue-50 text-blue-700 text-sm font-medium hover:bg-blue-100 flex items-center justify-center gap-2 border-t border-blue-100",children:[i.jsx(Uo,{size:16}),'Registrar "',l,'" como nuevo cliente']}),i.jsxs("button",{onClick:()=>{g(_=>({..._,full_name:l})),f(!0)},className:"w-full p-3 bg-gray-50 text-gray-600 text-sm font-medium hover:bg-gray-100 flex items-center justify-center gap-2",children:[i.jsx(Uo,{size:16}),"Crear Cliente (Formulario Completo)"]})]})}):i.jsxs("button",{onClick:()=>a(!0),className:"w-full flex items-center gap-2 p-3 bg-white border border-gray-200 rounded-lg text-gray-500 hover:border-primary-500 hover:text-primary-600 transition-colors text-left",children:[i.jsx(Uo,{size:20}),i.jsx("span",{className:"text-sm font-medium",children:"Asociar Cliente a la Venta"})]})})}function lm(){const n=Jt(),t=cr(),s=Tt(),{user:a,isAdmin:l}=vr(),u=t.pathname.includes("/shipping/new"),[d,f]=E.useState([]),[p,g]=E.useState(""),[y,x]=E.useState(u?"dropi":"efectivo"),[w,b]=E.useState(0),[S,_]=E.useState(""),[j,N]=E.useState(null),[A,T]=E.useState(u?"dropi":"local"),[$,K]=E.useState(""),[J,Z]=E.useState(0),[se,ce]=E.useState(!1),[U,te]=E.useState(null),[he,q]=E.useState(!1);E.useEffect(()=>{!l&&!u&&n("/shipping/new",{replace:!0})},[l,u]);const{data:re=[]}=Ke({queryKey:["product-variants-for-sale"],queryFn:async()=>{const{data:F}=await ue.from("product_variants").select(`
          id, size, color, sku, price, stock, image_url,
          product:products(id, name, is_active, image_url)
        `).gt("stock",0).order("product_id");return(F||[]).filter(X=>{var oe;return(oe=X.product)==null?void 0:oe.is_active})}}),ee=re.filter(F=>{var X,oe;return((X=F.product)==null?void 0:X.name.toLowerCase().includes(p.toLowerCase()))||F.size.toLowerCase().includes(p.toLowerCase())||F.color.toLowerCase().includes(p.toLowerCase())||((oe=F.sku)==null?void 0:oe.toLowerCase().includes(p.toLowerCase()))}),me=d.reduce((F,X)=>F+X.variant.price*X.quantity,0),B=Math.max(0,me-w),z=F=>{f(X=>{const oe=X.find(ge=>ge.variant.id===F.id);return oe?oe.quantity<F.stock?X.map(ge=>ge.variant.id===F.id?{...ge,quantity:ge.quantity+1}:ge):X:[...X,{variant:F,quantity:1}]}),g("")},W=(F,X)=>{f(oe=>oe.map(ge=>{if(ge.variant.id===F){const be=ge.quantity+X;if(be>0&&be<=ge.variant.stock)return{...ge,quantity:be};if(be<=0)return null}return ge}).filter(Boolean))},Q=F=>{f(X=>X.filter(oe=>oe.variant.id!==F))},P=()=>{f([]),b(0),_(""),N(null),T(u?"dropi":"local"),K(""),Z(0),x(u?"dropi":"efectivo"),q(!1)},M=Pt({mutationFn:async()=>{if(d.length===0)throw new Error("El carrito est vaco");const{data:F,error:X}=await ue.from("sales").insert({sale_date:new Date().toISOString().split("T")[0],total_amount:B,discount_amount:w,payment_method:y,notes:S||null,created_by:a==null?void 0:a.id,customer_id:j==null?void 0:j.id,shipping_type:A,shipping_status:A==="local"?"entregado":"pendiente",tracking_number:$||null,shipping_cost:J,is_electronic:se,dian_status:se?"pendiente":null}).select("id").single();if(X)throw X;const oe=d.map(be=>({sale_id:F.id,product_variant_id:be.variant.id,quantity:be.quantity,unit_price:be.variant.price,subtotal:be.variant.price*be.quantity})),{error:ge}=await ue.from("sale_items").insert(oe);if(ge)throw ge;for(const be of d){const{data:Ye}=await ue.from("product_variants").select("stock").eq("id",be.variant.id).single();Ye&&(await ue.from("product_variants").update({stock:Ye.stock-be.quantity,updated_at:new Date().toISOString()}).eq("id",be.variant.id),await ue.from("inventory_movements").insert({product_variant_id:be.variant.id,movement_type:"venta",quantity:-be.quantity,reference_id:F.id,reference_type:"sale",created_by:a==null?void 0:a.id}))}return F.id},onSuccess:()=>{s.invalidateQueries({queryKey:["sales"]}),s.invalidateQueries({queryKey:["products"]}),s.invalidateQueries({queryKey:["product-variants-for-sale"]}),q(!0)},onError:F=>{te(F.message)}}),Ne=()=>{if(te(null),se){if(!j){te("Debe seleccionar un cliente para facturacin electrnica");return}if(!j.email||!j.identification){te("El cliente seleccionado no tiene datos completos (Documento o Email) para facturacin electrnica");return}}M.mutate()},ke=F=>{var X,oe;if(F.key==="Enter"&&p){const ge=re.find(be=>{var Ye;return((Ye=be.sku)==null?void 0:Ye.toLowerCase())===p.toLowerCase()});if(ge){ge.stock>0?(z(ge),g(""),te(null)):te(`El producto "${(X=ge.product)==null?void 0:X.name}" no tiene stock`);return}if(ee.length===1){const be=ee[0];be.stock>0?(z(be),g(""),te(null)):te(`El producto "${(oe=be.product)==null?void 0:oe.name}" no tiene stock`)}}};return he?i.jsx("div",{className:"max-w-md mx-auto text-center py-12",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:i.jsx(Fu,{className:"text-green-600",size:48})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Venta Registrada!"}),i.jsx("p",{className:"text-gray-500 mb-6",children:"La venta se ha guardado correctamente y el inventario ha sido actualizado."}),i.jsxs("p",{className:"text-3xl font-bold text-green-600 mb-8",children:["$",B.toLocaleString()]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:P,className:"btn-primary flex-1",children:u?"Nuevo Envo":"Nueva Venta"}),i.jsx("button",{onClick:()=>n(u?"/shipping":"/sales"),className:"btn-secondary flex-1",children:u?"Ver Envos":"Ver Ventas"})]}),i.jsxs("button",{onClick:()=>window.open(`/print/sale/${M.data}`,"_blank"),className:"btn-secondary w-full mt-3 flex items-center justify-center gap-2",children:[i.jsx(cd,{size:20}),"Imprimir Recibo"]})]})}):i.jsxs("div",{className:"h-[calc(100vh-120px)] flex flex-col lg:flex-row gap-4",children:[i.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("button",{onClick:()=>n(u?"/shipping":"/sales"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ti,{size:24})}),i.jsx("h1",{className:"text-xl font-bold text-gray-800",children:u?"Nuevo Envo":"Nueva Venta (Local)"})]}),i.jsxs("div",{className:"relative mb-4",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar producto...",value:p,onChange:F=>g(F.target.value),onKeyDown:ke,className:"form-input pl-10",autoFocus:!0})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.values(ee.reduce((F,X)=>{var ge,be;const oe=`${X.product_id}-${X.color}`;return F[oe]||(F[oe]={id:oe,productName:(ge=X.product)==null?void 0:ge.name,color:X.color,price:X.price,image_url:X.image_url||((be=X.product)==null?void 0:be.image_url),variants:[]}),F[oe].variants.push(X),F},{})).map(F=>i.jsxs("div",{className:"card p-0 overflow-hidden flex flex-col shadow-sm hover:shadow-md transition-shadow border border-gray-100",children:[i.jsxs("div",{className:"aspect-[16/9] bg-gray-50 relative group",children:[F.image_url?i.jsx("img",{src:F.image_url,alt:"",className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx(Wt,{className:"text-gray-200",size:48})}),i.jsx("div",{className:"absolute top-2 left-2",children:i.jsx("span",{className:"bg-white/90 backdrop-blur px-2 py-0.5 rounded text-[10px] font-bold text-gray-700 shadow-sm border border-gray-100",children:F.color})}),i.jsx("div",{className:"absolute top-2 right-2",children:i.jsxs("span",{className:"bg-primary-600 text-white px-2 py-0.5 rounded text-[10px] font-bold shadow-sm",children:["$",F.price.toLocaleString()]})})]}),i.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[i.jsx("h3",{className:"font-bold text-gray-800 text-sm mb-2 truncate",children:F.productName}),i.jsx("p",{className:"text-[10px] text-gray-400 font-medium mb-2",children:"Tallas Disponibles:"}),i.jsx("div",{className:"flex flex-wrap gap-1.5 mt-auto",children:F.variants.sort((X,oe)=>parseInt(X.size)-parseInt(oe.size)).map(X=>{const oe=d.find(ge=>ge.variant.id===X.id);return i.jsxs("button",{onClick:()=>z(X),disabled:X.stock<=((oe==null?void 0:oe.quantity)||0),className:`
                                                        min-w-[32px] h-8 flex flex-col items-center justify-center rounded border transition-all
                                                        ${oe?"bg-primary-500 border-primary-600 text-white shadow-sm":"bg-white border-gray-200 text-gray-700 hover:border-primary-400 hover:text-primary-600"}
                                                        ${X.stock<=((oe==null?void 0:oe.quantity)||0)?"opacity-30 cursor-not-allowed grayscale":""}
                                                    `,title:`Stock: ${X.stock}`,children:[i.jsx("span",{className:"text-xs font-bold leading-none",children:X.size}),X.stock<5&&X.stock>0&&i.jsx("span",{className:"text-[8px] opacity-70 leading-none mt-0.5",children:X.stock})]},X.id)})})]})]},F.id))}),ee.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Io,{className:"mx-auto text-gray-300",size:48}),i.jsx("p",{className:"text-gray-500 mt-2",children:"No se encontraron productos"})]})]})]}),i.jsxs("div",{className:"lg:w-96 flex flex-col card",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(Io,{size:20}),"Carrito (",d.reduce((F,X)=>F+X.quantity,0),")"]}),U&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:U}),i.jsx("div",{className:"mb-4",children:i.jsx(Y_,{selectedCustomer:j,onSelect:N})}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Tipo de Entrega"}),i.jsx("div",{className:"grid grid-cols-3 gap-2 mb-2",children:u?i.jsx(i.Fragment,{children:[{value:"dropi",label:"Dropi",icon:i.jsx(Wt,{size:18})},{value:"contraentrega",label:"Contraentrega",icon:i.jsx(Lr,{size:18})}].map(F=>i.jsxs("button",{onClick:()=>T(F.value),className:`p-2 rounded-lg border text-sm flex flex-col items-center gap-1 transition-all ${A===F.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[F.icon,i.jsx("span",{className:"text-xs",children:F.label})]},F.value))}):i.jsxs("button",{onClick:()=>T("local"),className:"p-2 rounded-lg border border-blue-500 bg-blue-50 text-blue-700 text-sm flex flex-col items-center gap-1 col-span-3",children:[i.jsx(Io,{size:18}),i.jsx("span",{className:"text-xs",children:"Local"})]})}),A!=="local"&&i.jsxs("div",{className:"space-y-2 animate-fade-in bg-blue-50 p-3 rounded-lg border border-blue-100",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-blue-800",children:"No. Gua / Tracking"}),i.jsx("input",{value:$,onChange:F=>K(F.target.value),className:"form-input text-sm h-8",placeholder:"Ej: GUIA-12345"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-blue-800",children:"Costo Envo"}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500 text-xs",children:"$"}),i.jsx("input",{type:"number",value:J,onChange:F=>Z(Number(F.target.value)),className:"form-input text-sm h-8 pl-6",placeholder:"0"})]})]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-2 mb-4",children:d.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-400",children:[i.jsx(Io,{size:32,className:"mx-auto mb-2 opacity-50"}),i.jsx("p",{className:"text-sm",children:"Carrito vaco"})]}):d.map(F=>{var X,oe,ge;return i.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"w-10 h-10 rounded border border-gray-200 overflow-hidden flex-shrink-0 bg-white",children:F.variant.image_url||(X=F.variant.product)!=null&&X.image_url?i.jsx("img",{src:F.variant.image_url||((oe=F.variant.product)==null?void 0:oe.image_url)||void 0,alt:"",className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx(Wt,{size:16,className:"text-gray-300"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-sm truncate",children:(ge=F.variant.product)==null?void 0:ge.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[F.variant.size," - ",F.variant.color]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>W(F.variant.id,-1),className:"p-1 hover:bg-gray-200 rounded",children:i.jsx(D_,{size:16})}),i.jsx("span",{className:"w-8 text-center font-medium",children:F.quantity}),i.jsx("button",{onClick:()=>W(F.variant.id,1),className:"p-1 hover:bg-gray-200 rounded",disabled:F.quantity>=F.variant.stock,children:i.jsx(mt,{size:16})})]}),i.jsxs("span",{className:"font-medium text-sm w-20 text-right",children:["$",(F.variant.price*F.quantity).toLocaleString()]}),i.jsx("button",{onClick:()=>Q(F.variant.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:i.jsx(rl,{size:16})})]},F.variant.id)})}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Forma de Pago"}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"efectivo",label:"Efectivo",icon:i.jsx(Uu,{size:18}),hidden:u},{value:"transferencia",label:"Transf.",icon:i.jsx(zo,{size:18}),hidden:u},{value:"mixto",label:"Mixto",icon:i.jsx(Uu,{size:18}),hidden:u},{value:"dropi",label:"Dropi",icon:i.jsx(Wt,{size:18}),hidden:!u},{value:"contraentrega",label:"Contraentr.",icon:i.jsx(Lr,{size:18}),hidden:!u}].filter(F=>!F.hidden).map(F=>i.jsxs("button",{type:"button",onClick:()=>x(F.value),className:`p-2 rounded-lg border text-sm flex flex-col items-center gap-1 transition-all ${y===F.value?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[F.icon,F.label]},F.value))})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Descuento"}),i.jsx("input",{type:"number",value:w,onChange:F=>b(Number(F.target.value)),className:"form-input",min:"0",max:me})]}),i.jsxs("div",{className:"mb-4 pt-4 border-t border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"text-sm font-bold text-gray-800",children:"Facturacin Electrnica"}),i.jsx("div",{className:`w-12 h-6 rounded-full p-1 cursor-pointer transition-colors duration-200 ease-in-out ${se?"bg-primary-500":"bg-gray-300"}`,onClick:()=>ce(!se),children:i.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-sm transform transition-transform duration-200 ease-in-out ${se?"translate-x-6":"translate-x-0"}`})})]}),i.jsx("p",{className:"text-[10px] text-gray-400",children:se?"Se generar XML legal y se enviar a la DIAN. Requiere datos del cliente.":"Venta local simplificada sin reporte electrnico inmediato."})]}),i.jsxs("div",{className:"border-t pt-4 space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-500",children:"Subtotal"}),i.jsxs("span",{children:["$",me.toLocaleString()]})]}),w>0&&i.jsxs("div",{className:"flex justify-between text-sm text-red-600",children:[i.jsx("span",{children:"Descuento"}),i.jsxs("span",{children:["-$",w.toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"text-green-600",children:["$",B.toLocaleString()]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[i.jsx("button",{onClick:Ne,disabled:d.length===0||M.isPending,className:"w-full btn-success py-3 text-lg flex items-center justify-center gap-2",children:M.isPending?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner w-5 h-5 border-white/30 border-t-white"}),"Procesando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Fu,{size:20}),"Cobrar $",B.toLocaleString()]})}),d.length>0&&i.jsx("button",{onClick:P,className:"w-full btn-secondary",children:"Vaciar Carrito"})]})]})]})}function X_(){const n=Jt(),[t,s]=Mm(),[a,l]=E.useState(""),u=t.get("tab")||"standard",{data:d=[],isLoading:f}=Ke({queryKey:["customers"],queryFn:async()=>{const{data:b,error:S}=await ue.from("customers").select("*").order("full_name");if(S)throw S;return b}}),p=d.filter(b=>{const S=(b.client_type||"standard")===u,_=b.full_name.toLowerCase().includes(a.toLowerCase())||(b.identification||"").includes(a)||(b.phone||"").includes(a);return S&&_}),g=d.filter(b=>(b.client_type||"standard")==="standard").length,y=d.filter(b=>b.client_type==="shipping").length,x=b=>{s({tab:b})},w=u==="shipping";return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-serif font-bold text-gray-800",children:"Clientes"}),i.jsx("p",{className:"text-gray-500",children:w?"Clientes para envos (Dropi / Contraentrega)":"Clientes locales del almacn"})]}),i.jsxs("button",{onClick:()=>n(w?"/customers/new?type=shipping":"/customers/new"),className:`flex items-center gap-2 ${w?"bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold py-2.5 px-4 transition-all":"btn-primary"}`,children:[i.jsx(mt,{size:20}),w?"Nuevo Cliente Envo":"Nuevo Cliente"]})]}),i.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[i.jsxs("button",{onClick:()=>x("standard"),className:`flex items-center gap-2 px-4 py-2.5 font-medium text-sm border-b-2 transition-all ${u==="standard"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Wo,{size:18}),"Clientes Locales",i.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-gray-100",children:g})]}),i.jsxs("button",{onClick:()=>x("shipping"),className:`flex items-center gap-2 px-4 py-2.5 font-medium text-sm border-b-2 transition-all ${u==="shipping"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Lr,{size:18}),"Clientes Envos",i.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-gray-100",children:y})]})]}),i.jsx("div",{className:"card p-4",children:i.jsxs("div",{className:"relative max-w-md",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),i.jsx("input",{type:"text",placeholder:w?"Buscar por nombre, telfono...":"Buscar por nombre o identificacin...",className:"form-input pl-10",value:a,onChange:b=>l(b.target.value)})]})}),f?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx("div",{className:"spinner w-8 h-8 border-primary-500"})}):p.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(b=>i.jsxs("div",{className:`card p-5 hover:shadow-md transition-shadow cursor-pointer group ${w?"border-l-4 border-l-blue-400":""}`,onClick:()=>n(`/customers/${b.id}`),children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${w?"bg-blue-100 text-blue-600":"bg-secondary-100 text-secondary-600"}`,children:w?i.jsx(Lr,{size:24}):i.jsx(Gs,{size:24})}),i.jsxs("div",{className:"flex-1 ml-4 min-w-0",children:[i.jsx("h3",{className:`font-bold text-gray-800 truncate transition-colors ${w?"group-hover:text-blue-600":"group-hover:text-primary-600"}`,children:b.full_name}),b.identification&&i.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["ID: ",b.identification]})]}),i.jsx(vg,{className:`${w?"text-blue-300 group-hover:text-blue-400":"text-gray-300 group-hover:text-primary-400"}`,size:20})]}),i.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[b.phone&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ld,{size:14,className:"text-gray-400"}),i.jsx("span",{children:b.phone})]}),b.email&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(od,{size:14,className:"text-gray-400"}),i.jsx("span",{className:"truncate",children:b.email})]}),w&&b.address&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(xg,{size:14,className:"text-blue-400"}),i.jsx("span",{className:"truncate text-blue-700",children:b.address})]})]}),!w&&i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-50 flex justify-between items-center text-[10px] font-bold uppercase tracking-wider",children:i.jsx("span",{className:"text-gray-400",children:b.person_type==="1"?"Persona Jurdica":"Persona Natural"})})]},b.id))}):i.jsxs("div",{className:"card p-12 text-center text-gray-500",children:[w?i.jsx(Lr,{size:48,className:"mx-auto mb-4 opacity-20"}):i.jsx(Gs,{size:48,className:"mx-auto mb-4 opacity-20"}),i.jsxs("p",{children:["No se encontraron clientes ",w?"de envo":"locales","."]}),i.jsx("button",{onClick:()=>n(w?"/customers/new?type=shipping":"/customers/new"),className:"mt-4 text-primary-600 hover:underline",children:"+ Agregar primer cliente"})]})]})}function cm(){const{id:n}=ca(),[t]=Mm(),s=Jt(),a=Tt(),l=!!n,u=t.get("type"),[d,f]=E.useState(u||"standard"),[p,g]=E.useState({full_name:"",document_type:"13",identification:"",verification_digit:null,person_type:"2",tax_regime:"49",email:"",phone:"",address:"",municipality_code:"",department_code:"",is_active:!0,client_type:d}),{data:y,isLoading:x}=Ke({queryKey:["customer",n],queryFn:async()=>{if(!n)return null;const{data:j,error:N}=await ue.from("customers").select("*").eq("id",n).single();if(N)throw N;return j},enabled:l});E.useEffect(()=>{y&&(f(y.client_type||"standard"),g({full_name:y.full_name,document_type:y.document_type||"13",identification:y.identification||"",verification_digit:y.verification_digit,person_type:y.person_type||"2",tax_regime:y.tax_regime||"49",email:y.email||"",phone:y.phone||"",address:y.address||"",municipality_code:y.municipality_code||"",department_code:y.department_code||"",is_active:y.is_active,client_type:y.client_type||"standard"}))},[y]),E.useEffect(()=>{l||g(j=>({...j,client_type:d}))},[d,l]);const w=d==="shipping",b=Pt({mutationFn:async()=>{const j={...p,client_type:d,updated_at:new Date().toISOString()};if(l){const{error:N}=await ue.from("customers").update(j).eq("id",n);if(N)throw N}else{const{error:N}=await ue.from("customers").insert([j]);if(N)throw N}},onSuccess:()=>{a.invalidateQueries({queryKey:["customers"]}),s(w?"/customers?tab=shipping":"/customers")}}),S=j=>{j.preventDefault(),b.mutate()},_=w?"/customers?tab=shipping":"/customers";return l&&x?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx("div",{className:"spinner w-8 h-8"})}):i.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[i.jsxs("button",{onClick:()=>s(_),className:"flex items-center gap-2 text-gray-500 hover:text-primary-600 transition-colors",children:[i.jsx(ti,{size:20}),"Volver a ",w?"clientes de envos":"clientes"]}),i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-3",children:[w&&i.jsx(Lr,{className:"text-blue-500",size:28}),i.jsx("h1",{className:"text-2xl font-serif font-bold text-gray-800",children:l?w?"Editar Cliente de Envo":"Editar Cliente":w?"Nuevo Cliente de Envo":"Nuevo Cliente"})]})}),i.jsxs("form",{onSubmit:S,className:"space-y-6",children:[i.jsxs("div",{className:"card p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-100 mb-4",children:[w?i.jsx(Lr,{className:"text-blue-500",size:20}):i.jsx(Gs,{className:"text-primary-500",size:20}),i.jsx("h2",{className:"font-bold text-gray-800",children:w?"Datos del Destinatario":"Informacin Bsica"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Nombre Completo *"}),i.jsx("input",{type:"text",required:!0,className:"form-input",placeholder:"Ej: Juan Prez",value:p.full_name,onChange:j=>g({...p,full_name:j.target.value})})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Telfono / Celular *"}),i.jsxs("div",{className:"relative",children:[i.jsx(ld,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),i.jsx("input",{type:"tel",required:!0,className:"form-input pl-10",placeholder:"Ej: 300 123 4567",value:p.phone||"",onChange:j=>g({...p,phone:j.target.value})})]})]}),w&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Direccin de Entrega *"}),i.jsxs("div",{className:"relative",children:[i.jsx(xg,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),i.jsx("input",{type:"text",required:!0,className:"form-input pl-10",placeholder:"Ej: Calle 123 #45-67, Barrio, Ciudad",value:p.address||"",onChange:j=>g({...p,address:j.target.value})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-xs font-medium text-gray-500",children:["Identificacin ",w?"*":i.jsx("span",{className:"text-gray-400 font-normal",children:"(Opcional)"})]}),i.jsx("input",{type:"text",required:w,className:"form-input",placeholder:"Cdula o NIT",value:p.identification||"",onChange:j=>g({...p,identification:j.target.value})})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-xs font-medium text-gray-500",children:["Correo Electrnico ",i.jsx("span",{className:"text-gray-400 font-normal",children:"(Opcional)"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(od,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),i.jsx("input",{type:"email",className:"form-input pl-10",placeholder:"correo@ejemplo.com",value:p.email||"",onChange:j=>g({...p,email:j.target.value})})]})]})]}),!w&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Tipo de Persona"}),i.jsxs("div",{className:"flex gap-4 pt-1",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"radio",name:"person_type",value:"2",checked:p.person_type==="2",onChange:()=>g({...p,person_type:"2"}),className:"text-primary-600 focus:ring-primary-500"}),i.jsx("span",{className:"text-sm",children:"Persona Natural"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"radio",name:"person_type",value:"1",checked:p.person_type==="1",onChange:()=>g({...p,person_type:"1"}),className:"text-primary-600 focus:ring-primary-500"}),i.jsx("span",{className:"text-sm",children:"Persona Jurdica (Empresa)"})]})]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[i.jsx("button",{type:"button",onClick:()=>s(_),className:"btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:b.isPending,className:`flex items-center gap-2 px-8 ${w?"bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold py-2.5 transition-all":"btn-primary"}`,children:b.isPending?i.jsx("div",{className:"spinner w-5 h-5 border-white"}):i.jsxs(i.Fragment,{children:[i.jsx(ha,{size:20}),l?"Actualizar":"Guardar"]})})]})]})]})}function Z_({isOpen:n,onClose:t,onOpen:s}){const[a,l]=E.useState(""),[u,d]=E.useState(""),[f,p]=E.useState(!1);if(!n)return null;const g=async y=>{y.preventDefault(),p(!0);try{await s(Number(a),u),t()}catch(x){console.error(x)}finally{p(!1)}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-fade-in",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[i.jsx(Ks,{className:"text-green-600",size:20}),"Apertura de Caja"]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:i.jsx(Wn,{size:20})})]}),i.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[i.jsx("div",{className:"bg-blue-50 text-blue-800 p-3 rounded-lg text-sm mb-4",children:"Ingresa el monto de dinero con el que inicias el da (Base)."}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Monto Inicial (Base)"}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),i.jsx("input",{type:"number",required:!0,min:"0",step:"100",value:a,onChange:y=>l(y.target.value),className:"form-input pl-8 text-lg font-bold",placeholder:"0",autoFocus:!0})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notas (Opcional)"}),i.jsx("textarea",{value:u,onChange:y=>d(y.target.value),className:"form-input min-h-[80px]",placeholder:"Ej: Billetes de baja denominacin..."})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{type:"button",onClick:t,className:"flex-1 btn-secondary",disabled:f,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:f||!a,children:f?"Abriendo...":"Abrir Caja"})]})]})]})})}function ej({isOpen:n,onClose:t,onSave:s}){const[a,l]=E.useState(""),[u,d]=E.useState(""),[f,p]=E.useState("otros"),[g,y]=E.useState(!1);if(!n)return null;const x=async w=>{w.preventDefault(),y(!0);try{await s(u,Number(a),f),t(),l(""),d(""),p("otros")}catch(b){console.error(b)}finally{y(!1)}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-fade-in",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-red-50",children:[i.jsxs("h3",{className:"text-lg font-bold text-red-700 flex items-center gap-2",children:[i.jsx(Ws,{size:20}),"Registrar Gasto"]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:i.jsx(Wn,{size:20})})]}),i.jsxs("form",{onSubmit:x,className:"p-6 space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Monto del Gasto"}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"}),i.jsx("input",{type:"number",required:!0,min:"0",step:"100",value:a,onChange:w=>l(w.target.value),className:"form-input pl-8 text-lg font-bold border-red-200 focus:ring-red-500 focus:border-red-500",placeholder:"0",autoFocus:!0})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Descripcin"}),i.jsx("input",{type:"text",required:!0,value:u,onChange:w=>d(w.target.value),className:"form-input",placeholder:"Ej: Pago de almuerzo, Taxi..."})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Categora"}),i.jsxs("select",{value:f,onChange:w=>p(w.target.value),className:"form-select",children:[i.jsx("option",{value:"otros",children:"Otros"}),i.jsx("option",{value:"proveedor",children:"Proveedor"}),i.jsx("option",{value:"servicios",children:"Servicios"}),i.jsx("option",{value:"personal",children:"Personal"})]})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{type:"button",onClick:t,className:"flex-1 btn-secondary",disabled:g,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-sm hover:shadow-md disabled:opacity-50",disabled:g||!a||!u,children:g?"Guardando...":"Registrar Salida"})]})]})]})})}function tj(){const{user:n}=vr(),t=Tt(),[s,a]=E.useState(new Date().toISOString().split("T")[0]),[l,u]=E.useState(!1),[d,f]=E.useState(!1),[p,g]=E.useState(null),{data:y,isLoading:x}=Ke({queryKey:["cash-register","current"],queryFn:async()=>{const{data:U}=await ue.from("cash_registers").select("*").eq("status","open").single();return U},retry:!1}),{data:w=[],isLoading:b}=Ke({queryKey:["daily-cash",s],queryFn:async()=>{const{data:U,error:te}=await ue.from("sales").select("*").gte("sale_date",s).lte("sale_date",s).order("created_at",{ascending:!1});if(te)throw te;return U}}),{data:S=[]}=Ke({queryKey:["expenses",s],queryFn:async()=>{const{data:U}=await ue.from("expenses").select("*").gte("expense_date",s).gte("expense_date",`${s}T00:00:00`).lte("expense_date",`${s}T23:59:59`);return U||[]}}),_=Pt({mutationFn:async({amount:U,notes:te})=>{if(!n)throw new Error("No user");const{error:he}=await ue.from("cash_registers").insert({opening_amount:U,notes:te||null,opened_by:n.id,status:"open"});if(he)throw he},onSuccess:()=>{t.invalidateQueries({queryKey:["cash-register"]}),g("Caja abierta correctamente"),setTimeout(()=>g(null),3e3)}}),j=Pt({mutationFn:async U=>{const te=w.filter(ee=>ee.payment_method==="efectivo").reduce((ee,me)=>ee+me.total_amount,0),he=S.reduce((ee,me)=>ee+me.amount,0),q=((y==null?void 0:y.opening_amount)||0)+te-he,{error:re}=await ue.from("cash_registers").update({status:"closed",closing_amount:q,expected_amount:q,closed_at:new Date().toISOString()}).eq("id",U);if(re)throw re},onSuccess:()=>{t.invalidateQueries({queryKey:["cash-register"]}),g("Caja cerrada correctamente"),setTimeout(()=>g(null),3e3)}}),N=Pt({mutationFn:async({description:U,amount:te,category:he})=>{if(!n)return;const{error:q}=await ue.from("expenses").insert({description:U,amount:te,category:he,user_id:n.id,cash_register_id:y==null?void 0:y.id,expense_date:new Date().toISOString()});if(q)throw q},onSuccess:()=>{t.invalidateQueries({queryKey:["expenses"]}),g("Gasto registrado"),setTimeout(()=>g(null),3e3)}}),A=w.reduce((U,te)=>U+te.total_amount,0),T=S.reduce((U,te)=>U+te.amount,0),$=w.reduce((U,te)=>U+(te.discount_amount||0),0),K={efectivo:w.filter(U=>U.payment_method==="efectivo").reduce((U,te)=>U+te.total_amount,0),tarjeta:w.filter(U=>U.payment_method==="tarjeta").reduce((U,te)=>U+te.total_amount,0),transferencia:w.filter(U=>U.payment_method==="transferencia").reduce((U,te)=>U+te.total_amount,0),mixto:w.filter(U=>U.payment_method==="mixto").reduce((U,te)=>U+te.total_amount,0),dropi:w.filter(U=>U.payment_method==="dropi").reduce((U,te)=>U+te.total_amount,0),contraentrega:w.filter(U=>U.payment_method==="contraentrega").reduce((U,te)=>U+te.total_amount,0)},J=((y==null?void 0:y.opening_amount)||0)+(K.efectivo||0)-T,Z={efectivo:{label:"Efectivo",icon:i.jsx(Uu,{size:24}),color:"bg-green-100 text-green-600"},tarjeta:{label:"Tarjeta",icon:i.jsx(C_,{size:24}),color:"bg-blue-100 text-blue-600"},transferencia:{label:"Transferencia",icon:i.jsx(zo,{size:24}),color:"bg-purple-100 text-purple-600"},mixto:{label:"Mixto",icon:i.jsx(Ks,{size:24}),color:"bg-orange-100 text-orange-600"},dropi:{label:"Dropi",icon:i.jsx(zo,{size:24}),color:"bg-indigo-100 text-indigo-600"},contraentrega:{label:"Contraentrega",icon:i.jsx(zo,{size:24}),color:"bg-indigo-100 text-indigo-600"}},se=U=>new Date(U+"T12:00:00").toLocaleDateString("es-CO",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ce=U=>new Date(U).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"});return x||b?i.jsx("div",{className:"flex h-96 items-center justify-center",children:i.jsx("div",{className:"spinner w-8 h-8 border-primary-500 border-t-transparent"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsx(Z_,{isOpen:l,onClose:()=>u(!1),onOpen:async(U,te)=>{await _.mutateAsync({amount:U,notes:te})}}),i.jsx(ej,{isOpen:d,onClose:()=>f(!1),onSave:async(U,te,he)=>{await N.mutateAsync({description:U,amount:te,category:he})}}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Caja Diaria"}),i.jsx("p",{className:"text-gray-500",children:"Resumen y Control de Caja"})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gg,{size:20,className:"text-gray-400"}),i.jsx("input",{type:"date",value:s,onChange:U=>a(U.target.value),className:"form-input w-auto h-10"})]})})]}),p&&i.jsx("div",{className:"bg-green-100 border border-green-200 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:p}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:`card border-l-4 ${y?"border-l-green-500":"border-l-red-500"}`,children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Estado de Caja"}),i.jsx("h3",{className:`text-2xl font-bold mt-1 ${y?"text-green-600":"text-red-500"}`,children:y?"ABIERTA":"CERRADA"}),y&&i.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Abierta a las ",ce(y.opened_at)]})]}),i.jsx("div",{className:`p-2 rounded-full ${y?"bg-green-100 text-green-600":"bg-red-100 text-red-500"}`,children:y?i.jsx(O_,{size:24}):i.jsx(A_,{size:24})})]}),i.jsxs("div",{className:"mt-4",children:[y?i.jsx("button",{onClick:()=>j.mutate(y.id),disabled:j.isPending,className:"btn-secondary w-full text-sm py-1.5",children:j.isPending?"Cerrando...":"Cerrar Caja"}):i.jsx("button",{onClick:()=>u(!0),className:"btn-primary w-full text-sm py-1.5",children:"Abrir Caja"}),i.jsx("div",{className:"mt-2 text-center",children:i.jsx("button",{onClick:()=>f(!0),disabled:!y,className:"text-xs text-red-600 font-medium hover:underline disabled:opacity-50 disabled:no-underline",children:"Registrar Salida / Gasto"})})]})]}),i.jsxs("div",{className:"card",children:[i.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Base Inicial"}),i.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mt-1",children:["$",((y==null?void 0:y.opening_amount)||0).toLocaleString()]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Dinero al inicio del turno"})]}),i.jsxs("div",{className:"card bg-gray-900 text-white relative overflow-hidden",children:[i.jsxs("div",{className:"relative z-10",children:[i.jsx("p",{className:"text-gray-400 text-sm font-medium uppercase tracking-wider",children:"Dinero en Caja"}),i.jsxs("h3",{className:"text-3xl font-bold text-white mt-1",children:["$",J.toLocaleString()]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Base + Ventas - Gastos"})]}),T>0&&i.jsx("div",{className:"absolute right-0 top-0 p-3",children:i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-red-400 text-xs font-bold uppercase",children:"Gastos"}),i.jsxs("p",{className:"text-red-400 font-bold",children:["-$",T.toLocaleString()]})]})})]})]}),i.jsx("div",{className:"card bg-gradient-to-r from-primary-600 to-primary-700 text-white",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-primary-100 capitalize",children:se(s)}),i.jsxs("p",{className:"text-4xl font-bold mt-2",children:["$",A.toLocaleString()]}),i.jsxs("p",{className:"text-primary-100 mt-1",children:[w.length," ",w.length===1?"venta":"ventas",$>0&&`  $${$.toLocaleString()} en descuentos`]})]}),i.jsxs("div",{className:"bg-white/10 px-4 py-2 rounded-lg text-center backdrop-blur-sm",children:[i.jsx("p",{className:"text-xs uppercase tracking-wider mb-1",children:"Total Calculado"}),i.jsxs("p",{className:"text-xl font-bold",children:["$",A.toLocaleString()]})]})]})}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.keys(K).map(U=>{const te=Z[U],he=K[U],q=w.filter(re=>re.payment_method===U).length;return i.jsx("div",{className:"card",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${te.color}`,children:te.icon}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:te.label}),i.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["$",he.toLocaleString()]}),i.jsxs("p",{className:"text-xs text-gray-400",children:[q," ventas"]})]})]})},U)})}),w.length>0&&i.jsxs("div",{className:"card",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4 px-2",children:"Detalle de Movimientos"}),i.jsx("div",{className:"table-container",children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Hora"}),i.jsx("th",{children:"Forma de Pago"}),i.jsx("th",{className:"text-right",children:"Descuento"}),i.jsx("th",{className:"text-right",children:"Total"})]})}),i.jsx("tbody",{children:w.map(U=>i.jsxs("tr",{children:[i.jsx("td",{className:"font-medium",children:ce(U.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`badge ${U.payment_method==="efectivo"?"badge-success":U.payment_method==="tarjeta"?"badge-info":U.payment_method==="transferencia"?"bg-purple-100 text-purple-800":"badge-warning"}`,children:Z[U.payment_method].label})}),i.jsx("td",{className:"text-right text-gray-500",children:(U.discount_amount||0)>0&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Descuento:"}),i.jsxs("span",{children:["-$",(U.discount_amount||0).toLocaleString()]})]})}),i.jsxs("td",{className:"text-right font-semibold",children:["$",U.total_amount.toLocaleString()]})]},U.id))})]})})]})]})}function rj(){const[n,t]=E.useState("week"),s=_=>{const j=new Date,N=new Date,A=new Date;switch(_){case"week":A.setDate(j.getDate()-7);break;case"month":A.setMonth(j.getMonth()-1);break;case"lastMonth":A.setMonth(j.getMonth()-1),A.setDate(1),N.setDate(0);break}return{start:A,end:N}},a=s("week"),[l,u]=E.useState(a.start.toISOString().split("T")[0]),[d,f]=E.useState(a.end.toISOString().split("T")[0]),p=_=>{if(t(_),_!=="custom"){const{start:j,end:N}=s(_);u(j.toISOString().split("T")[0]),f(N.toISOString().split("T")[0])}},{data:g,isLoading:y}=Ke({queryKey:["reports",l,d],queryFn:async()=>{const _=`${l}T00:00:00`,j=`${d}T23:59:59`,{data:N}=await ue.from("sales").select("*, customer:customers(full_name)").gte("sale_date",_).lte("sale_date",j).order("sale_date"),{data:A}=await ue.from("purchases").select("*, supplier:suppliers(name)").gte("purchase_date",_).lte("purchase_date",j).order("purchase_date"),{data:T}=await ue.from("sale_items").select(`
                    quantity,
                    subtotal,
                    product_variant:product_variants(
                        sku,
                        product:products(name)
                    )
                `).gte("created_at",_).lte("created_at",j),{data:$}=await ue.from("product_variants").select("stock, min_stock, product:products(name)"),K=($==null?void 0:$.filter(he=>he.stock<=(he.min_stock||5)))||[],J={};N==null||N.forEach(he=>{const q=he.sale_date.split("T")[0];J[q]=(J[q]||0)+he.total_amount});const Z={};T==null||T.forEach(he=>{var ee,me,B;const q=((me=(ee=he.product_variant)==null?void 0:ee.product)==null?void 0:me.name)||"Desconocido",re=((B=he.product_variant)==null?void 0:B.sku)||"N/A";Z[q]||(Z[q]={qty:0,revenue:0,sku:re}),Z[q].qty+=he.quantity,Z[q].revenue+=he.subtotal});const se=Object.entries(Z).map(([he,q])=>({name:he,...q})).sort((he,q)=>q.qty-he.qty).slice(0,10),ce=(N==null?void 0:N.reduce((he,q)=>he+q.total_amount,0))||0,U=(A==null?void 0:A.reduce((he,q)=>he+q.total_amount,0))||0,te=[...N||[],...A||[]].sort((he,q)=>new Date(q.created_at).getTime()-new Date(he.created_at).getTime()).slice(0,5);return{sales:N,purchases:A,salesByDay:J,topProducts:se,lowStock:K,totalSales:ce,totalPurchases:U,netProfit:ce-U,recentTransactions:te}}}),x=()=>{var j;if(!((j=g==null?void 0:g.sales)!=null&&j.length))return;const _=g.sales.map(N=>{var A;return{ID:N.id,Fecha:new Date(N.sale_date).toLocaleDateString(),Cliente:((A=N.customer)==null?void 0:A.full_name)||"C. Final",Tipo:N.shipping_type,Mtodo:N.payment_method,Subtotal:N.total_amount+N.discount_amount,Descuento:N.discount_amount,Total:N.total_amount}});As(_,`reporte_ventas_${l}_a_${d}`)},w=()=>{var j;if(!((j=g==null?void 0:g.purchases)!=null&&j.length))return;const _=g.purchases.map(N=>{var A;return{ID:N.id,Fecha:new Date(N.purchase_date).toLocaleDateString(),Proveedor:((A=N.supplier)==null?void 0:A.name)||"Varios",Factura:N.invoice_number||"N/A",Estado:N.status,Total:N.total_amount}});As(_,`reporte_compras_${l}_a_${d}`)},b=()=>{var j;if(!((j=g==null?void 0:g.topProducts)!=null&&j.length))return;const _=g.topProducts.map(N=>({Producto:N.name,SKU:N.sku,"Cant. Vendida":N.qty,"Ventas Generadas":N.revenue}));As(_,`reporte_productos_${l}_a_${d}`)};if(y||!g)return i.jsxs("div",{className:"p-12 text-center text-gray-400 flex flex-col items-center gap-4",children:[i.jsx("div",{className:"spinner"}),"Cargando estadsticas detalladas..."]});const S=Math.max(...Object.values(g.salesByDay),1);return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Business Intelligence"}),i.jsx("p",{className:"text-gray-500",children:"Anlisis detallado de ventas, compras y rendimiento"})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{className:"flex bg-white rounded-xl border p-1 shadow-sm",children:[i.jsx("button",{onClick:()=>p("week"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${n==="week"?"bg-primary-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:"7D"}),i.jsx("button",{onClick:()=>p("month"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${n==="month"?"bg-primary-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:"MES"}),i.jsx("button",{onClick:()=>p("lastMonth"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${n==="lastMonth"?"bg-primary-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:"PASADO"}),i.jsx("button",{onClick:()=>t("custom"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${n==="custom"?"bg-primary-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:"LIBRE"})]}),n==="custom"&&i.jsxs("div",{className:"flex items-center gap-2 animate-fade-in bg-white p-1 rounded-xl border shadow-sm",children:[i.jsx("input",{type:"date",value:l,onChange:_=>u(_.target.value),className:"border-none text-xs focus:ring-0 p-2"}),i.jsx("span",{className:"text-gray-300",children:"-"}),i.jsx("input",{type:"date",value:d,onChange:_=>f(_.target.value),className:"border-none text-xs focus:ring-0 p-2"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:x,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 text-gray-600 transition-all flex items-center gap-2 text-sm font-bold",title:"Exportar Ventas",children:[i.jsx(Os,{size:18,className:"text-green-600"}),"Ventas"]}),i.jsxs("button",{onClick:w,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 text-gray-600 transition-all flex items-center gap-2 text-sm font-bold",title:"Exportar Compras",children:[i.jsx(Os,{size:18,className:"text-orange-600"}),"Compras"]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{className:"card border-l-4 border-l-green-500 py-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-2xl flex items-center justify-center text-green-600",children:i.jsx(nm,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Ingresos"}),i.jsxs("p",{className:"text-2xl font-black text-gray-800",children:["$",g.totalSales.toLocaleString()]})]})]})}),i.jsx("div",{className:"card border-l-4 border-l-orange-500 py-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-2xl flex items-center justify-center text-orange-600",children:i.jsx(rm,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Egresos (Compras)"}),i.jsxs("p",{className:"text-2xl font-black text-gray-800",children:["$",g.totalPurchases.toLocaleString()]})]})]})}),i.jsx("div",{className:"card border-l-4 border-l-blue-600 py-6 bg-blue-50/30",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-blue-200",children:i.jsx(Ks,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-bold text-blue-600 uppercase tracking-widest",children:"Utilidad Estimada"}),i.jsxs("p",{className:`text-2xl font-black ${g.netProfit>=0?"text-green-700":"text-red-700"}`,children:["$",g.netProfit.toLocaleString()]})]})]})}),i.jsx("div",{className:"card border-l-4 border-l-red-500 py-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-2xl flex items-center justify-center text-red-600",children:i.jsx(ra,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Stock Crtico"}),i.jsx("p",{className:"text-2xl font-black text-gray-800",children:g.lowStock.length})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"card lg:col-span-2",children:[i.jsxs("div",{className:"flex items-center justify-between mb-8",children:[i.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[i.jsx(gg,{size:18,className:"text-primary-500"}),"Fluidez de Ventas Diaria"]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[i.jsx("span",{className:"w-3 h-3 bg-primary-500 rounded-full"})," Ventas"]})]}),i.jsx("div",{className:"h-64 flex items-end justify-between gap-2 pt-10",children:Object.entries(g.salesByDay).length===0?i.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-300 gap-2",children:[i.jsx(qu,{size:48,className:"opacity-20"}),i.jsx("p",{className:"font-bold italic",children:"Sin movimientos en este periodo"})]}):Object.entries(g.salesByDay).map(([_,j])=>i.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group relative",children:[i.jsx("div",{className:"w-full bg-primary-400 rounded-t-lg hover:bg-primary-600 transition-all cursor-crosshair relative shadow-sm",style:{height:`${j/S*100}%`},children:i.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-[10px] font-bold px-3 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity z-10 shadow-xl pointer-events-none",children:["$",j.toLocaleString()]})}),i.jsx("p",{className:"text-[10px] text-gray-400 font-bold rotate-45 mt-4 origin-left truncate w-6",children:_.split("-").slice(1).join("/")})]},_))})]}),i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[i.jsx(Wt,{size:18,className:"text-orange-500"}),"Top Productos"]}),i.jsxs("button",{onClick:b,className:"text-primary-600 hover:text-primary-700 text-xs font-bold flex items-center gap-1",children:["Ver reporte ",i.jsx(Os,{size:14})]})]}),i.jsxs("div",{className:"space-y-4",children:[g.topProducts.map((_,j)=>i.jsxs("div",{className:"flex flex-col gap-1.5 bg-gray-50/50 p-3 rounded-xl border border-gray-100/50",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[i.jsx("span",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${j===0?"bg-yellow-400 text-black shadow-md":j===1?"bg-gray-300 text-gray-800":j===2?"bg-orange-300 text-orange-900":"bg-white text-gray-400 border border-gray-200"}`,children:j+1}),i.jsx("span",{className:"font-bold text-gray-700 text-xs truncate max-w-[140px]",children:_.name})]}),i.jsxs("span",{className:"font-black text-gray-800 text-xs",children:[_.qty," un."]})]}),i.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full transition-all duration-1000 ${j===0?"bg-yellow-400":"bg-primary-500"}`,style:{width:`${_.qty/g.topProducts[0].qty*100}%`}})}),i.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-gray-400 uppercase tracking-tighter",children:[i.jsx("span",{children:"Revenue Total"}),i.jsxs("span",{className:"text-green-600",children:["$",_.revenue.toLocaleString()]})]})]},_.name)),g.topProducts.length===0&&i.jsx("div",{className:"text-center py-10 opacity-30 italic text-sm",children:"Escasez de informacin"})]})]}),i.jsxs("div",{className:"card lg:col-span-2",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-6 flex items-center gap-2",children:[i.jsx(qu,{size:18,className:"text-blue-500"}),"Transacciones Recientes"]}),i.jsxs("div",{className:"space-y-2",children:[g.recentTransactions.map(_=>{var N,A;const j=!!_.sale_date;return i.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-100 rounded-xl hover:bg-gray-50 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${j?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:j?i.jsx(nm,{size:20}):i.jsx(rm,{size:20})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-bold text-gray-800 text-sm",children:j?((N=_.customer)==null?void 0:N.full_name)||"Venta Local":((A=_.supplier)==null?void 0:A.name)||"Compra Stock"}),i.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:[new Date(j?_.sale_date:_.purchase_date).toLocaleDateString(),"  ",_.payment_method||_.status]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:`font-black text-sm ${j?"text-green-600":"text-orange-600"}`,children:[j?"+":"-","$",_.total_amount.toLocaleString()]}),i.jsxs("p",{className:"text-[10px] font-mono text-gray-300",children:["ID: ",_.id.slice(0,8)]})]})]},_.id)}),g.recentTransactions.length===0&&i.jsx("p",{className:"text-center py-6 text-gray-400 italic",children:"No hay historial reciente en este rango"})]})]}),i.jsxs("div",{className:"card",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-6 flex items-center gap-2 text-red-600",children:[i.jsx(ra,{size:18}),"Alertas Crticas (",g.lowStock.length,")"]}),i.jsxs("div",{className:"space-y-3",children:[g.lowStock.slice(0,4).map((_,j)=>{var N,A;return i.jsxs("div",{className:"p-3 border border-red-100 bg-red-50/50 rounded-xl flex justify-between items-center group hover:bg-red-50 transition-colors",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("p",{className:"font-bold text-gray-800 text-xs truncate",title:(N=_.product)==null?void 0:N.name,children:(A=_.product)==null?void 0:A.name}),i.jsxs("p",{className:"text-[10px] font-bold text-red-400 uppercase",children:["Mnimo requerido: ",_.min_stock||5]})]}),i.jsx("div",{className:"bg-white w-8 h-8 rounded-lg flex items-center justify-center text-red-600 font-black border border-red-100 shadow-sm text-xs",children:_.stock})]},j)}),g.lowStock.length>4&&i.jsxs("p",{className:"text-center text-[10px] font-bold text-gray-400 tracking-tighter",children:["Y ",g.lowStock.length-4," variantes ms en riesgo..."]}),g.lowStock.length===0&&i.jsxs("div",{className:"bg-green-50 p-6 rounded-2xl flex flex-col items-center gap-2 border border-green-100",children:[i.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white shadow-lg",children:i.jsx(ad,{size:24})}),i.jsx("p",{className:"font-bold text-green-700 text-sm",children:"Sin Riesgos de Quiebre"})]})]})]})]})]})}function nj(){var a;const{id:n}=ca(),{data:t,isLoading:s}=Ke({queryKey:["sale",n],queryFn:async()=>{if(!n)return null;const{data:l,error:u}=await ue.from("sales").select(`
                    *,
                    items:sale_items(
                        *,
                        product_variant:product_variants(
                            product:products(name),
                            size,
                            color
                        )
                    ),
                    customer:customers(full_name, phone)
                `).eq("id",n).single();if(u)throw u;return l},enabled:!!n});return E.useEffect(()=>{t&&setTimeout(()=>{window.print()},500)},[t]),s?i.jsx("div",{className:"p-4 text-center",children:"Cargando recibo..."}):t?i.jsxs("div",{className:"bg-white text-black font-mono text-sm p-4 w-[80mm] mx-auto min-h-screen",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("img",{src:"/logo.jpg",alt:"Sophi Shoes",className:"w-24 h-24 mx-auto mb-2 object-contain grayscale"}),i.jsx("h1",{className:"text-xl font-bold uppercase",children:"Sophi Shoes"}),i.jsx("p",{children:"NIT: 123456789"}),i.jsx("p",{children:"Cc Maracay local 58"}),i.jsx("p",{children:"Tel: 3164726085"})]}),i.jsxs("div",{className:"mb-4 border-b border-dashed border-black pb-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Recibo:"})," #",t.id.slice(0,8)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Fecha:"})," ",new Date(t.created_at).toLocaleString("es-CO")]}),t.customer&&i.jsxs("p",{children:[i.jsx("strong",{children:"Cliente:"})," ",t.customer.full_name]})]}),i.jsxs("table",{className:"w-full mb-4",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-dashed border-black text-left",children:[i.jsx("th",{className:"py-1",children:"Cant."}),i.jsx("th",{className:"py-1",children:"Desc."}),i.jsx("th",{className:"py-1 text-right",children:"Total"})]})}),i.jsx("tbody",{children:(a=t.items)==null?void 0:a.map(l=>{var u,d,f,p;return i.jsxs("tr",{children:[i.jsx("td",{className:"align-top py-1",children:l.quantity}),i.jsxs("td",{className:"align-top py-1",children:[(d=(u=l.product_variant)==null?void 0:u.product)==null?void 0:d.name,i.jsxs("div",{className:"text-xs",children:[(f=l.product_variant)==null?void 0:f.size," / ",(p=l.product_variant)==null?void 0:p.color]})]}),i.jsxs("td",{className:"align-top text-right py-1",children:["$",(l.unit_price*l.quantity).toLocaleString()]})]},l.id)})})]}),i.jsxs("div",{className:"border-t border-dashed border-black pt-2 mb-4 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["$",(t.total_amount+(t.discount_amount||0)).toLocaleString()]})]}),(t.discount_amount||0)>0&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Descuento:"}),i.jsxs("span",{children:["-$",(t.discount_amount||0).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-black pt-1 mt-1",children:[i.jsx("span",{children:"TOTAL:"}),i.jsxs("span",{children:["$",t.total_amount.toLocaleString()]})]}),i.jsx("div",{className:"flex justify-between text-xs mt-2",children:i.jsxs("span",{children:["Pago: ",t.payment_method]})})]}),i.jsxs("div",{className:"text-center text-xs mt-8",children:[i.jsx("p",{children:"Gracias por su compra!"}),i.jsx("p",{children:"No se aceptan devoluciones despus de 30 das."})]}),i.jsx("style",{children:`
                    @media print {
                        @page { margin: 0; size: 80mm auto; }
                        body { margin: 0; }
                    }
                `})]}):i.jsx("div",{className:"p-4 text-center text-red-500",children:"Recibo no encontrado"})}function sj(){const[n,t]=E.useState(""),s=Tt(),{data:a=[],isLoading:l}=Ke({queryKey:["profiles"],queryFn:async()=>{const{data:p,error:g}=await ue.from("profiles").select("*").order("full_name");if(g)throw g;return p}}),u=Pt({mutationFn:async p=>{const{error:g}=await ue.from("profiles").delete().eq("id",p);if(g)throw g},onSuccess:()=>{s.invalidateQueries({queryKey:["profiles"]})}}),d=a.filter(p=>{var g;return((g=p.full_name)==null?void 0:g.toLowerCase().includes(n.toLowerCase()))||p.email.toLowerCase().includes(n.toLowerCase())}),f=(p,g)=>{window.confirm(`Ests seguro de eliminar a ${g}? Esta accin solo borra su perfil de datos, el acceso debe revocarse en Supabase.`)&&u.mutate(p)};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Cuentas y Vendedores"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Gestiona quin tiene acceso al sistema y sus roles"})]}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600",children:i.jsx(Uo,{size:20})}),i.jsxs("div",{className:"text-sm",children:[i.jsx("p",{className:"font-bold text-blue-900",children:"Nuevo Vendedor?"}),i.jsx("p",{className:"text-blue-700 text-xs",children:"Regstralo primero en Supabase Auth"})]})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:i.jsxs("div",{className:"relative w-full md:w-96",children:[i.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Buscar por nombre o email...",className:"form-input pl-10",value:n,onChange:p=>t(p.target.value)})]})}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:l?i.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"Cargando usuarios..."}):d.length===0?i.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"No se encontraron usuarios"}):d.map(p=>i.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${p.role==="admin"?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600"}`,children:p.role==="admin"?i.jsx(bg,{size:24}):i.jsx(Gs,{size:24})}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("h3",{className:"font-bold text-gray-800 truncate",children:p.full_name||"Sin nombre"}),i.jsx("p",{className:"text-xs text-secondary-600 font-medium uppercase tracking-wider",children:p.role})]})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx(wt,{to:`/users/${p.id}`,className:"p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",children:i.jsx(ud,{size:18})}),i.jsx("button",{onClick:()=>f(p.id,p.full_name||p.email),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:i.jsx(rl,{size:18})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{className:"text-gray-400",children:"Email:"}),i.jsx("span",{className:"text-gray-700 font-medium",children:p.email})]}),i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{className:"text-gray-400",children:"Creado:"}),i.jsx("span",{className:"text-gray-700 font-medium",children:p.created_at?new Date(p.created_at).toLocaleDateString():"N/A"})]})]})]},p.id))})]})}function ij(){const{id:n}=ca(),t=Jt(),s=Tt(),[a,l]=E.useState({full_name:"",role:"vendedor"}),[u,d]=E.useState(null),{data:f,isLoading:p}=Ke({queryKey:["profile",n],queryFn:async()=>{if(!n)return null;const{data:x,error:w}=await ue.from("profiles").select("*").eq("id",n).single();if(w)throw w;return x},enabled:!!n});E.useEffect(()=>{f&&l({full_name:f.full_name||"",role:f.role})},[f]);const g=Pt({mutationFn:async()=>{const{error:x}=await ue.from("profiles").update({full_name:a.full_name,role:a.role,updated_at:new Date().toISOString()}).eq("id",n);if(x)throw x},onSuccess:()=>{s.invalidateQueries({queryKey:["profiles"]}),t("/users")},onError:x=>{d(x.message)}}),y=x=>{x.preventDefault(),d(null),g.mutate()};return p?i.jsx("div",{className:"text-center py-12 text-gray-400",children:"Cargando..."}):i.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t("/users"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ti,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Editar Perfil de Usuario"}),i.jsx("p",{className:"text-gray-500",children:"Configura el nombre y rol del sistema"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("form",{onSubmit:y,className:"card space-y-6",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center text-primary-600",children:i.jsx(bg,{size:40})})}),u&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:u}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Nombre Completo"}),i.jsx("input",{type:"text",required:!0,value:a.full_name,onChange:x=>l({...a,full_name:x.target.value}),className:"form-input",placeholder:"Nombre del vendedor"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Rol del Sistema"}),i.jsxs("select",{value:a.role,onChange:x=>l({...a,role:x.target.value}),className:"form-select",children:[i.jsx("option",{value:"vendedor",children:"Vendedor (Acceso limitado a envos)"}),i.jsx("option",{value:"admin",children:"Administrador (Acceso total)"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Email (Bloqueado)"}),i.jsx("input",{type:"email",disabled:!0,value:(f==null?void 0:f.email)||"",className:"form-input bg-gray-50 text-gray-400 cursor-not-allowed"}),i.jsx("p",{className:"text-[10px] text-gray-400 mt-1 italic",children:"El email no se puede cambiar ya que est vinculado al acceso de Supabase."})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t font-bold font-sans",children:[i.jsx("button",{type:"button",onClick:()=>t("/users"),className:"btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",disabled:g.isPending,className:"btn-primary flex items-center gap-2",children:g.isPending?"Guardando...":i.jsxs(i.Fragment,{children:[i.jsx(ha,{size:20})," Guardar Cambios"]})})]})]})}),i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"card bg-blue-50 border-blue-100",children:[i.jsxs("div",{className:"flex items-center gap-2 text-blue-700 mb-4",children:[i.jsx(P_,{size:20}),i.jsx("h3",{className:"font-bold",children:"Gua de Activacin"})]}),i.jsxs("div",{className:"space-y-4 text-sm text-blue-900 leading-relaxed",children:[i.jsx("p",{children:"Para que un nuevo vendedor pueda entrar:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-2 font-medium",children:[i.jsx("li",{children:"Ve a tu panel de **Supabase**."}),i.jsxs("li",{children:["Seccin **Authentication ",">"," Users**."]}),i.jsxs("li",{children:["Haz clic en **Add User ",">"," Invite User**."]}),i.jsx("li",{children:"Ingresa el email del vendedor."})]}),i.jsx("p",{className:"text-xs mt-4 p-2 bg-blue-100/50 rounded border border-blue-200",children:"Una vez que el vendedor acepte la invitacin, su perfil aparecer automticamente en esta lista."}),i.jsxs("a",{href:"https://supabase.com/dashboard",target:"_blank",className:"inline-flex items-center gap-2 text-primary-600 font-bold hover:underline mt-2",children:["Ir al Dashboard ",i.jsx(R_,{size:14})]})]})]})})]})]})}function _g(){return console.log("Rendering LoadingScreen..."),i.jsxs("div",{className:"min-h-screen bg-brand-lavender flex flex-col items-center justify-center p-4",children:[i.jsxs("div",{className:"relative w-24 h-24 mb-8",children:[i.jsx("div",{className:"absolute inset-0 bg-white rounded-full shadow-lg flex items-center justify-center animate-pulse",children:i.jsx("img",{src:"/logos/logo-lavender.jpg",alt:"Logo",className:"w-20 h-20 rounded-full object-contain"})}),i.jsx("div",{className:"absolute -inset-2 border-4 border-t-primary-500 border-r-transparent border-b-primary-200 border-l-transparent rounded-full animate-spin"})]}),i.jsx("h2",{className:"text-xl font-serif font-bold text-primary-700 mb-2",children:"Sophi Shoes"}),i.jsxs("div",{className:"flex gap-1 mb-8",children:[i.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-bounce",style:{animationDelay:"0s"}}),i.jsx("div",{className:"w-2 h-2 bg-secondary-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),i.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),i.jsx("button",{onClick:()=>window.location.reload(),className:"text-xs text-primary-400 hover:text-primary-600 underline",children:"Tarda mucho? Clic aqu para reintentar"})]})}function Et({children:n,requireAdmin:t=!1}){const{user:s,profile:a,loading:l}=vr();return l?i.jsx(_g,{}):s?t&&(a==null?void 0:a.role)!=="admin"?i.jsx(Fo,{to:"/",replace:!0}):i.jsx(i.Fragment,{children:n}):i.jsx(Fo,{to:"/login",replace:!0})}function aj(){const{user:n,loading:t}=vr();return console.log("App State:",{loading:t,user:n==null?void 0:n.email}),t?i.jsx(_g,{}):i.jsxs(Cv,{children:[i.jsx(ze,{path:"/login",element:n?i.jsx(Fo,{to:"/",replace:!0}):i.jsx(U_,{})}),i.jsxs(ze,{path:"/",element:i.jsx(Et,{children:i.jsx(z_,{})}),children:[i.jsx(ze,{index:!0,element:i.jsx(M_,{})}),i.jsx(ze,{path:"suppliers",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(F_,{})})}),i.jsx(ze,{path:"suppliers/new",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(im,{})})}),i.jsx(ze,{path:"suppliers/:id",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(im,{})})}),i.jsx(ze,{path:"products",element:i.jsx(B_,{})}),i.jsx(ze,{path:"products/new",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(om,{})})}),i.jsx(ze,{path:"products/:id",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(om,{})})}),i.jsx(ze,{path:"customers",element:i.jsx(X_,{})}),i.jsx(ze,{path:"customers/new",element:i.jsx(cm,{})}),i.jsx(ze,{path:"customers/:id",element:i.jsx(cm,{})}),i.jsx(ze,{path:"users",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(sj,{})})}),i.jsx(ze,{path:"users/:id",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(ij,{})})}),i.jsx(ze,{path:"purchases",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(K_,{})})}),i.jsx(ze,{path:"purchases/new",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(W_,{})})}),i.jsx(ze,{path:"sales",element:i.jsx(G_,{})}),i.jsx(ze,{path:"shipping",element:i.jsx(J_,{})}),i.jsx(ze,{path:"sales/new",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(lm,{})})}),i.jsx(ze,{path:"shipping/new",element:i.jsx(lm,{})}),i.jsx(ze,{path:"cash",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(tj,{})})}),i.jsx(ze,{path:"reports",element:i.jsx(Et,{requireAdmin:!0,children:i.jsx(rj,{})})})]}),i.jsx(ze,{path:"print/sale/:id",element:i.jsx(Et,{children:i.jsx(nj,{})})}),i.jsx(ze,{path:"*",element:i.jsx(Fo,{to:"/",replace:!0})})]})}const oj=new Tx({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});class lj extends Hu.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Uncaught error:",t,s)}render(){var t;return this.state.hasError?i.jsxs("div",{style:{padding:20,color:"red",background:"black",height:"100vh"},children:[i.jsx("h1",{children:"Algo sali mal."}),i.jsx("pre",{children:(t=this.state.error)==null?void 0:t.toString()}),i.jsx("button",{onClick:()=>window.location.reload(),style:{padding:10,marginTop:20},children:"Recargar"})]}):this.props.children}}C0.createRoot(document.getElementById("root")).render(i.jsx(Hu.StrictMode,{children:i.jsx(lj,{children:i.jsx(Ox,{client:oj,children:i.jsx(Zv,{children:i.jsx(w_,{children:i.jsx(aj,{})})})})})}));
